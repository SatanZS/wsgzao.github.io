<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>HelloDog</title>
  <subtitle>Keep Calm and Carry On</subtitle>
  <link href="/atom.xml" rel="self"/>
  
  <link href="https://wsgzao.github.io/"/>
  <updated>2018-05-28T09:03:37.746Z</updated>
  <id>https://wsgzao.github.io/</id>
  
  <author>
    <name>wsgzao</name>
    
  </author>
  
  <generator uri="http://hexo.io/">Hexo</generator>
  
  <entry>
    <title>我的线上线下购物变迁史</title>
    <link href="https://wsgzao.github.io/post/buy/"/>
    <id>https://wsgzao.github.io/post/buy/</id>
    <published>2018-05-28T06:59:49.000Z</published>
    <updated>2018-05-28T09:03:37.746Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>很久很久以前，我们利用信息不对称在互联网未普及时赚取差价，在互联网浪潮以及无限移动流量不断下调门槛的欢呼声中，我们不知不觉的进入到无现金社会中，用手机支付转账抢红包，刷地铁公交，办理各种和生活息息相关的琐事，甚至即将普及的电子身份证和电子驾照等。虽然核心硬实力大家已经看清楚差距，但软实力上同行业的激烈竞争和跨行业的降维攻击在不断推着咱们的传统行业持续变革，总有很多事情不尽如人意，但至少技术让生活越来越便利，我们也在慢慢向前进击。</p>
<blockquote>
<p>如果可以兼顾隐私安全的话，希望未来一部手机就可以完成所有事情</p>
</blockquote>
<h2 id="更新历史"><a href="#更新历史" class="headerlink" title="更新历史"></a>更新历史</h2><p>2018年05月28日 - 初稿</p>
<p>阅读原文 - <a href="https://wsgzao.github.io/post/buy/">https://wsgzao.github.io/post/buy/</a></p>
<hr>
<h2 id="国内线上购物"><a href="#国内线上购物" class="headerlink" title="国内线上购物"></a>国内线上购物</h2><blockquote>
<p>网易严选 &gt; 网易考拉 &gt; 小米有品 &gt; 京东 &gt; 淘宝</p>
</blockquote>
<p>淘宝.Taobao - <a href="https://www.taobao.com/" target="_blank" rel="external">https://www.taobao.com/</a></p>
<ul>
<li>还记得当时神秘的程序员漫画作者西乔和霍炬移民前往加拿大时留下一句话，会想念万能的淘宝</li>
<li>我所怀念的应该是现在和未来支付宝和微信所垄断的无现金社会吧</li>
</ul>
<p>京东.JD - <a href="https://www.jd.com/" target="_blank" rel="external">https://www.jd.com/</a></p>
<ul>
<li>自营大概率正品+极速物流+优质售后让我第一眼就喜欢上京东，只是现在不怎么用了，当然也不是付费会员</li>
<li>京东和顺丰的极速物流定位不同，前者建仓库后者上天入地，但都为实体经济创造了不可磨灭的价值，值得尊重</li>
<li>希望顺丰，京东，菜鸟们能积极向国外物流巨头看齐，不仅要做大更要做强</li>
</ul>
<p>网易考拉.Kaola - <a href="https://www.kaola.com/" target="_blank" rel="external">https://www.kaola.com/</a></p>
<ul>
<li>此前我一直想当然的认为国内海淘市场Amazon亚马逊是老大，可当我自己需要海淘购物时才发现网易考拉海购才是隐形冠军</li>
<li>我办理了网易考拉黑卡会员，值</li>
</ul>
<p>网易严选 - <a href="https://you.163.com/" target="_blank" rel="external">https://you.163.com/</a></p>
<ul>
<li>我需要买什么会先搜索网易严选，而严选的slogan我也很喜欢“好的生活，没那么贵”</li>
<li>网易严选和小米有品也选择了两条不同的路，目前严选的品类更多一些，高标准的服务让我第一时间联想到京东</li>
<li>我办理了网易严选超级会员，值</li>
</ul>
<p>小米有品 - <a href="https://youpin.mi.com/" target="_blank" rel="external">https://youpin.mi.com/</a></p>
<ul>
<li>如果你很喜欢新奇的智能硬件产品，小米有品相信可以满足很多人的好奇心</li>
<li>不管外界如何评论小米的商业模式，即使我也享受过饥饿营销的恶心，但不可否认因为小米的坚持让我可以花更少的钱享受到科技的乐趣</li>
</ul>
<p>闲鱼 - <a href="https://2.taobao.com/" target="_blank" rel="external">https://2.taobao.com/</a></p>
<ul>
<li>淘宝内部孵化出来的二手闲置交易平台，再一次看到了芝麻信用的威力</li>
<li>我也偶尔会在闲鱼上购买或者低价卖出自己的闲置</li>
</ul>
<p>百果园 - <a href="https://www.pagoda.com.cn/" target="_blank" rel="external">https://www.pagoda.com.cn/</a></p>
<ul>
<li>推荐这个大家可能比较意外，因为百果园应该是线下强于线上，以实体店为主，但我想说的是百果园才是继便利店之后我高频消费的第二场所</li>
<li>百果园的商业式不多谈，但有一个服务我希望让大家知晓，不好吃瞬间退款，如果这个服务哪天不存在了，我引用官网的一句话来表达遗憾，三无退货并非零门槛，他的门槛是“人”之所以称之为“人”的最基础门槛，那就是“良知”</li>
</ul>
<p><strong>其它</strong></p>
<ol>
<li>唯品会 - 不买，但不去妨碍别人选择</li>
<li>拼多多 - 不买，但不去妨碍别人选择</li>
<li>美团点评 - 按需搜索，看真实评价</li>
<li>外卖平台 - 越来越成熟和规范，造福大家吧</li>
<li>优衣库 - 个人认为是目前线上和线下融合的最佳案例之一，不仅产品性价比高，营销也是业内一把好手，不过因为网易严选我买的很少了</li>
</ol>
<h2 id="国外线上购物"><a href="#国外线上购物" class="headerlink" title="国外线上购物"></a>国外线上购物</h2><blockquote>
<p>待定</p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      如果可以兼顾隐私安全的话，希望未来一部手机就可以完成所有事情
    
    </summary>
    
      <category term="生活 | Life" scheme="https://wsgzao.github.io/categories/%E7%94%9F%E6%B4%BB-Life/"/>
    
    
  </entry>
  
  <entry>
    <title>Docker 使用指北</title>
    <link href="https://wsgzao.github.io/post/docker/"/>
    <id>https://wsgzao.github.io/post/docker/</id>
    <published>2018-05-21T06:59:49.000Z</published>
    <updated>2018-05-21T07:07:39.874Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>把docker-ce安装和使用部分先独立抽取出来，关于使用可以参考阮一峰写的《Docker入门教程》</p>
<blockquote>
<p>基于docker-ce的部署和使用手册</p>
</blockquote>
<h2 id="更新历史"><a href="#更新历史" class="headerlink" title="更新历史"></a>更新历史</h2><p>2018年05月21日 - 初稿</p>
<p>阅读原文 - <a href="https://wsgzao.github.io/post/docker/">https://wsgzao.github.io/post/docker/</a></p>
<p><strong>扩展阅读</strong></p>
<p>Docker - <a href="https://www.docker.com/" target="_blank" rel="external">https://www.docker.com/</a></p>
<hr>
<h2 id="环境说明"><a href="#环境说明" class="headerlink" title="环境说明"></a>环境说明</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 操作系统版本</span></div><div class="line">cat /etc/redhat-release</div><div class="line">CentOS Linux release 7.4.1708 (Core)</div><div class="line"><span class="comment"># 操作系统内核</span></div><div class="line">uname -r</div><div class="line">3.10.0-693.21.1.el7.x86_64</div><div class="line"><span class="comment"># 硬件架构</span></div><div class="line">uname -m</div><div class="line">x86_64</div><div class="line"><span class="comment"># docker版本</span></div><div class="line">docker version</div><div class="line">Client:</div><div class="line"> Version:	18.03.0-ce</div><div class="line"> API version:	1.37</div><div class="line"> Go version:	go1.9.4</div><div class="line"> Git commit:	0520e24</div><div class="line"> Built:	Wed Mar 21 23:09:15 2018</div><div class="line"> OS/Arch:	linux/amd64</div><div class="line"> Experimental:	<span class="literal">false</span></div><div class="line"> Orchestrator:	swarm</div><div class="line"></div><div class="line">Server:</div><div class="line"> Engine:</div><div class="line">  Version:	18.03.0-ce</div><div class="line">  API version:	1.37 (minimum version 1.12)</div><div class="line">  Go version:	go1.9.4</div><div class="line">  Git commit:	0520e24</div><div class="line">  Built:	Wed Mar 21 23:13:03 2018</div><div class="line">  OS/Arch:	linux/amd64</div><div class="line">  Experimental:	<span class="literal">false</span></div></pre></td></tr></table></figure>
<h2 id="部署Docker"><a href="#部署Docker" class="headerlink" title="部署Docker"></a>部署Docker</h2><h3 id="使用阿里云加速器加快获取docker官方的镜像"><a href="#使用阿里云加速器加快获取docker官方的镜像" class="headerlink" title="使用阿里云加速器加快获取docker官方的镜像"></a>使用阿里云加速器加快获取docker官方的镜像</h3><p>步骤一：如果没有阿里云账号，需要注册阿里云开发账号</p>
<p><a href="https://dev.aliyun.com/" target="_blank" rel="external">https://dev.aliyun.com/</a></p>
<p>步骤二：进入加速器页面获取加速信息</p>
<p><a href="https://cr.console.aliyun.com/#/accelerator" target="_blank" rel="external">https://cr.console.aliyun.com/#/accelerator</a></p>
<h3 id="安装／升级你的Docker客户端"><a href="#安装／升级你的Docker客户端" class="headerlink" title="安装／升级你的Docker客户端"></a>安装／升级你的Docker客户端</h3><p>推荐安装1.10.0以上版本的Docker客户端，参考文档 docker-ce<br><a href="https://yq.aliyun.com/articles/110806?spm=5176.8351553.0.0.6a721991ZTvV8S" target="_blank" rel="external">https://yq.aliyun.com/articles/110806?spm=5176.8351553.0.0.6a721991ZTvV8S</a></p>
<blockquote>
<p>Docker CE 镜像源站</p>
</blockquote>
<p>使用官方安装脚本自动安装</p>
<pre><code>curl -fsSL https://get.docker.com | bash -s docker --mirror Aliyun
</code></pre><p>CentOS 7 (使用yum进行安装)</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># step 1: 安装必要的一些系统工具</span></div><div class="line">sudo yum install -y yum-utils device-mapper-persistent-data lvm2</div><div class="line"><span class="comment"># Step 2: 添加软件源信息</span></div><div class="line">sudo yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</div><div class="line"><span class="comment"># Step 3: 更新并安装 Docker-CE</span></div><div class="line">sudo yum makecache fast</div><div class="line">sudo yum -y install docker-ce</div><div class="line"><span class="comment"># Step 4: 开启Docker服务</span></div><div class="line">sudo service docker start</div><div class="line"></div><div class="line"><span class="comment"># 注意：</span></div><div class="line"><span class="comment"># 官方软件源默认启用了最新的软件，您可以通过编辑软件源的方式获取各个版本的软件包。例如官方并没有将测试版本的软件源置为可用，你可以通过以下方式开启。同理可以开启各种测试版本等。</span></div><div class="line"><span class="comment"># vim /etc/yum.repos.d/docker-ce.repo</span></div><div class="line"><span class="comment">#   将 [docker-ce-test] 下方的 enabled=0 修改为 enabled=1</span></div><div class="line"><span class="comment">#</span></div><div class="line"><span class="comment"># 安装指定版本的Docker-CE:</span></div><div class="line"><span class="comment"># Step 1: 查找Docker-CE的版本:</span></div><div class="line"><span class="comment"># yum list docker-ce.x86_64 --showduplicates | sort -r</span></div><div class="line"><span class="comment">#   Loading mirror speeds from cached hostfile</span></div><div class="line"><span class="comment">#   Loaded plugins: branch, fastestmirror, langpacks</span></div><div class="line"><span class="comment">#   docker-ce.x86_64            17.03.1.ce-1.el7.centos            docker-ce-stable</span></div><div class="line"><span class="comment">#   docker-ce.x86_64            17.03.1.ce-1.el7.centos            @docker-ce-stable</span></div><div class="line"><span class="comment">#   docker-ce.x86_64            17.03.0.ce-1.el7.centos            docker-ce-stable</span></div><div class="line"><span class="comment">#   Available Packages</span></div><div class="line"><span class="comment"># Step2 : 安装指定版本的Docker-CE: (VERSION 例如上面的 17.03.0.ce.1-1.el7.centos)</span></div><div class="line"><span class="comment"># sudo yum -y install docker-ce-[VERSION]</span></div></pre></td></tr></table></figure>
<h3 id="如何配置镜像加速器"><a href="#如何配置镜像加速器" class="headerlink" title="如何配置镜像加速器"></a>如何配置镜像加速器</h3><p>针对Docker客户端版本大于1.10.0的用户</p>
<p>您可以通过修改daemon配置文件/etc/docker/daemon.json来使用加速器：<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line">sudo mkdir -p /etc/docker</div><div class="line">sudo tee /etc/docker/daemon.json &lt;&lt;-<span class="string">'EOF'</span></div><div class="line">&#123;</div><div class="line">  <span class="string">"registry-mirrors"</span>: [<span class="string">"https://ffia7t7n.mirror.aliyuncs.com"</span>]</div><div class="line">&#125;</div><div class="line">EOF</div><div class="line">sudo systemctl daemon-reload</div><div class="line">sudo systemctl restart docker</div></pre></td></tr></table></figure></p>
<h3 id="安装Docker"><a href="#安装Docker" class="headerlink" title="安装Docker"></a>安装Docker</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 使用阿里云作加速</span></div><div class="line"><span class="built_in">cd</span> /etc/yum.repos.d/ &amp;&amp; rm -f *.repo</div><div class="line">wget -O /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/epel-7.repo</div><div class="line">wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo</div><div class="line">yum remove -y docker docker-common docker-selinux docker-engine</div><div class="line"></div><div class="line"><span class="comment"># 安装docker官方源，国内下载较慢建议切换为阿里云加速</span></div><div class="line">yum install -y yum-utils device-mapper-persistent-data lvm2</div><div class="line">yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo</div><div class="line">yum-config-manager --<span class="built_in">enable</span> docker-ce-edge</div><div class="line">yum list docker-ce --showduplicates | sort -r |grep stable</div><div class="line"></div><div class="line"><span class="comment"># 安装docker，可以选择制定版本</span></div><div class="line">yum install -y docker-ce</div><div class="line">systemctl start docker</div><div class="line">systemctl <span class="built_in">enable</span> docker</div><div class="line">mkdir -p /etc/docker</div><div class="line">tee /etc/docker/daemon.json &lt;&lt;-<span class="string">'EOF'</span></div><div class="line">&#123;</div><div class="line">  <span class="string">"registry-mirrors"</span>: [<span class="string">"https://ffia7t7n.mirror.aliyuncs.com"</span>]                <span class="comment"># 为了后期方便添加阿里云的加速镜像站</span></div><div class="line">&#125;</div><div class="line">EOF</div><div class="line">systemctl daemon-reload</div><div class="line">systemctl restart docker</div></pre></td></tr></table></figure>
<h3 id="测试Docker服务正常"><a href="#测试Docker服务正常" class="headerlink" title="测试Docker服务正常"></a>测试Docker服务正常</h3><p>例行跑个hello world测试下Docker服务是否正常</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 测试docker</span></div><div class="line">docker run hello-world</div><div class="line">Unable to find image <span class="string">'hello-world:latest'</span> locally</div><div class="line">latest: Pulling from library/hello-world</div><div class="line">ca4f61b1923c: Pull complete </div><div class="line">Digest: sha256:97ce6fa4b6cdc0790cda65fe7290b74cfebd9fa0c9b8c38e979330d547d22ce1</div><div class="line">Status: Downloaded newer image <span class="keyword">for</span> hello-world:latest</div><div class="line"></div><div class="line">Hello from Docker!</div><div class="line">This message shows that your installation appears to be working correctly.</div><div class="line"></div><div class="line">To generate this message, Docker took the following steps:</div><div class="line"> 1. The Docker client contacted the Docker daemon.</div><div class="line"> 2. The Docker daemon pulled the <span class="string">"hello-world"</span> image from the Docker Hub.</div><div class="line">    (amd64)</div><div class="line"> 3. The Docker daemon created a new container from that image <span class="built_in">which</span> runs the</div><div class="line">    executable that produces the output you are currently reading.</div><div class="line"> 4. The Docker daemon streamed that output to the Docker client, <span class="built_in">which</span> sent it</div><div class="line">    to your terminal.</div><div class="line"></div><div class="line">To try something more ambitious, you can run an Ubuntu container with:</div><div class="line"> $ docker run -it ubuntu bash</div><div class="line"></div><div class="line">Share images, automate workflows, and more with a free Docker ID:</div><div class="line"> https://cloud.docker.com/</div><div class="line"></div><div class="line">For more examples and ideas, visit:</div><div class="line"> https://docs.docker.com/engine/userguide/</div></pre></td></tr></table></figure>
<h3 id="安装docker-compose"><a href="#安装docker-compose" class="headerlink" title="安装docker-compose"></a>安装docker-compose</h3><pre><code>yum install -y docker-compose
</code></pre><h2 id="离线安装Docker"><a href="#离线安装Docker" class="headerlink" title="离线安装Docker"></a>离线安装Docker</h2><p>先在一台可以联网的相同操作系统环境下下载离线安装包，然后内网服务器构建本地yum源，最后安装docker</p>
<h3 id="下载离线安装包"><a href="#下载离线安装包" class="headerlink" title="下载离线安装包"></a>下载离线安装包</h3><blockquote>
<p>在可以联网的机器上下载rpm包</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#安装yum-plugin-downloadonly插件</span></div><div class="line">yum install -y yum-plugin-downloadonly</div><div class="line"></div><div class="line"><span class="comment"># 下载createrepo相关rpm到指定目录，构建本地源之前需要在本地安装createrepo，用于构建本地源</span></div><div class="line">mkdir -p /tmp/repo/createrepo/</div><div class="line">yum install --downloadonly --downloaddir=/tmp/repo/createrepo/ createrepo</div><div class="line"></div><div class="line"><span class="comment"># 下载docker相关rpm到指定目录</span></div><div class="line">mkdir -p /tmp/repo/docker-ce/</div><div class="line">yum install --downloadonly --downloaddir=/tmp/repo/docker-ce/ docker-ce</div><div class="line"></div><div class="line"><span class="comment"># 下载docker-compose相关rpm到指定目录</span></div><div class="line">mkdir -p /tmp/repo/docker-compose/</div><div class="line">yum install --downloadonly --downloaddir=/tmp/repo/docker-compose/ docker-compose</div></pre></td></tr></table></figure>
<h3 id="构建本地yum源"><a href="#构建本地yum源" class="headerlink" title="构建本地yum源"></a>构建本地yum源</h3><p>将docker的rpm包拷贝到需要安装docker的局域网集群上面，例如：<br>/tmp/repo/docker-ce/</p>
<p>将docker的rpm包拷贝到需要安装docker的局域网集群上面，例如：<br>/tmp/repo/createrepo/</p>
<p>构建本地yum源</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 安装createrepo</span></div><div class="line">rpm -ivh /tmp/repo/createrepo/*.rpm</div><div class="line"><span class="comment"># 备份/etc/yum.repos.d目录下文件</span></div><div class="line">ls /etc/yum.repos.d | xargs -I&#123;&#125; mv /etc/yum.repos.d/&#123;&#125; /etc/yum.repos.d/&#123;&#125;.bk</div><div class="line"><span class="comment"># 创建新的*.repo文件，如：docker.repo，进行配置</span></div><div class="line">vim docker.repo</div><div class="line">[<span class="built_in">local</span>-yum]</div><div class="line">name=<span class="built_in">local</span>-yum</div><div class="line">baseurl=file:////tmp/repo/docker-ce/</div><div class="line">enabled=1</div><div class="line">gpgcheck=0</div><div class="line"><span class="comment"># 设置本地源</span></div><div class="line">createrepo -d /tmp/repo/docker-ce/</div><div class="line"><span class="comment"># 查看看是否能看到自己构建的本地源</span></div><div class="line">yum repolist</div><div class="line"><span class="comment"># 清除缓存</span></div><div class="line">yum clean all</div><div class="line"><span class="comment"># 创建缓存</span></div><div class="line">yum makecache</div><div class="line"><span class="comment"># 看本地源是否配置成功，通过yum list看是否输出了新的rpm包，如果能查询到，证明配置成功</span></div><div class="line">yum list | grep docker</div><div class="line"><span class="comment"># 离线安装docker</span></div><div class="line">yum install docker -y</div></pre></td></tr></table></figure>
<h2 id="Docker入门教程"><a href="#Docker入门教程" class="headerlink" title="Docker入门教程"></a>Docker入门教程</h2><p><a href="http://www.ruanyifeng.com/blog/2018/02/docker-tutorial.html" target="_blank" rel="external">http://www.ruanyifeng.com/blog/2018/02/docker-tutorial.html</a></p>
]]></content>
    
    <summary type="html">
    
      基于docker-ce的部署和使用手册
    
    </summary>
    
      <category term="学习 | Study" scheme="https://wsgzao.github.io/categories/%E5%AD%A6%E4%B9%A0-Study/"/>
    
    
  </entry>
  
  <entry>
    <title>使用Ansible管理Windows</title>
    <link href="https://wsgzao.github.io/post/ansible-windows/"/>
    <id>https://wsgzao.github.io/post/ansible-windows/</id>
    <published>2018-05-21T02:59:49.000Z</published>
    <updated>2018-05-21T07:34:21.041Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>本文主要介绍在如何使用Ansible管理Windows客户端，Ansible官方提供了一个很方便的安装脚本，对于外网用户来说安装真的很轻松，可惜我遇到的问题是如何在内网部署，有相同烦恼的小伙伴不妨参考下</p>
<blockquote>
<p>轻轻松松使用Ansible管理Windows客户端</p>
</blockquote>
<h2 id="更新历史"><a href="#更新历史" class="headerlink" title="更新历史"></a>更新历史</h2><p>2018年05月21日 - 初稿</p>
<p>阅读原文 - <a href="https://wsgzao.github.io/post/ansible-windows/">https://wsgzao.github.io/post/ansible-windows/</a></p>
<p><strong>扩展阅读</strong></p>
<p>Ansible Windows Guides - <a href="http://docs.ansible.com/ansible/latest/user_guide/windows.html" target="_blank" rel="external">http://docs.ansible.com/ansible/latest/user_guide/windows.html</a></p>
<hr>
<h2 id="Ansible-Windows-Support"><a href="#Ansible-Windows-Support" class="headerlink" title="Ansible Windows Support"></a>Ansible Windows Support</h2><blockquote>
<p>Ansible在2.3版本之前对于Windows支持的并不算很友好，从2.4版本开始已经可以使用原生模块实现很多需求</p>
</blockquote>
<p>Because Windows is a non-POSIX-compliant operating system, there are differences between how Ansible interacts with them and the way Windows works. These guides will highlight some of the differences between Linux/Unix hosts and hosts running Windows.</p>
<ul>
<li>Ansible’s supported Windows versions generally match those under current and extended support from Microsoft. Supported desktop OSs include Windows 7, 8.1, and 10, and supported server OSs are Windows Server 2008, 2008 R2, 2012, 2012 R2, and - 2016.</li>
<li>Ansible requires PowerShell 3.0 or newer and at least .NET 4.0 to be installed on the Windows host.</li>
<li>A WinRM listener should be created and activated. More details for this can be found below.</li>
</ul>
<p><img src="http://ws1.sinaimg.cn/large/7207510dgy1frixssianuj20w30ecwfi.jpg" alt="image"></p>
<blockquote>
<p>Ansible does not support managing Windows XP or Server 2003 hosts. The supported operating system versions are:</p>
</blockquote>
<p>Windows Server 2008<br>Windows Server 2008 R2<br>Windows Server 2012<br>Windows Server 2012 R2<br>Windows Server 2016<br>Windows 7<br>Windows 8.1<br>Windows 10</p>
<ol>
<li>在官方文档中已经提到了在Windows中使用Ansible的最要前提，WinRM</li>
<li>WinRM依赖Powershell 3.0以上版本的支持，牵扯出PowerShell 2.0 to PowerShell 3.0/5.0的问题</li>
<li>而Powershell升级则带来.Net Framework是否跟随升级至4.6.2/4.7.2的选择</li>
<li>关于WinRM的参数配置可以参考下面的链接Setting up a Windows Host</li>
</ol>
<p><a href="https://github.com/ansible/ansible/blob/devel/examples/scripts/upgrade_to_ps3.ps1" target="_blank" rel="external">https://github.com/ansible/ansible/blob/devel/examples/scripts/upgrade_to_ps3.ps1</a><br><a href="https://github.com/ansible/ansible/blob/devel/examples/scripts/ConfigureRemotingForAnsible.ps1" target="_blank" rel="external">https://github.com/ansible/ansible/blob/devel/examples/scripts/ConfigureRemotingForAnsible.ps1</a></p>
<p>Setting up a Windows Host<br><a href="http://docs.ansible.com/ansible/latest/user_guide/windows_setup.html" target="_blank" rel="external">http://docs.ansible.com/ansible/latest/user_guide/windows_setup.html</a></p>
<p>.NET Framework 4.7.2/4.6.2<br><a href="https://www.microsoft.com/net/download/dotnet-framework-runtime" target="_blank" rel="external">https://www.microsoft.com/net/download/dotnet-framework-runtime</a></p>
<p>Powershell 3.0<br><a href="https://www.microsoft.com/en-us/download/details.aspx?id=34595" target="_blank" rel="external">https://www.microsoft.com/en-us/download/details.aspx?id=34595</a></p>
<p>Powershell 5.1<br><a href="https://www.microsoft.com/en-us/download/details.aspx?id=54616" target="_blank" rel="external">https://www.microsoft.com/en-us/download/details.aspx?id=54616</a></p>
<blockquote>
<p>我个人目前的建议是Win7/2008升级至Powershell 3.0，.Net Framework升级至4.6.2，其他情况需要可以参考官方文档后做决定</p>
</blockquote>
<p>Ansible Windows Guides - <a href="http://docs.ansible.com/ansible/latest/user_guide/windows.html" target="_blank" rel="external">http://docs.ansible.com/ansible/latest/user_guide/windows.html</a></p>
<h2 id="客户端"><a href="#客户端" class="headerlink" title="客户端"></a>客户端</h2><p>1.客户端配置windows主机,以管理员身份打开powershell, 并查看当前ps版本<br>get-host<br>2.系统自带的powershell版本是2.0，需要更新至powershell 3 以上版本<br><a href="https://www.microsoft.com/net/download/dotnet-framework-runtime" target="_blank" rel="external">https://www.microsoft.com/net/download/dotnet-framework-runtime</a><br><a href="https://www.microsoft.com/en-us/download/details.aspx?id=34595" target="_blank" rel="external">https://www.microsoft.com/en-us/download/details.aspx?id=34595</a><br>3.安装完重启服务器查看powershell版本</p>
<p>.NET Framework 4.6以上版本无法建立到信任根颁发机构的证书链<br>原因：系统缺少信任 Microsoft Root Certificate Authority 2011 根证书<br>下载：MicrosoftRootCertificateAuthority2011.cer<br><a href="http://go.microsoft.com/fwlink/?LinkID=747875&amp;clcid=0x409" target="_blank" rel="external">http://go.microsoft.com/fwlink/?LinkID=747875&amp;clcid=0x409</a><br>运行 certmgr.msc<br>导入证书到“受信任的根证书颁发机构”</p>
<p><img src="http://ws4.sinaimg.cn/large/7207510dgy1frizys458dj20b109k3yq.jpg" alt="image"></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 配置winrm</span></div><div class="line">mkdir C:\temp</div><div class="line"><span class="built_in">cd</span> C:\temp</div><div class="line"><span class="comment"># 下载ConfigureRemotingForAnsible.ps1</span></div><div class="line">https://raw.githubusercontent.com/ansible/ansible/devel/examples/scripts/ConfigureRemotingForAnsible.ps1</div><div class="line"><span class="comment"># 开启WinRM服务</span></div><div class="line">powershell -ExecutionPolicy RemoteSigned .\ConfigureRemotingForAnsible.ps1 -SkipNetworkProfileCheck</div></pre></td></tr></table></figure>
<h2 id="服务端"><a href="#服务端" class="headerlink" title="服务端"></a>服务端</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 服务端使用pip安装pywinrm</span></div><div class="line">pip install pywinrm</div><div class="line"></div><div class="line"><span class="comment"># 功能测试，配置ansible控制机</span></div><div class="line">vi /etc/ansible/hosts</div><div class="line"></div><div class="line">[windows]</div><div class="line">192.168.67.139</div><div class="line">[windows:vars]</div><div class="line">ansible_user=Administrator</div><div class="line">ansible_password=Admin123</div><div class="line">ansible_port=5986</div><div class="line">ansible_connection=winrm</div><div class="line">ansible_winrm_server_cert_validation=ignore  </div><div class="line"></div><div class="line"><span class="comment"># 要注意的是端口方面ssl即https方式的使用5986，http使用5985</span></div><div class="line"></div><div class="line"><span class="comment"># 测试ping通信</span></div><div class="line">ansible windows -m win_ping </div><div class="line"><span class="comment"># 查看ip地址 </span></div><div class="line">ansible windows -m win_command -a <span class="string">"ipconfig"</span></div></pre></td></tr></table></figure>
<h2 id="网盘下载"><a href="#网盘下载" class="headerlink" title="网盘下载"></a>网盘下载</h2><blockquote>
<p>Windows作为客户端所需的软件包我上传到百度网盘，.Net Framework安装失败提示证书错误记得手动导入MicrosoftRootCertificateAuthority2011.cer</p>
</blockquote>
<p><a href="https://pan.baidu.com/s/1JNV2pXjwUn14ojAtdEH_Sg" target="_blank" rel="external">https://pan.baidu.com/s/1JNV2pXjwUn14ojAtdEH_Sg</a></p>
<ol>
<li>安装 .Net Framework 4.6.2（NDP462-KB3151800-x86-x64-AllOS-ENU.exe）</li>
<li>升级 Windows 7 SP1 和 Windows 2008 R2 SP1 的 PowerShell版本从2.0至3.0（Windows6.1-KB2506143-x64.msu）</li>
<li><p>执行.\ConfigureRemotingForAnsible.ps1脚本开启WinRM远程管理服务</p>
<p> powershell -ExecutionPolicy RemoteSigned .\ConfigureRemotingForAnsible.ps1 -SkipNetworkProfileCheck</p>
</li>
</ol>
]]></content>
    
    <summary type="html">
    
      轻轻松松使用Ansible管理Windows客户端
    
    </summary>
    
      <category term="学习 | Study" scheme="https://wsgzao.github.io/categories/%E5%AD%A6%E4%B9%A0-Study/"/>
    
    
  </entry>
  
  <entry>
    <title>CentOS通用优化和配置</title>
    <link href="https://wsgzao.github.io/post/centos/"/>
    <id>https://wsgzao.github.io/post/centos/</id>
    <published>2018-05-20T06:59:49.000Z</published>
    <updated>2018-05-21T07:08:20.230Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>一般不购买RHEL/SLES订阅支持，通常会选择CentOS/Debian/Ubuntu等作为开源替代方案，由于工作的原因主要涉及RHEL，很多较新的技术我都会基于CentOS做实验，这里记录一些基础但实用的配置，生产环境不要直接生搬硬套。</p>
<blockquote>
<p>了解CentOS不同版本之间的差异，快速构建实验学习环境</p>
</blockquote>
<h2 id="更新历史"><a href="#更新历史" class="headerlink" title="更新历史"></a>更新历史</h2><p>2018年05月20日 - 初稿</p>
<p>阅读原文 - <a href="https://wsgzao.github.io/post/centos/">https://wsgzao.github.io/post/centos/</a></p>
<p><strong>扩展阅读</strong></p>
<p>CentOS - <a href="https://www.centos.org/" target="_blank" rel="external">https://www.centos.org/</a></p>
<hr>
<h2 id="CentOS简介"><a href="#CentOS简介" class="headerlink" title="CentOS简介"></a>CentOS简介</h2><blockquote>
<p>如果不知道应该下载哪一个CentOS版本，Everything ISO也许是一个非常好的选择</p>
</blockquote>
<p>The CentOS Project is a community-driven free software effort focused on delivering a robust open source ecosystem. For users, we offer a consistent manageable platform that suits a wide variety of deployments. For open source communities, we offer a solid, predictable base to build upon, along with extensive resources to build, test, release, and maintain their code.</p>
<p><a href="https://www.centos.org/download/" target="_blank" rel="external">https://www.centos.org/download/</a></p>
<h2 id="CentOS-6"><a href="#CentOS-6" class="headerlink" title="CentOS 6"></a>CentOS 6</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 设置主机名</span></div><div class="line">hostname centos6</div><div class="line">vi /etc/sysconfig/network</div><div class="line"></div><div class="line"><span class="comment"># 备份yum源文件</span></div><div class="line">mv /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.bak</div><div class="line">mv /etc/yum.repos.d/epel.repo /etc/yum.repos.d/epel.repo.bak</div><div class="line">mv /etc/yum.repos.d/epel-testing.repo /etc/yum.repos.d/epel-testing.repo.bak</div><div class="line"><span class="comment"># 使用aliyun镜像加速yum和epel</span></div><div class="line">wget -O /etc/yum.repos.d/Centos-6.repo http://mirrors.aliyun.com/repo/Centos-6.repo</div><div class="line">wget -O /etc/yum.repos.d/epel-6.repo http://mirrors.aliyun.com/repo/epel-6.repo</div><div class="line"><span class="comment"># 更新软件包缓存</span></div><div class="line">yum makecache</div><div class="line"></div><div class="line"><span class="comment"># 关闭selinux</span></div><div class="line">sed -i <span class="string">'s/SELINUX=enforcing/SELINUX=disabled/g'</span> /etc/sysconfig/selinux </div><div class="line"><span class="comment"># 设置selinux状态 </span></div><div class="line">setenforce 0</div><div class="line"><span class="comment"># 获取selinux状态 </span></div><div class="line">getenforce</div><div class="line"></div><div class="line"><span class="comment"># 停止firewall</span></div><div class="line">/etc/init.d/iptables stop</div><div class="line"><span class="comment"># 禁止firewall开机启动</span></div><div class="line">chkconfig iptables off</div><div class="line"></div><div class="line"><span class="comment"># 设置历史记录的时间</span></div><div class="line">vi /etc/profile</div><div class="line"><span class="comment"># 在文件末尾添加，注意中间空格</span></div><div class="line"><span class="built_in">export</span> HISTTIMEFORMAT=<span class="string">"%Y-%m-%d %H:%M:%S `whoami` "</span></div><div class="line"><span class="comment"># 默认保留10000条</span></div><div class="line"><span class="built_in">export</span> HISTSIZE=<span class="string">"10000"</span></div><div class="line"></div><div class="line"><span class="comment"># 保存退出后刷新生效</span></div><div class="line"><span class="built_in">source</span> /etc/profile</div></pre></td></tr></table></figure>
<h2 id="CentOS-7"><a href="#CentOS-7" class="headerlink" title="CentOS 7"></a>CentOS 7</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 设置主机名</span></div><div class="line">hostnamectl <span class="built_in">set</span>-hostname centos7</div><div class="line"></div><div class="line"><span class="comment"># 备份yum源文件</span></div><div class="line">mv /etc/yum.repos.d/CentOS-Base.repo /etc/yum.repos.d/CentOS-Base.repo.bak</div><div class="line">mv /etc/yum.repos.d/epel.repo /etc/yum.repos.d/epel.repo.bak</div><div class="line">mv /etc/yum.repos.d/epel-testing.repo /etc/yum.repos.d/epel-testing.repo.bak</div><div class="line"><span class="comment"># 使用aliyun镜像加速yum和epel</span></div><div class="line">wget -O /etc/yum.repos.d/Centos-7.repo http://mirrors.aliyun.com/repo/Centos-7.repo</div><div class="line">wget -O /etc/yum.repos.d/epel-7.repo http://mirrors.aliyun.com/repo/epel-7.repo</div><div class="line"><span class="comment"># 更新软件包缓存</span></div><div class="line">yum makecache</div><div class="line"></div><div class="line"><span class="comment"># 关闭selinux，重启后生效</span></div><div class="line">sed -i <span class="string">'s/SELINUX=enforcing/SELINUX=disabled/g'</span> /etc/sysconfig/selinux </div><div class="line"><span class="comment"># 设置selinux状态，临时生效命令</span></div><div class="line">setenforce 0</div><div class="line"><span class="comment"># 查看selinux状态 </span></div><div class="line">getenforce</div><div class="line"></div><div class="line"><span class="comment"># 停止firewall</span></div><div class="line">systemctl stop firewalld.service</div><div class="line"><span class="comment"># 禁止firewall开机启动</span></div><div class="line">systemctl <span class="built_in">disable</span> firewalld.service </div><div class="line"></div><div class="line"><span class="comment"># 设置 iptables service</span></div><div class="line">yum -y install iptables-services</div><div class="line"><span class="comment"># 修改iptables配置</span></div><div class="line">vim /etc/sysconfig/iptables</div><div class="line"><span class="comment"># 重启防火墙使配置生效</span></div><div class="line">systemctl restart iptables.service</div><div class="line"><span class="comment"># 设置防火墙开机启动</span></div><div class="line">systemctl <span class="built_in">enable</span> iptables.service</div><div class="line"></div><div class="line"><span class="comment"># 设置历史记录的时间</span></div><div class="line">vi /etc/profile</div><div class="line"><span class="comment"># 在文件末尾添加，注意中间空格</span></div><div class="line"><span class="built_in">export</span> HISTTIMEFORMAT=<span class="string">"%Y-%m-%d %H:%M:%S `whoami` "</span></div><div class="line"><span class="comment"># 默认保留10000条</span></div><div class="line"><span class="built_in">export</span> HISTSIZE=<span class="string">"10000"</span></div><div class="line"></div><div class="line"><span class="comment"># 保存退出后刷新生效</span></div><div class="line"><span class="built_in">source</span> /etc/profile</div><div class="line"></div><div class="line"><span class="comment"># 安装pip</span></div><div class="line">yum install python-devel gcc zlib zlib-devel openssl-devel -y</div><div class="line">yum install epel-release -y</div><div class="line">yum install python-pip -y</div><div class="line">pip install --upgrade pip</div><div class="line"></div><div class="line"><span class="comment"># yum-cron</span></div><div class="line">yum -y install yum-cron</div><div class="line"></div><div class="line">vim /etc/yum/yum-cron.conf</div><div class="line">apply_updates = no</div><div class="line">apply_updates = yes</div><div class="line"></div><div class="line">systemctl start crond</div><div class="line">systemctl start yum-cron</div></pre></td></tr></table></figure>
<h2 id="CentOS通用优化和配置"><a href="#CentOS通用优化和配置" class="headerlink" title="CentOS通用优化和配置"></a>CentOS通用优化和配置</h2><h3 id="优化"><a href="#优化" class="headerlink" title="优化"></a>优化</h3><blockquote>
<p>如果各位没有标准的baseline，以下配置可作为最简单的参考</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 避免连接空闲自动断开</span></div><div class="line"><span class="built_in">export</span> TMOUT=0</div><div class="line"></div><div class="line"><span class="comment"># 优化ssh参数，不使用DNS</span></div><div class="line">sed -i <span class="string">'/^#UseDNS/s/#UseDNS yes/UseDNS no/g'</span> /etc/ssh/sshd_config</div><div class="line"><span class="comment"># 重新加载sshd</span></div><div class="line">/etc/init.d/sshd reload</div><div class="line"></div><div class="line"><span class="comment"># 调整文件描述符大小，临时生效使用 ulimit -SHn 65535</span></div><div class="line">cat &gt;&gt;/etc/rc.local&lt;&lt;EOF</div><div class="line"><span class="comment">#open files</span></div><div class="line"><span class="built_in">ulimit</span> -SHn 65535</div><div class="line"><span class="comment">#stack size</span></div><div class="line"><span class="built_in">ulimit</span> -s 65535</div><div class="line">EOF</div></pre></td></tr></table></figure>
<h3 id="配置"><a href="#配置" class="headerlink" title="配置"></a>配置</h3><blockquote>
<p>以下配置非必须，仅供需要时参考</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div></pre></td><td class="code"><pre><div class="line"></div><div class="line"><span class="comment"># 最简单的网卡配置文件</span></div><div class="line">mv /etc/sysconfig/network-scripts/ifcfg-eth0 /etc/sysconfig/network-scripts/ifcfg-eth0.bak</div><div class="line">vi /etc/sysconfig/network-scripts/ifcfg-eth0</div><div class="line">DEVICE=eth0 <span class="comment">#网卡设备名称</span></div><div class="line">HWADDR=00:0C:29:D0:C7:B5 <span class="comment">#以太网设备的对应的物理地址</span></div><div class="line">TYPE=Ethernet <span class="comment">#网络类型为以太网模式，手动配置时可以忽略不填</span></div><div class="line">UUID=080a457b-6a53-4a3a-9155-a23c1146c2c6 <span class="comment">#通用唯一识别码，手动配置时可以忽略不填</span></div><div class="line">ONBOOT=yes <span class="comment">#是否启动引导的时候激活YES</span></div><div class="line">NM_CONTROLLED=no <span class="comment">#设备eth0是否可以由Network Manager图形管理工具托管</span></div><div class="line">BOOTPROTO=static <span class="comment">#静态IP地址获取状态 如：DHCP表示自动获取IP地址</span></div><div class="line">IPADDR=192.168.1.10 <span class="comment">#IP</span></div><div class="line">NETMASK=255.255.255.0 <span class="comment">#网卡对应的网络掩码</span></div><div class="line">GATEWAY=192.168.1.1 <span class="comment">#网关地址</span></div><div class="line"></div><div class="line"><span class="comment"># 安装基础库</span></div><div class="line">yum -y install gcc gcc-c++ autoconf libjpeg libjpeg-devel libpng libpng-devel freetype freetype-devel libxml2 libxml2-devel zlib zlib-devel glibc glibc-devel glib2 glib2-devel bzip2 bzip2-devel ncurses ncurses-devel curl curl-devel e2fsprogs e2fsprogs-devel krb5-devel libidn libidn-devel openssl openssl-devel nss_ldap openldap openldap-devel  openldap-clients openldap-servers libxslt-devel libevent-devel ntp libtool-ltdl bison libtool vim-enhanced</div><div class="line"></div><div class="line"><span class="comment"># 修改hosts</span></div><div class="line">vim /etc/hosts</div><div class="line"></div><div class="line"><span class="comment"># 修改dns</span></div><div class="line">vim /etc/resolv.conf</div><div class="line"></div><div class="line">nameserver DNS1</div><div class="line">nameserver DNS2</div><div class="line"></div><div class="line"><span class="comment"># 清理防火墙规则</span></div><div class="line">iptables –F</div><div class="line"><span class="comment"># 查看防火墙规则</span></div><div class="line">iptables –L</div><div class="line"><span class="comment"># 编辑防火墙规则</span></div><div class="line">vi /etc/sysconfig/iptables</div><div class="line"><span class="comment"># 保存防火墙规则</span></div><div class="line">/etc/init.d/iptables save</div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># 增加SWAP分区</span></div><div class="line"><span class="comment"># 创建1024M的文件块</span></div><div class="line">dd <span class="keyword">if</span>=/dev/zero of=/home/swap bs=1M count=1024</div><div class="line"><span class="comment"># 创建swap文件</span></div><div class="line">mkswap /home/swap</div><div class="line"><span class="comment"># 激活swap文件</span></div><div class="line">swapon /home/swap</div><div class="line"><span class="comment"># 查看swap</span></div><div class="line">swapon -s</div><div class="line"><span class="comment"># 修改/etc/fstab文件，增加以下内容，让系统引导时自动启动</span></div><div class="line">vi /etc/fstab </div><div class="line"><span class="comment"># 在最后添加下面代码</span></div><div class="line">/home/swap swap swap default 0 0</div><div class="line"></div><div class="line"><span class="comment"># 添加普通用户并进行sudo授权管理</span></div><div class="line">useradd <span class="built_in">test</span></div><div class="line"><span class="built_in">echo</span> <span class="string">"test"</span>:<span class="string">"test"</span> | chpasswd</div><div class="line">visudo</div><div class="line"><span class="comment"># all表示完全的系统权限,NOPASSWD表示提示权限命令时不需要密码</span></div><div class="line"><span class="built_in">test</span> ALL=(ALL) NOPASSWD: ALL</div><div class="line"></div><div class="line"><span class="comment"># 调整字符集，使其支持中文，根据实际情况而定</span></div><div class="line"><span class="comment"># 安装中文语言包</span></div><div class="line">yum groupinstall chinese-support</div><div class="line"></div><div class="line"><span class="comment"># CentOS 6</span></div><div class="line">vim /etc/sysconfig/i18n</div><div class="line"></div><div class="line">LANG=<span class="string">"zh_CN.GB18030"</span></div><div class="line">SUPPORTED=<span class="string">"zh_CN.UTF-8:zh_CN:zh:en_US.UTF-8:en_US:en"</span></div><div class="line"><span class="comment">#LANG="en_US.UTF-8"</span></div><div class="line">SYSFONT=<span class="string">"latarcyrheb-sun16″</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string"># CentOS 7</span></div><div class="line"><span class="string">vim /etc/locale.conf</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">#LANG="</span>en_US.UTF-8<span class="string">"</span></div><div class="line"><span class="string">LANG="</span>zh_CN.GB18030<span class="string">"</span></div><div class="line"><span class="string">LANGUAGE="</span>zh_CN.GB18030:zh_CN.GB2312:zh_CN<span class="string">"</span></div><div class="line"><span class="string">SUPPORTED="</span>zh_CN.UTF-8:zh_CN:zh:en_US.UTF-8:en_US:en<span class="string">"</span></div><div class="line"><span class="string">SYSFONT="</span>lat0-sun16<span class="string">"</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string"># 选择source或注销或重启使语言配置生效</span></div><div class="line"><span class="string">init 6</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string"># 设置运行级别，5为图形化，3为命令行</span></div><div class="line"><span class="string"># CentOS 6</span></div><div class="line"><span class="string">vi /etc/inittab</span></div><div class="line"><span class="string"># Default runlevel. The runlevels used are:</span></div><div class="line"><span class="string">#   0 - halt (Do NOT set initdefault to this)</span></div><div class="line"><span class="string">#   1 - Single user mode</span></div><div class="line"><span class="string">#   2 - Multiuser, without NFS (The same as 3, if you do not have networking)</span></div><div class="line"><span class="string">#   3 - Full multiuser mode</span></div><div class="line"><span class="string">#   4 - unused</span></div><div class="line"><span class="string">#   5 - X11</span></div><div class="line"><span class="string">#   6 - reboot (Do NOT set initdefault to this)</span></div><div class="line"><span class="string"># </span></div><div class="line"><span class="string">id:5:initdefault:</span></div><div class="line"><span class="string">#id:3:initdefault</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string"># CentOS 7</span></div><div class="line"><span class="string"># 查看当前运行级别</span></div><div class="line"><span class="string">systemctl get-default</span></div><div class="line"><span class="string">graphical.target</span></div><div class="line"><span class="string"># 修改为命令行模式</span></div><div class="line"><span class="string">systemctl set-default multi-user.target</span></div><div class="line"><span class="string"># 修改为图形化模式</span></div><div class="line"><span class="string">systemctl set-default graphical.target</span></div></pre></td></tr></table></figure>
<h3 id="内核优化"><a href="#内核优化" class="headerlink" title="内核优化"></a>内核优化</h3><blockquote>
<p>以下内容不建议直接套用，该配置主要适用于 CentOS 7</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># cat /etc/sysctl.conf</span></div><div class="line"><span class="comment"># System default settings live in /usr/lib/sysctl.d/00-system.conf.</span></div><div class="line"><span class="comment"># To override those settings, enter new settings here, or in an /etc/sysctl.d/&lt;name&gt;.conf file</span></div><div class="line"><span class="comment">#</span></div><div class="line"><span class="comment"># For more information, see sysctl.conf(5) and sysctl.d(5).</span></div><div class="line"></div><div class="line"><span class="comment"># 关闭ipv6</span></div><div class="line">net.ipv6.conf.all.disable_ipv6 = 1</div><div class="line">net.ipv6.conf.default.disable_ipv6 = 1</div><div class="line"></div><div class="line"><span class="comment"># 避免放大攻击</span></div><div class="line">net.ipv4.icmp_echo_ignore_broadcasts = 1</div><div class="line"></div><div class="line"><span class="comment"># 开启恶意icmp错误消息保护</span></div><div class="line">net.ipv4.icmp_ignore_bogus_error_responses = 1</div><div class="line"></div><div class="line"><span class="comment"># 关闭路由转发</span></div><div class="line">net.ipv4.ip_forward = 0</div><div class="line">net.ipv4.conf.all.send_redirects = 0</div><div class="line">net.ipv4.conf.default.send_redirects = 0</div><div class="line"></div><div class="line"><span class="comment"># 开启反向路径过滤</span></div><div class="line">net.ipv4.conf.all.rp_filter = 1</div><div class="line">net.ipv4.conf.default.rp_filter = 1</div><div class="line"></div><div class="line"><span class="comment"># 处理无源路由的包</span></div><div class="line">net.ipv4.conf.all.accept_source_route = 0</div><div class="line">net.ipv4.conf.default.accept_source_route = 0</div><div class="line"></div><div class="line"><span class="comment"># 关闭sysrq功能</span></div><div class="line">kernel.sysrq = 0</div><div class="line"></div><div class="line"><span class="comment"># core文件名中添加pid作为扩展名</span></div><div class="line">kernel.core_uses_pid = 1</div><div class="line"></div><div class="line"><span class="comment"># 开启SYN洪水攻击保护</span></div><div class="line">net.ipv4.tcp_syncookies = 1</div><div class="line"></div><div class="line"><span class="comment"># 修改消息队列长度</span></div><div class="line">kernel.msgmnb = 65536</div><div class="line">kernel.msgmax = 65536</div><div class="line"></div><div class="line"><span class="comment"># 设置最大内存共享段大小bytes</span></div><div class="line">kernel.shmmax = 68719476736</div><div class="line">kernel.shmall = 4294967296</div><div class="line"></div><div class="line"><span class="comment"># timewait的数量，默认180000</span></div><div class="line">net.ipv4.tcp_max_tw_buckets = 6000</div><div class="line">net.ipv4.tcp_sack = 1</div><div class="line">net.ipv4.tcp_window_scaling = 1</div><div class="line">net.ipv4.tcp_rmem = 4096 87380 4194304</div><div class="line">net.ipv4.tcp_wmem = 4096 16384 4194304</div><div class="line">net.core.wmem_default = 8388608</div><div class="line">net.core.rmem_default = 8388608</div><div class="line">net.core.rmem_max = 16777216</div><div class="line">net.core.wmem_max = 16777216</div><div class="line"></div><div class="line"><span class="comment"># 每个网络接口接收数据包的速率比内核处理这些包的速率快时，允许送到队列的数据包的最大数目</span></div><div class="line">net.core.netdev_max_backlog = 262144</div><div class="line"></div><div class="line"><span class="comment"># 限制仅仅是为了防止简单的 DDoS 攻击</span></div><div class="line">net.ipv4.tcp_max_orphans = 3276800</div><div class="line"></div><div class="line"><span class="comment"># 未收到客户端确认信息的连接请求的最大值</span></div><div class="line">net.ipv4.tcp_max_syn_backlog = 262144</div><div class="line">net.ipv4.tcp_timestamps = 0</div><div class="line"></div><div class="line"><span class="comment"># 内核放弃建立连接之前发送SYNACK 包的数量</span></div><div class="line">net.ipv4.tcp_synack_retries = 1</div><div class="line"></div><div class="line"><span class="comment"># 内核放弃建立连接之前发送SYN 包的数量</span></div><div class="line">net.ipv4.tcp_syn_retries = 1</div><div class="line"></div><div class="line"><span class="comment"># 启用timewait 快速回收</span></div><div class="line">net.ipv4.tcp_tw_recycle = 1</div><div class="line"></div><div class="line"><span class="comment"># 开启重用，允许将TIME-WAIT sockets 重新用于新的TCP 连接</span></div><div class="line">net.ipv4.tcp_tw_reuse = 1</div><div class="line">net.ipv4.tcp_mem = 94500000 915000000 927000000</div><div class="line">net.ipv4.tcp_fin_timeout = 1</div><div class="line"></div><div class="line"><span class="comment"># 当keepalive 起用的时候，TCP 发送keepalive 消息的频度。缺省是2 小时</span></div><div class="line">net.ipv4.tcp_keepalive_time = 30</div><div class="line"></div><div class="line"><span class="comment">#允许系统打开的端口范围</span></div><div class="line">net.ipv4.ip_local_port_range = 1024    65000</div><div class="line"></div><div class="line"><span class="comment">#修改防火墙表大小，默认65536</span></div><div class="line"><span class="comment">#net.netfilter.nf_conntrack_max=655350</span></div><div class="line"><span class="comment">#net.netfilter.nf_conntrack_tcp_timeout_established=1200</span></div><div class="line"></div><div class="line"><span class="comment"># 确保无人能修改路由表</span></div><div class="line">net.ipv4.conf.all.accept_redirects = 0</div><div class="line">net.ipv4.conf.default.accept_redirects = 0</div><div class="line">net.ipv4.conf.all.secure_redirects = 0</div><div class="line">net.ipv4.conf.default.secure_redirects = 0</div><div class="line"></div><div class="line"><span class="comment"># 执行命令使参数永久生效</span></div><div class="line">sysctl -p</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      了解CentOS不同版本之间的差异，快速构建实验学习环境
    
    </summary>
    
      <category term="学习 | Study" scheme="https://wsgzao.github.io/categories/%E5%AD%A6%E4%B9%A0-Study/"/>
    
    
  </entry>
  
  <entry>
    <title>DevOps实用资源分享</title>
    <link href="https://wsgzao.github.io/post/devops/"/>
    <id>https://wsgzao.github.io/post/devops/</id>
    <published>2018-05-15T08:31:24.000Z</published>
    <updated>2018-05-15T08:14:14.213Z</updated>
    
    <content type="html"><![CDATA[<p><img src="//i.v2ex.co/o2t5S8at.png" alt=""></p>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>其实一直很想整理一篇DevOps学习资源导航类文章，主要原因除了自己的懒惰外，技术的不断创新也让未来更加值得期待。虽然在大多数情况下我们既无法面面俱到也突破不了点的极限，但是这也不会阻碍我们对于学习的热爱。梳理这篇文章也是希望自己能够始终保持学习的态度，完善自己的知识体系，坚持技术沉淀的过程，享受点滴进步的快乐。</p>
<blockquote>
<p>DevOps是一个持续改进的过程</p>
</blockquote>
<hr>
<h2 id="更新历史"><a href="#更新历史" class="headerlink" title="更新历史"></a>更新历史</h2><p>2018年05月15日 - 修改内容<br>2016年05月11日 - 增加PHPHub，Ruby China<br>2016年03月25日 - 增加InfoQ，神秘的程序员<br>2016年02月14日 - 增加Forvo，Coursera，自强学堂<br>2016年01月04日 - 增加利器<br>2015年12月22日 - 增加极客学院，网易公开课，曹政微信订阅号<br>2015年10月29日 - 初稿</p>
<p>阅读原文 - <a href="https://wsgzao.github.io/post/devops/">https://wsgzao.github.io/post/devops/</a></p>
<hr>
<h2 id="图书"><a href="#图书" class="headerlink" title="图书"></a>图书</h2><blockquote>
<p>我推荐大家尝试使用Kindle改变自己阅读的习惯</p>
</blockquote>
<p>Kindle Paperwhite - <a href="http://www.amazon.cn/" target="_blank" rel="external">http://www.amazon.cn/</a></p>
<h2 id="搜索引擎"><a href="#搜索引擎" class="headerlink" title="搜索引擎"></a>搜索引擎</h2><blockquote>
<p>善用搜索引擎，穿过一堵墙你的知识面可能会更加立体</p>
</blockquote>
<p>Google - <a href="https://www.google.com/" target="_blank" rel="external">https://www.google.com/</a><br>Google Images - <a href="https://images.google.com/" target="_blank" rel="external">https://images.google.com/</a><br>Google Scholar - <a href="https://scholar.google.com/" target="_blank" rel="external">https://scholar.google.com/</a></p>
<ul>
<li>事实证明大多数情况下还是Google最懂我们的心</li>
</ul>
<p>WikipediA - <a href="https://www.wikipedia.org/" target="_blank" rel="external">https://www.wikipedia.org/</a></p>
<ul>
<li>试着把维基百科作为你的首选，弱化自己对于百度的依赖</li>
</ul>
<p>Forvo - <a href="http://zh.forvo.com/" target="_blank" rel="external">http://zh.forvo.com/</a></p>
<ul>
<li>妈妈再也不用担心我不会发音了，让Forvo来做你的发音指南</li>
</ul>
<h2 id="安全"><a href="#安全" class="headerlink" title="安全"></a>安全</h2><blockquote>
<p>黑客的思路往往让人眼前一亮，多向大牛们学习</p>
</blockquote>
<p>知道创宇研发技能表 - <a href="http://blog.knownsec.com/Knownsec_RD_Checklist/" target="_blank" rel="external">http://blog.knownsec.com/Knownsec_RD_Checklist/</a></p>
<ul>
<li>感谢<a href="http://evilcos.me/" target="_blank" rel="external">@余弦</a></li>
</ul>
<p>纳威安全导航 - <a href="http://navisec.it/" target="_blank" rel="external">http://navisec.it/</a></p>
<ul>
<li>乌云，FreeBuf，i春秋等都值得你多逛逛</li>
</ul>
<h2 id="阅读订阅"><a href="#阅读订阅" class="headerlink" title="阅读订阅"></a>阅读订阅</h2><blockquote>
<p>信息爆炸的时代如何过滤噪音很重要</p>
</blockquote>
<p>知乎日报 - <a href="http://daily.zhihu.com/" target="_blank" rel="external">http://daily.zhihu.com/</a></p>
<ul>
<li>每天 3 次，每次 7 分钟</li>
<li>我习惯下班后离线阅读生活中的美</li>
<li>读读日报和好奇心日报也推荐大家试试</li>
</ul>
<p>开发者头条 - <a href="http://toutiao.io/" target="_blank" rel="external">http://toutiao.io/</a></p>
<ul>
<li>码农周刊团队为程序员设计的阅读分享平台</li>
<li>极客头条，稀土掘金，伯乐在线等也是类似的</li>
</ul>
<p>湾区日报 - <a href="http://wanqu.co/" target="_blank" rel="external">http://wanqu.co/</a></p>
<ul>
<li>关注创业与技术,每天推送5篇优质英文文章</li>
<li>坚持向来不易，锻炼下英文阅读能力也不错哦</li>
</ul>
<h2 id="社区"><a href="#社区" class="headerlink" title="社区"></a>社区</h2><blockquote>
<p>Way to Explore &amp; Way too Extreme</p>
</blockquote>
<p>V2EX - <a href="http://www.v2ex.com/" target="_blank" rel="external">http://www.v2ex.com/</a></p>
<ul>
<li>一个与众不同的社区</li>
</ul>
<p>Stack Overflow - <a href="http://stackoverflow.com/" target="_blank" rel="external">http://stackoverflow.com/</a></p>
<ul>
<li>如果你使用 Google 相信会在这里看到不少高质量的答案</li>
</ul>
<p>PHPhub - <a href="https://phphub.org/" target="_blank" rel="external">https://phphub.org/</a></p>
<ul>
<li>PHPhub 是积极向上的 PHP &amp; Laravel 开发者社区</li>
</ul>
<p>Ruby China - <a href="https://ruby-china.org/" target="_blank" rel="external">https://ruby-china.org/</a></p>
<ul>
<li>中国 Ruby 社区，由众多爱好者共同维护，致力于构建完善的 Ruby 中文社区</li>
</ul>
<h2 id="微信订阅号"><a href="#微信订阅号" class="headerlink" title="微信订阅号"></a>微信订阅号</h2><p>小道消息 - WebNotes</p>
<ul>
<li>冯大辉的小道消息已经成为微信订阅号的标杆之一</li>
</ul>
<p>曹政 - caozsay</p>
<ul>
<li>曹大做为一个有故事的人，愿意分享更愿意交流，已经很难得了</li>
</ul>
<p>高效运维 - greatops</p>
<ul>
<li>萧田国组织维护的”高效运维”公众号每周多篇干货满满的原创好文</li>
</ul>
<p>神秘的程序员 - coderstory</p>
<ul>
<li>西乔和霍炬共同创作的程序员主题漫画，为生活添加一抹色彩</li>
</ul>
<p>InfoQ - infoqchina</p>
<ul>
<li>InfoQ在微信端的推广和推送质量都是满满的诚意</li>
</ul>
<p>CloudMan - cloudman6</p>
<ul>
<li>云计算深度实践者，每天5分钟玩转XXX系列作者</li>
</ul>
<h2 id="OJ"><a href="#OJ" class="headerlink" title="OJ"></a>OJ</h2><blockquote>
<p>ACM和奥数类似属于有天赋的你们，但实际工作中更要注重学习方法和问题总结</p>
</blockquote>
<p>LeetCode - <a href="http://leetcode.com/" target="_blank" rel="external">http://leetcode.com/</a></p>
<ul>
<li>leetcode 是一个针对程序员的面试准备平台</li>
</ul>
<p>牛客网 - <a href="http://www.nowcoder.com/" target="_blank" rel="external">http://www.nowcoder.com/</a></p>
<ul>
<li>一个新的专业IT笔试面试备考平台</li>
</ul>
<h2 id="信息聚合"><a href="#信息聚合" class="headerlink" title="信息聚合"></a>信息聚合</h2><blockquote>
<p>分享一些实用的技术学习路线</p>
</blockquote>
<p>Linux就该这么学 - <a href="https://www.linuxprobe.com/" target="_blank" rel="external">https://www.linuxprobe.com/</a></p>
<ul>
<li>作者持续更新并开源精心制作的Linux文档，推荐优先学习作为基础铺垫</li>
</ul>
<p>每天5分钟玩转 OpenStack </p>
<p><a href="https://mp.weixin.qq.com/s?__biz=MzIwMTM5MjUwMg==&amp;mid=403471227&amp;idx=1&amp;sn=d645ec0df174e05384bbff40aada4cff&amp;chksm=0b1673623c61fa74f005312b9ed1713a51344824523b657a7407b03a7c54810d0d17b656d211&amp;mpshare=1&amp;scene=23&amp;srcid=0515aqzmiJECvJEVqwvgdQWQ#rd" target="_blank" rel="external">https://mp.weixin.qq.com/s?__biz=MzIwMTM5MjUwMg==&amp;mid=403471227&amp;idx=1&amp;sn=d645ec0df174e05384bbff40aada4cff&amp;chksm=0b1673623c61fa74f005312b9ed1713a51344824523b657a7407b03a7c54810d0d17b656d211&amp;mpshare=1&amp;scene=23&amp;srcid=0515aqzmiJECvJEVqwvgdQWQ#rd</a></p>
<p>每天5分钟玩转 Docker 容器技术</p>
<p><a href="https://mp.weixin.qq.com/s?__biz=MzIwMTM5MjUwMg==&amp;mid=506103897&amp;idx=1&amp;sn=d27cdb06390406a5bff805db173176ee&amp;chksm=0d3080403a47095666c7af813c79dcd7f3897844f77ffd126638b7ffde35ed6a83e98a5eeb47&amp;mpshare=1&amp;scene=23&amp;srcid=05156hizYEw63Km0QnEHO6AE#rd" target="_blank" rel="external">https://mp.weixin.qq.com/s?__biz=MzIwMTM5MjUwMg==&amp;mid=506103897&amp;idx=1&amp;sn=d27cdb06390406a5bff805db173176ee&amp;chksm=0d3080403a47095666c7af813c79dcd7f3897844f77ffd126638b7ffde35ed6a83e98a5eeb47&amp;mpshare=1&amp;scene=23&amp;srcid=05156hizYEw63Km0QnEHO6AE#rd</a></p>
<p>每天5分钟玩转 Kubernetes</p>
<p><a href="https://mp.weixin.qq.com/s?__biz=MzIwMTM5MjUwMg==&amp;mid=506104436&amp;idx=1&amp;sn=85a95ea7bbf29c33020464355e0a8ed1&amp;chksm=0d30826d3a470b7bca9c6a273700dd7f19c3473d29a5b4ee5f22787d88502697ea8efca8d757&amp;mpshare=1&amp;scene=23&amp;srcid=0515yN4SRJd1qe4RaNWwBC98#rd" target="_blank" rel="external">https://mp.weixin.qq.com/s?__biz=MzIwMTM5MjUwMg==&amp;mid=506104436&amp;idx=1&amp;sn=85a95ea7bbf29c33020464355e0a8ed1&amp;chksm=0d30826d3a470b7bca9c6a273700dd7f19c3473d29a5b4ee5f22787d88502697ea8efca8d757&amp;mpshare=1&amp;scene=23&amp;srcid=0515yN4SRJd1qe4RaNWwBC98#rd</a></p>
<p>InfoQ - <a href="http://www.infoq.com/" target="_blank" rel="external">http://www.infoq.com/</a></p>
<ul>
<li>促进软件开发领域知识与创新的传播</li>
</ul>
<p>鸟哥的Linux私房菜 - <a href="http://vbird.dic.ksu.edu.tw/" target="_blank" rel="external">http://vbird.dic.ksu.edu.tw/</a></p>
<ul>
<li>我也是跟着鸟哥的文章进入Linux</li>
</ul>
<p>存储基础知识 - <a href="https://community.emc.com/thread/176852" target="_blank" rel="external">https://community.emc.com/thread/176852</a></p>
<ul>
<li>EMC官方整理的教程，由浅入深知识面也很广</li>
</ul>
<p>菜鸟教程 - <a href="http://www.runoob.com/" target="_blank" rel="external">http://www.runoob.com/</a></p>
<ul>
<li>学的不仅是技术，更是梦想</li>
<li>同类型还有w3school等</li>
</ul>
<p>自强学堂 - <a href="http://www.ziqiangxuetang.com/" target="_blank" rel="external">http://www.ziqiangxuetang.com/</a></p>
<ul>
<li>感谢@涂伟忠，Django可是自强学堂的招牌教程</li>
</ul>
<p>优设 - <a href="http://hao.uisdc.com/" target="_blank" rel="external">http://hao.uisdc.com/</a></p>
<ul>
<li>以前很喜欢腾讯CDC的设计理念，现在老了只能偶尔瞅瞅</li>
</ul>
<p>VMware - <a href="http://www.vmware.com/cn/support/support-resources/pubs/" target="_blank" rel="external">http://www.vmware.com/cn/support/support-resources/pubs/</a></p>
<ul>
<li>没有贴图还能把虚拟化手册写得灰常清晰具有可操作性，VMware必须得算一个</li>
<li>当然也推荐大家阅读RedHat，SuSE，Oracle等官方帮助文档</li>
</ul>
<h2 id="Blog"><a href="#Blog" class="headerlink" title="Blog"></a>Blog</h2><blockquote>
<p>推荐的Blog不多，希望大家找到适合自己的博客</p>
</blockquote>
<p>编程随想 - <a href="https://program-think.blogspot.com/" target="_blank" rel="external">https://program-think.blogspot.com/</a></p>
<ul>
<li>你应该了解一些真实的信息</li>
</ul>
<p>阮一峰 - <a href="http://www.ruanyifeng.com/" target="_blank" rel="external">http://www.ruanyifeng.com/</a></p>
<ul>
<li>坚持分享技术和生活的典范</li>
</ul>
<p>酷壳 - <a href="http://coolshell.cn/" target="_blank" rel="external">http://coolshell.cn/</a></p>
<ul>
<li>坚持更新技术类Blog的人或团队越来越少，这也是认真做事的态度</li>
</ul>
<h2 id="在线教育"><a href="#在线教育" class="headerlink" title="在线教育"></a>在线教育</h2><p>极客学院 - <a href="http://wiki.jikexueyuan.com/" target="_blank" rel="external">http://wiki.jikexueyuan.com/</a></p>
<ul>
<li>在线教育类网站很多，我不做太多推荐，极客学院Wiki是一个好产品</li>
</ul>
<p>网易公开课 - <a href="http://open.163.com/" target="_blank" rel="external">http://open.163.com/</a></p>
<ul>
<li>国内外优质的MOOC资源很丰富，一起系统的完善自己的知识体系吧</li>
</ul>
<p>Coursera - <a href="https://www.coursera.org/" target="_blank" rel="external">https://www.coursera.org/</a></p>
<ul>
<li>在网上学习全世界最好的课程</li>
<li>在国外生活的同学几乎都会推荐的网络学习平台</li>
</ul>
<h2 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h2><blockquote>
<p>还有很多需要耐心等待时间的验证</p>
</blockquote>
]]></content>
    
    <summary type="html">
    
      DevOps是一个持续改进的过程
    
    </summary>
    
      <category term="学习 | Study" scheme="https://wsgzao.github.io/categories/%E5%AD%A6%E4%B9%A0-Study/"/>
    
    
  </entry>
  
  <entry>
    <title>新加坡生活指北</title>
    <link href="https://wsgzao.github.io/post/singapore/"/>
    <id>https://wsgzao.github.io/post/singapore/</id>
    <published>2018-05-15T06:59:49.000Z</published>
    <updated>2018-05-28T07:47:23.686Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><blockquote>
<p>为帮助大家玩转新加坡、快速适应当地生活</p>
</blockquote>
<h2 id="更新历史"><a href="#更新历史" class="headerlink" title="更新历史"></a>更新历史</h2><p>2018年05月15日 - 初稿</p>
<p>阅读原文 - <a href="https://wsgzao.github.io/post/singapore/">https://wsgzao.github.io/post/singapore/</a></p>
<p><strong>扩展阅读</strong></p>
<p>新加坡外交部 - <a href="https://www.mfa.gov.sg/content/mfa/overseasmission/beijing/ch.html" target="_blank" rel="external">https://www.mfa.gov.sg/content/mfa/overseasmission/beijing/ch.html</a></p>
<hr>
<h2 id="认识狮城"><a href="#认识狮城" class="headerlink" title="认识狮城"></a>认识狮城</h2><p>姓名：新加坡</p>
<p>年龄：53岁（成立于1965年，国庆日为每年的8月9日）</p>
<p>家庭住址：北半球赤道地区，位于马来半岛最南端 （北纬1°22′，东经103°48′）</p>
<p>住房面积：新加坡国土面积710.3平方公里 （只比北京朝阳区大一点）</p>
<p>家庭成员：人口约520万，密度达到每平方公里7700多人（排在世界前列）</p>
<p>相貌特征：新加坡多元种族和文化的相互融合是其极具魅力的原因之一，由华族（占全国人口约四分之三）、欧亚族、印度族、马来族、土生华人构成。</p>
<p>性格特征：新加坡以实行严格的法律和制度著称，无论是居民还是游客，都需要予以足够重视，否则可能会被课以重罚。当然，如果您遵循当地法律规章，也不必过分担心。</p>
<blockquote>
<p>所获荣誉：或许这些荣誉只属于过去，我们更需要关心的是现在和未来会怎样</p>
</blockquote>
<p>让人最想移民的国家全球排名第一<br>全球最具竞争力国家排名第一<br>最适应亚洲人士居住的地方全球排名第一<br>城市基础设施建设全球排名第一<br>全球化程度最高的城市排名第一</p>
<p>其他方面：<a href="http://www.visitsingapore.com.cn/travel-guide-tips/about-singapore/" target="_blank" rel="external">http://www.visitsingapore.com.cn/travel-guide-tips/about-singapore/</a></p>
<h2 id="旅游出入境"><a href="#旅游出入境" class="headerlink" title="旅游出入境"></a>旅游出入境</h2><blockquote>
<p>签证</p>
</blockquote>
<p>中国公民去新加坡须提前申请有效签证，不可以落地签。</p>
<p>中国公民申请的新加坡旅游/商务签证为电子签证（e-Visa），在获得签证后，建议上网打印多份有效签证以防遗失。签证费为每人SG$30。</p>
<p>新加坡签证可多次入境，有效期分别有35天/62天/2年，由签证官根据申请人资料而定。逗留时间则由入境官决定，通常为14-30天。从2015年6月1日起新加坡将给予符合条件的中国公民有效期长达10年的多次入境签证。</p>
<p><a href="http://www.visitsingapore.com.cn/travel-guide-tips/travelling-to-singapore/" target="_blank" rel="external">http://www.visitsingapore.com.cn/travel-guide-tips/travelling-to-singapore/</a></p>
<blockquote>
<p>申请途径How to Apply</p>
</blockquote>
<p>2014年12月8日起大使馆及各领事馆停止接收签证申请，可登录新加坡外交部官网，查询中国国内官方指定的签证机构，办理新加坡签证。</p>
<blockquote>
<p>所需资料Required Information</p>
</blockquote>
<ol>
<li>个人信息表（登录新加坡外交部官网下载表格，链接：www.mfa.gov.sg）</li>
<li>户口本（原件或扫描电子版，户主+个人页复印件）</li>
<li>身份证（原件或正反面扫描电子版，正反面复印件）</li>
<li>护照（原件或个人页扫描电子版，个人页复印件，有效期6个月以上）</li>
<li>2张2寸白底免冠照片</li>
<li>在职证明原件或相关职业证书</li>
</ol>
<blockquote>
<p>出入境</p>
</blockquote>
<p>飞机上空姐会派发入境卡给需要的乘客，也可以在出入境大堂领取，入境卡为英文，入境后记得保留副联，离境时需再次出示并提交。</p>
<p>离境前别忘了退税，在附有“退税”标志的场所消费满100新币以上，即可退回7%的商品及服务税，退税时需出示购物发票或收据。具体的退税要求，可咨<br>询工作人员。</p>
<blockquote>
<p>其它注意事项</p>
</blockquote>
<p>电源插座：新加坡使用的标准电流是 220-240 伏特交流电（50 赫兹），在这里，您可以使用三眼电源插座。</p>
<p><a href="http://www.visitsingapore.com.cn/travel-guide-tips/" target="_blank" rel="external">http://www.visitsingapore.com.cn/travel-guide-tips/</a></p>
<p><img src="//ws3.sinaimg.cn/large/7207510dgy1frc1wdtdd7j20vh12047o.jpg" alt="image"></p>
<h2 id="新加坡重要电话"><a href="#新加坡重要电话" class="headerlink" title="新加坡重要电话"></a>新加坡重要电话</h2><p>报警：999<br>火警和救护车：995<br>海关：6355 2000<br>中国驻新加坡大使馆：6471 2117（证件咨询）<br>中国银行：6439 8741（汇款业务）<br>中央医院：6222 3322<br>樟宜医院：6788 8833<br>德士电话：6552 1111 / 6363 6888 / 67780808<br>新加坡人力部：6438 5122<br>新加坡税务局（个人）：1800 356 8300<br>新加坡海关：6355 2000<br>新加坡建屋局：6490 1111<br>新加坡移民局：6391 6100</p>
<h2 id="新加坡公共假期"><a href="#新加坡公共假期" class="headerlink" title="新加坡公共假期"></a>新加坡公共假期</h2><p><a href="https://www.mfa.gov.sg/content/mfa/overseasmission/beijing/ch/public_holidays.html" target="_blank" rel="external">https://www.mfa.gov.sg/content/mfa/overseasmission/beijing/ch/public_holidays.html</a></p>
<h2 id="新加坡通讯指南"><a href="#新加坡通讯指南" class="headerlink" title="新加坡通讯指南"></a>新加坡通讯指南</h2><p>国内的手机大部分都可以在新加坡直接换卡使用，除非你的手机是中国移动4G定制版本，由于网络制式的区别，无法使用新加坡4G网络，新加坡目前 2G 网络停止服务。</p>
<blockquote>
<p>小贴士：建议使用全网通手机，去国外任何地方都可以直接换卡使用。</p>
</blockquote>
<p>运营商：新电信（Singtel）、星河（Starhub）和 M1（Mobile One）</p>
<p>在新加坡机场、邮局、7-11便利店和代理商都可以购买和充值电话卡，记得一定要带上护照，新加坡的手机卡采用实名制。推荐大家下载所用运营商的 App，查询和购买话费、流量等。</p>
<p>1.新电信（Singtel）:新加坡最大电信公司，使用人数最多，信号强。</p>
<p>流量：10新币可以购买1GB，30天之内使用。20新币可以购买 3GB，30 天之内使用。</p>
<p>查询话费：<em>139#  查询流量: </em>139<em>3#  订购流量：</em>363</p>
<p>拨打国内电话：如拨打国内电话，请在拨打国内手机号之前加拨 01986，可节省部分话费；若拨打国内固定电话，请先拨打01986，再拨打区号（去掉前面第一个0）和固话号码。</p>
<p>详情请参考官网：<a href="http://info.singtel.com/" target="_blank" rel="external">http://info.singtel.com/</a></p>
<p>2.星河（Starhub）：电话费用经济实惠。流量的价格和新电信基本一致。</p>
<p>查询话费：<em>131#  查询流量: </em>123<em>300#  订购流量：</em>123*</p>
<p>拨打国内电话：如拨打国内电话，请在拨打国内手机号之前加拨 01886，可节省部分话费；若拨打国内固定电话，请先拨打01886，再拨打区号（去掉前面第一个 0）和固话号码。</p>
<p>详情请参考官网：<a href="http://www.starhub.com/" target="_blank" rel="external">http://www.starhub.com/</a></p>
<p>3.M1(Mobile One): 电话费用和流量价格与新电信基本一致。</p>
<p>查询话费：拨打 1267  订购流量：#100<em>7#  查询流量:#100</em>2#</p>
<p>如拨打国内长途电话，请在拨打国内手机号之前加拨 02186，可节省部分话费；若拨打国内固定电话，请先拨打 02186，再拨打区号（去掉前面第一个0）和固话号码。</p>
<p>详情请参考官网：<a href="https://www.m1.com.sg" target="_blank" rel="external">https://www.m1.com.sg</a></p>
<h2 id="新加坡交通指南"><a href="#新加坡交通指南" class="headerlink" title="新加坡交通指南"></a>新加坡交通指南</h2><p>新加坡主要交通出行方式：地铁（MRT）、轻轨（LRT）、巴士（Bus）和德士（Taxi）。</p>
<p>其中地铁（MRT）是新加坡最便捷的交通工具，也是日常最佳的出行方式。根据官方 2017 年 1 月份提供的最新信息显示，全岛共设有 142 个车站，目前主要的运营线中，南北运营线以“NS”红线标明，东西运营线以“EW”绿线标明，东北运营线以“NE”紫线标明，环线以“CC”黄线标明，市区运营线以“DT”蓝线。</p>
<p>新加坡地铁图</p>
<p><a href="https://exploresg.com/ditie/" target="_blank" rel="external">https://exploresg.com/ditie/</a></p>
<p>新加坡地铁和巴士车(站)内规定</p>
<ol>
<li>不可吃喝、吸烟、携带榴莲、大声喧哗和带宠物 </li>
<li>Bus 不报站、上下车需要刷卡</li>
</ol>
<p>温馨提示</p>
<ol>
<li>地铁和巴士上冷气很足，建议携带薄外套</li>
<li>在 20 分钟内，地铁和巴士之间转换，车资有优惠</li>
<li>在地铁或者商场等使用扶梯时，左侧是站立侧，右侧是快速通道</li>
</ol>
<h2 id="新加坡医疗指南"><a href="#新加坡医疗指南" class="headerlink" title="新加坡医疗指南"></a>新加坡医疗指南</h2><p>新加坡是一个热带国家，从国内刚过去有可能因水土不服引起的伤风、感冒、皮肤敏感或蚊虫叮咬等。出行之前可以带一些三九胃泰、牛黄解毒等日常药品之类的药品，防范于未然是最好的。</p>
<p>看医生：在新加坡持有工作签证，所在的公司会按照新加坡劳工部规定给每位员工会购买医疗保险或者费用报销。</p>
<p>医疗保险：一般是三种模式</p>
<ol>
<li>直接去合作门诊，提供公司信息，看病不用自己拿钱。</li>
<li>直接去合作门诊，提供公司信息，看病前给门诊 5 新币（每个公司不一样），其它的费用不用自己拿。</li>
<li>直接去合作门诊，自己先付产生的费用，然后去公司报销。意外伤害险等（视公司合同规定）。</li>
</ol>
<h2 id="新加坡房屋指南"><a href="#新加坡房屋指南" class="headerlink" title="新加坡房屋指南"></a>新加坡房屋指南</h2><blockquote>
<p>组屋(HDB)</p>
</blockquote>
<p>新加坡的“组屋”，全称为组合房屋。由新加坡建屋发展局（HDB）不以盈利为目的承担建筑的楼房，为大部分新加坡人（80%）的住所。</p>
<p>组屋一般分为三房式、四房式和五房式。三房式指一厅两房，使用面积约 60 平方米；四房式是一厅三房，使用面积约 90 平方米；五房式是两厅三房，使用面积大致在 110 平方米。</p>
<p>组屋的区分都是按照地区名+数字，例如：PasirRis Block 186（巴西立大牌 186）、YishunBlock 210（义顺大牌 210）等。</p>
<p>屋内客厅，厨房，卫生间都是公用设施，一般会配备冰箱，洗衣机，空调或者风扇。</p>
<p>租房费用（一般情况下）：</p>
<p>新型组屋(近10年内建成的)相对条件会好很多 (平均价格S$1000-1200/间)<br>单人单间：500-1000新币<br>二人间：350-550新币/人<br>四人间：270-350新币/人</p>
<p><strong>小贴士</strong></p>
<ol>
<li>新加坡政府规定租住的房子必须要能在建屋局上注册。正常情况下，注册要求至少住 6 个月。如果不能注册，就是不合法的房屋。</li>
<li>如果退租，一定要提前一月声明，以防押金不退。</li>
<li>仔细看合同，仔细看合同，仔细看合同。</li>
</ol>
<blockquote>
<p>私人公寓(Condo)</p>
</blockquote>
<p>公寓，常见两房式或三房式，相当于国内的高档成熟社区，内有免费游泳池、健身房，BBQ等公共设施，住宿环境相对较好，价格也相对高一些；大部分的condo房间都有主人房与非主人房之分，主人房有自己独立的洗手间和相对宽敞的卧室，当然价格也比非主人房高200-300/月(非主人房平均价格<br>S$1,000-1,500/间/月)</p>
<blockquote>
<p>排屋(Terrace)</p>
</blockquote>
<p>独门不独栋的联排别墅，此类出租房源相对较少，住宿环境、价格与房子位置、条件有相当大的关系。</p>
<blockquote>
<p>独栋别墅(Landedproperty)<br>少见于房间出租。</p>
</blockquote>
<h2 id="货币兑换和汇款"><a href="#货币兑换和汇款" class="headerlink" title="货币兑换和汇款"></a>货币兑换和汇款</h2><p>新加坡实行货币开放政策，货币兑换中心随处可见。尤其是在牛车水(China Town)附近。新学员到新加坡后，如有汇款需求到国内，可以先去牛车水汇款(珍珠坊二楼)，方便快捷。等周围熟悉后，推荐去淡宾尼(Tampines)汇款到国内，汇率会比其它地方高一些。具体的地方，在地图搜索Tampines Money Exchange Center，或者求助学生服务团队成员。 </p>
<p>小贴士：汇款中心一般可以汇到中国邮政、中国农业、中国交通、中国招商和中国银行等。第一次汇钱到国内，当填写汇款单据的时候一定要知道对方银行卡是在<strong>省</strong>市**银行支行开户的(很重要)。</p>
<h2 id="法律法规"><a href="#法律法规" class="headerlink" title="法律法规"></a>法律法规</h2><p>新加坡向来是给世人展示优美环境，井然秩序，舒适安全的名片，然而这些美好的展现离不开新加坡法律制度的约束和规范。Singaporeis a“fine”country完整的诠释了这两方面。所以在新加坡生活，你需要注意以下细节：</p>
<ol>
<li>自动排队：公共场合最经常听到的一句话就是please queue！</li>
<li>着装：不同场合穿不同衣服,建议每天换衣服。</li>
<li>公共习惯：乘坐公共交通或者在公共场合用餐时,切忌大声喧哗,不然你一样会被当做异类奥!而且记得再饿也要撑到下车再用餐。</li>
<li>言论：新加坡是多文化和宗教融合的国家,公共场合不要发表敏感政治言论或者宗教话题,这也体现互相尊重。</li>
<li>不当行为：竖中指可能会被当做种族歧视处理的</li>
<li>如厕：来也匆匆,去也冲冲。如若不然请准备 500 新币吧。</li>
<li>口香糖：公共场所不允许嚼口香糖,不可以随意买卖,允许带少量入境,正是这个奇葩的规定维护了公共环境的整洁。</li>
<li>吸烟：新加坡公共场所绝对禁烟。如若吸烟不幸被抓到,恭喜你一个月的工资(高达 2000 新币)为国家做贡献了!</li>
<li>垃圾：乱丢垃圾初犯者将处高达 1000 新币罚款,再犯者将罚款额提高至 2000 新币以及在劳改法令下受罚。</li>
<li>交通规则：闯红灯,随便乱穿马路这些不多啰嗦。违反的是规则,伤害的是人身安全,因为小编也感觉马路上的车如同闪电般行驶。</li>
<li>不可非法聚会和使用暴力</li>
</ol>
<p>以上内容是提醒大家在生活细节方面应遵守的规则,但有些行为未必就可以罚款结案的,比如:签证到期后逾期逗留、抢劫、公共场所涂鸦、纵火、携带毒品等这些可都是在鞭刑的定罪范围内的。</p>
<p><strong>最后郑重的提醒各位：</strong>在机场不要发扬助人为乐精神帮陌生人携带物品,因为很有可能你同时把生命交给了别人(运输毒品和贩毒同罪)。</p>
<h2 id="工作准证遗失如何处理"><a href="#工作准证遗失如何处理" class="headerlink" title="工作准证遗失如何处理"></a>工作准证遗失如何处理</h2><ol>
<li>发现丢失后立即携带护照或者工作准证的复印件到任何一间警察局报案，记得保存报案记录原件。</li>
<li>通知雇主公司 HR,让其在 7 天之内在新加坡人力部网上提交补办工作准证的申请。</li>
<li>费用:首次补办 100 新币,第二次是 300 新币(一般在提交申请补办 4 个工作日可去新卡)</li>
</ol>
<h2 id="银行卡遗失如何处理"><a href="#银行卡遗失如何处理" class="headerlink" title="银行卡遗失如何处理"></a>银行卡遗失如何处理</h2><ol>
<li>发现遗失后立即拨打银行客户服务中心热线挂失</li>
<li>银行客户专员会核对护照和工作准证信息,然后等待新卡邮寄到住处或者去支行直接领取。</li>
</ol>
<p>POSB 用户请拨打 18003396963<br>DBS 用户请拨打 18001111111<br>UOB 用户请拨打 18002222121<br>OCBC 用户请拨打 18003633333</p>
<h2 id="护照遗失如何处理"><a href="#护照遗失如何处理" class="headerlink" title="护照遗失如何处理"></a>护照遗失如何处理</h2><p>如护照遗失或被盗,请立即到中国驻新加坡大使馆如实填写《护照遗失陈述表》，提供关于护照遗失或被盗的情况说明,以及提供报警记录原件及复印件。如护照损毁,请提交损毁的护照,以及护照损毁的原因说明。</p>
<p>具体的更换护照和网上预约等等详细流程请参考大使馆的官网：<a href="http://www.chinaembassy.org.sg/chn/" target="_blank" rel="external">http://www.chinaembassy.org.sg/chn/</a></p>
<p>中国驻新加坡大使馆信息:</p>
<p>地址:150 TANGLIN ROAD,SINGAPORE 247969</p>
<p>Ø领事部：64712117；92971517(仅限紧急领保求助,不接受证件咨询)</p>
<p>Email: chinaemb_sg@mfa.gov.cn</p>
<p>办公时间：周一至周五(节假日除外)</p>
<p>上午 9:00-11:30</p>
<h2 id="新加坡日常-App-推荐"><a href="#新加坡日常-App-推荐" class="headerlink" title="新加坡日常 App 推荐"></a>新加坡日常 App 推荐</h2><p>交通: Grab(类似国内滴滴)、Google Map(谷歌地图)、SG Buses(公交时刻表)</p>
<p>社交: Facebook、WhatsApp、Twitter、Instagram</p>
<p>购物: Qoo10(类似国内淘宝)、Lazada(类似国内京东)、eBay(易贝网)、Amazon(亚马逊)、淘宝国际</p>
<p>娱乐: Youtube(视频必备)、 Golden Village(电影院)、CATHAY (电影院)、千寻影视</p>
<p>工具: Google Translate(翻译 App)、XE Currency(汇率查询)、MX player(视频播放软件)、Quora(知识分享平台)、Airbnb(共享租房)、Yelp(美式点评)</p>
<h2 id="新加坡入境卡模板-重要"><a href="#新加坡入境卡模板-重要" class="headerlink" title="新加坡入境卡模板(重要)"></a>新加坡入境卡模板(重要)</h2><p><img src="//ws3.sinaimg.cn/large/7207510dgy1frc1vhyoaqj20fa0skq56.jpg" alt="image"></p>
<p><img src="//ws3.sinaimg.cn/large/7207510dgy1frc1w3vig9j20f60egq3m.jpg" alt="image"></p>
<h2 id="租房"><a href="#租房" class="headerlink" title="租房"></a>租房</h2><p>Property Guru - <a href="http://www.propertyguru.com.sg/" target="_blank" rel="external">http://www.propertyguru.com.sg/</a></p>
<p>新加坡本地发布平台，房源多。高度推荐！使用下来感觉Property Guru信息发布是最多的，信息筛选条件多，容易搜索到希望的房源。多为中介发布，有中介费。</p>
<p>Nestia - <a href="https://www.nestia.com/" target="_blank" rel="external">https://www.nestia.com/</a></p>
<p>新加坡本地发布平台，房源多。高度推荐！Nestia上的房源也比较多，但感觉不如Property Guru。不过Nestia可以以某一建筑（公司地址）为中心从远及近的搜索房源。找步行距离的房源就很合适了。另外自带的导航也不错。所以我是Property Guru和Nestia结合使用。</p>
<p>在新加坡租房，有哪些经验可以分享？<br><a href="https://www.zhihu.com/question/22430961" target="_blank" rel="external">https://www.zhihu.com/question/22430961</a></p>
]]></content>
    
    <summary type="html">
    
      为帮助大家玩转新加坡、快速适应当地生活
    
    </summary>
    
      <category term="生活 | Life" scheme="https://wsgzao.github.io/categories/%E7%94%9F%E6%B4%BB-Life/"/>
    
    
  </entry>
  
  <entry>
    <title>Ansible 学习指北</title>
    <link href="https://wsgzao.github.io/post/ansible/"/>
    <id>https://wsgzao.github.io/post/ansible/</id>
    <published>2018-05-15T02:59:49.000Z</published>
    <updated>2018-05-15T07:19:07.064Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>因为工作的缘故接触并积极推动Ansible在企业级生产环境的落地，独立承担并实现了《基于ansible的主机自动化配置管理》项目，此前也先后接触过Puppet和SaltStack，本文不会讨论开源或者自主研发方案的优劣，重点是和大伙儿分享自己在ansible技术领域积累的一些项目实战经验，如果大家遇到任何问题也欢迎通过留言或者其他方式进行互动，我尽力做到有效回复。</p>
<blockquote>
<p>Ansible is Simple IT Automation</p>
</blockquote>
<h2 id="更新历史"><a href="#更新历史" class="headerlink" title="更新历史"></a>更新历史</h2><p>2018年05月15日 - 初稿</p>
<p>阅读原文 - <a href="https://wsgzao.github.io/post/ansible/">https://wsgzao.github.io/post/ansible/</a></p>
<p><strong>扩展阅读</strong></p>
<p>ansible - <a href="https://docs.ansible.com/" target="_blank" rel="external">https://docs.ansible.com/</a></p>
<hr>
<h2 id="Ansible-标准化学习路径"><a href="#Ansible-标准化学习路径" class="headerlink" title="Ansible 标准化学习路径"></a>Ansible 标准化学习路径</h2><blockquote>
<p>Ansible相关的书籍在逐步增多，由于Ansible版本迭代更新频率高但学习成本低，个人建议书为辅，官方文档为主</p>
</blockquote>
<p>Ansible is an IT automation tool. It can configure systems, deploy software, and orchestrate more advanced IT tasks such as continuous deployments or zero downtime rolling updates.</p>
<p>Ansible’s main goals are simplicity and ease-of-use. It also has a strong focus on security and reliability, featuring a minimum of moving parts, usage of OpenSSH for transport (with other transports and pull modes as alternatives), and a language that is designed around auditability by humans–even those not familiar with the program.</p>
<p>We believe simplicity is relevant to all sizes of environments, so we design for busy users of all types: developers, sysadmins, release engineers, IT managers, and everyone in between. Ansible is appropriate for managing all environments, from small setups with a handful of instances to enterprise environments with many thousands of instances.</p>
<p>Ansible manages machines in an agent-less manner. There is never a question of how to upgrade remote daemons or the problem of not being able to manage systems because daemons are uninstalled. Because OpenSSH is one of the most peer-reviewed open source components, security exposure is greatly reduced. Ansible is decentralized–it relies on your existing OS credentials to control access to remote machines. If needed, Ansible can easily connect with Kerberos, LDAP, and other centralized authentication management systems.</p>
<p>This documentation covers the current released version of Ansible and also some development version features. For recent features, we note in each section the version of Ansible where the feature was added.</p>
<p>Ansible releases a new major release of Ansible approximately every two months. The core application evolves somewhat conservatively, valuing simplicity in language design and setup. However, the community around new modules and plugins being developed and contributed moves very quickly, adding many new modules in each release.</p>
<blockquote>
<p>Ansible Lightbulb 是 Ansible 官方推荐的入门教材，普通用户大概只需要10-20分钟时间即可入门</p>
</blockquote>
<p>The Ansible Lightbulb project is an effort to provide a content toolkit and educational reference for effectively communicating and teaching Ansible topics.</p>
<p>Ansible Lightbulb - <a href="https://github.com/ansible/lightbulb" target="_blank" rel="external">https://github.com/ansible/lightbulb</a></p>
<blockquote>
<p>Ansible Documentation 是 Ansible 官方文档，我的建议还是对英文不要害怕，多动手查多敲命令去理解</p>
</blockquote>
<p>Ansible Documentation - <a href="http://docs.ansible.com/ansible/latest/index.html" target="_blank" rel="external">http://docs.ansible.com/ansible/latest/index.html</a></p>
<h2 id="基于-Ansible-的开源项目"><a href="#基于-Ansible-的开源项目" class="headerlink" title="基于 Ansible 的开源项目"></a>基于 Ansible 的开源项目</h2><blockquote>
<p>第一个是ansible官方开源项目，其他都是和ansible相关的运维平台开源项目，推荐学习和参考</p>
</blockquote>
<p>Ansible - <a href="https://github.com/ansible/ansible" target="_blank" rel="external">https://github.com/ansible/ansible</a></p>
<p>Jumpserver - <a href="http://www.jumpserver.org/" target="_blank" rel="external">http://www.jumpserver.org/</a> </p>
<p>OpsManage - <a href="https://github.com/welliamcao/OpsManage" target="_blank" rel="external">https://github.com/welliamcao/OpsManage</a> </p>
<p>adminset - <a href="https://github.com/guohongze/adminset" target="_blank" rel="external">https://github.com/guohongze/adminset</a> </p>
<h2 id="Ansible-项目实践"><a href="#Ansible-项目实践" class="headerlink" title="Ansible 项目实践"></a>Ansible 项目实践</h2><blockquote>
<p>以下内容来自于《基于ansible的主机自动化配置管理》项目，基于ansible目前可以满足生产环境所有基线要求，相信对大家有一定的参考价值</p>
</blockquote>
<p><img src="//ws3.sinaimg.cn/large/7207510dgy1frc11ptyclj21092x9th8.jpg" alt="image"></p>
<p><img src="//ws3.sinaimg.cn/large/7207510dgy1frc11zz64jj20pe0fxtc4.jpg" alt="image"></p>
<h3 id="ansible-部署"><a href="#ansible-部署" class="headerlink" title="ansible 部署"></a>ansible 部署</h3><blockquote>
<p>因为生产环境为内外网物理隔离，所有的安装部署都是离线进行的</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Install Packages</span></div><div class="line">yum install gcc zlib zlib-devel openssl-devel -y</div><div class="line"></div><div class="line"><span class="comment"># Install Python</span></div><div class="line">tar xf Python-2.7.14.tgz</div><div class="line"><span class="built_in">cd</span> Python-2.7.14</div><div class="line">./configure</div><div class="line">make</div><div class="line">make install</div><div class="line"><span class="built_in">cd</span> ..</div><div class="line"></div><div class="line"><span class="comment"># renew python env</span></div><div class="line"><span class="built_in">exit</span></div><div class="line"></div><div class="line"><span class="comment"># ImportError: No module named six.moves</span></div><div class="line">tar xf six-1.11.0.tar.gz </div><div class="line"><span class="built_in">cd</span> six-1.11.0</div><div class="line">python setup.py install</div><div class="line"><span class="built_in">cd</span> ..</div><div class="line"></div><div class="line"><span class="comment"># ImportError: No module named packaging.version</span></div><div class="line">tar xf packaging-17.1.tar.gz </div><div class="line"><span class="built_in">cd</span> packaging-17.1</div><div class="line">python setup.py install</div><div class="line"><span class="built_in">cd</span> ..</div><div class="line"></div><div class="line"><span class="comment"># ImportError: No module named pyparsing</span></div><div class="line">tar xf pyparsing-2.2.0.tar.gz </div><div class="line"><span class="built_in">cd</span> pyparsing-2.2.0</div><div class="line">python setup.py install</div><div class="line"><span class="built_in">cd</span> ..</div><div class="line"></div><div class="line"><span class="comment"># ImportError: No module named appdirs</span></div><div class="line">tar xf appdirs-1.4.3.tar.gz </div><div class="line"><span class="built_in">cd</span> appdirs-1.4.3</div><div class="line">python setup.py install</div><div class="line"><span class="built_in">cd</span> ..</div><div class="line"></div><div class="line"><span class="comment"># Install Setuptools</span></div><div class="line">unzip setuptools-38.5.2.zip</div><div class="line"><span class="built_in">cd</span> setuptools-38.5.2</div><div class="line">python setup.py install</div><div class="line"><span class="built_in">cd</span> ..</div><div class="line"></div><div class="line"><span class="comment"># Install pip</span></div><div class="line">tar xf pip-9.0.1.tar.gz</div><div class="line"><span class="built_in">cd</span> pip-9.0.1</div><div class="line">python setup.py install</div><div class="line"><span class="built_in">cd</span> ..</div><div class="line"></div><div class="line"><span class="comment"># pip 离线下载</span></div><div class="line"><span class="comment"># pip download -d DIR -r requirements.txt</span></div><div class="line">pip download -d ~/ansible/ ansible</div><div class="line"></div><div class="line"><span class="comment"># pip 离线安装</span></div><div class="line"><span class="comment"># pip install --no-index --find-links=DIR -r requirements.txt</span></div><div class="line">pip install --no-index --find-links=pip-ansible-2.3.3/ -r requirements.txt</div><div class="line">pip install --no-index --find-links=pip-ansible-2.5.0/ -r requirements.txt -U</div><div class="line"></div><div class="line"><span class="comment"># pip 离线安装pipenv</span></div><div class="line">pip install --no-index --find-links=pip-pipenv/ pipenv</div><div class="line"></div><div class="line"><span class="comment"># 使用pipenv创建虚拟环境</span></div><div class="line">mkdir win_ansible</div><div class="line"><span class="built_in">cd</span> win_ansible</div><div class="line">pipenv shell</div><div class="line">pip install --no-index --find-links=pip-ansible-2.5.2/ -r requirements.txt</div></pre></td></tr></table></figure>
<h3 id="ansible-cfg-配置解析"><a href="#ansible-cfg-配置解析" class="headerlink" title="ansible.cfg 配置解析"></a>ansible.cfg 配置解析</h3><blockquote>
<p>ansible.cfg不影响执行结果但合理的配置会有效提升效率</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 配置文件路径（优先级）</span></div><div class="line">./ansible.cfg</div><div class="line">/etc/ansible/ansible.cfg</div><div class="line"></div><div class="line"><span class="comment"># 配置文件内容</span></div><div class="line">[defaults]</div><div class="line"><span class="comment">#inventory = /etc/ansible/hosts</span></div><div class="line"><span class="comment">#log_path = /var/log/ansible.log</span></div><div class="line">forks = 100 <span class="comment"># 设置并发数</span></div><div class="line">host_key_checking = False <span class="comment"># 不检查SSH主机登录的密钥</span></div><div class="line">display_skipped_hosts = False <span class="comment"># 不显示已跳过的主机</span></div><div class="line">retry_files_enabled = False <span class="comment"># 不创建任务失败后的重试文件</span></div><div class="line"><span class="comment"># 按照1d设置setup缓存，优化执行效率</span></div><div class="line">gathering = smart</div><div class="line">fact_caching_timeout = 86400</div><div class="line">fact_caching = jsonfile</div><div class="line">fact_caching_connection = cachedir</div></pre></td></tr></table></figure>
<h3 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h3><ul>
<li>服务端操作系统：RHEL 6/7（Windows不可作为控制端）</li>
<li>服务端Python版本：2.7.14（实测安装完成无需额外调整）</li>
<li>Ansible版本：2.3.3.0（实测2.4以上版本已不支持rhel5.5，客户端需simplejson）</li>
<li>管理对象：目前主要针对RHEL 5/6/7（Windows使用高版本Ansible）</li>
<li>基线标准：参考《主机岗配置基线 v1.1.xlsx》</li>
</ul>
<blockquote>
<p>服务端</p>
</blockquote>
<ul>
<li>操作系统版本：RHEL 6/7</li>
<li>Python版本：2.7.14</li>
<li>安装方式：pip离线安装依赖包</li>
</ul>
<blockquote>
<p>客户端</p>
</blockquote>
<ul>
<li>操作系统版本：RHEL 5/6/7</li>
<li>非最小模式安装无需做调整</li>
<li>RHEL5.5需要安装simplejson</li>
</ul>
<blockquote>
<p>核心用法</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 检测ansible是否可以正常访问主机</span></div><div class="line">ansible-playbook -i hosts playbooks/ping.yml -v</div><div class="line"><span class="comment"># 配置好inventory，执行以下命令创建用户并建立信任关系</span></div><div class="line">ansible-playbook -i hosts playbooks/user/default.yml -v</div><div class="line"><span class="comment"># 配置时间同步/进程服务/基线文件</span></div><div class="line">ansible-playbook -i hosts playbooks/baseline/cfgset.yml -v</div><div class="line">ansible-playbook -i hosts playbooks/baseline/cfgset.yml -v --tags=<span class="string">"repo"</span></div><div class="line">ansible-playbook -i hosts playbooks/baseline/cfgset.yml -v --skip-tags=<span class="string">"ntp,repo"</span></div><div class="line"><span class="comment"># 更新系统软件包和补丁包</span></div><div class="line">ansible-playbook -i hosts playbooks/baseline/pakset.yml -v</div><div class="line"><span class="comment"># 修改用户密码</span></div><div class="line">ansible-playbook -i hosts_changepw playbooks/user/changepw.yml -v -e <span class="string">"@userpass.json"</span></div><div class="line"><span class="comment"># 备份配置，支持自定义日期命名，默认为"%Y%m%d"</span></div><div class="line">ansible-playbook -i hosts backup/backup.yml -v</div><div class="line"><span class="comment"># 恢复配置，支持按日期目录全局或者局部主机恢复</span></div><div class="line">ansible-playbook -i hosts backup/restore.yml -v -e <span class="string">"var_backup_date=20180305"</span></div></pre></td></tr></table></figure>
<h3 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h3><ul>
<li>服务端操作系统：RHEL 6/7（Windows不可作为控制端）</li>
<li>服务端Python版本：2.7.14（实测安装完成无需额外调整）</li>
<li>Ansible版本：2.5.0（Windows原生模块支持需要持续更新Ansible新版本）</li>
<li>管理对象：目前主要针对Windows 7/2008/2012（不支持xp/2003）</li>
<li>基线标准：参考《Windows 安全基线》</li>
</ul>
<blockquote>
<p>服务端</p>
</blockquote>
<ul>
<li>操作系统版本：RHEL 6/7</li>
<li>Python版本：2.7.14</li>
<li>安装方式：pip离线安装依赖包（目前使用pipenv切换管理Linux和Windows）</li>
</ul>
<blockquote>
<p>客户端</p>
</blockquote>
<ul>
<li>操作系统版本：Window 7/2008/2012</li>
<li>WinRM（Windows 7/2008 需要升级至 Powershell v3.0）</li>
</ul>
<blockquote>
<p>核心用法</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 检测ansible是否可以正常访问主机</span></div><div class="line">ansible-playbook -i hosts win_playbooks/ping.yml -v</div><div class="line"><span class="comment"># 配置好inventory，执行以下命令创建用户并建立信任关系</span></div><div class="line">ansible-playbook -i hosts win_playbooks/user/default.yml -v</div><div class="line"><span class="comment"># 配置时间同步/进程服务/基线文件</span></div><div class="line">ansible-playbook -i hosts win_playbooks/baseline/cfgset.yml -v</div><div class="line">ansible-playbook -i hosts win_playbooks/baseline/cfgset.yml -v --tags=<span class="string">"wsus"</span></div><div class="line">ansible-playbook -i hosts win_playbooks/baseline/cfgset.yml -v --skip-tags=<span class="string">"ntp,wsus"</span></div><div class="line"><span class="comment"># 更新系统软件包和补丁包</span></div><div class="line">ansible-playbook -i hosts win_playbooks/baseline/pakset.yml -v</div><div class="line"><span class="comment"># 修改用户密码</span></div><div class="line">ansible-playbook -i win_hosts_changepw win_playbooks/user/changepw.yml -v -e <span class="string">"@userpass.json"</span></div><div class="line"><span class="comment"># 备份配置，支持自定义日期命名，默认为"%Y%m%d"</span></div><div class="line">ansible-playbook -i win_hosts win_backup/backup.yml -v</div><div class="line"><span class="comment"># 恢复配置，支持按日期目录全局或者局部主机恢复</span></div><div class="line">ansible-playbook -i win_hosts win_backup/restore.yml -v -e <span class="string">"var_backup_date=20180305"</span></div></pre></td></tr></table></figure>
<h2 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h2><blockquote>
<p>很抱歉我暂时不能分享全部信息，但是这并不妨碍技术上的交流，我会逐步分享有价值的可公开代码</p>
</blockquote>
<ol>
<li>遵循what/why/how思路，要理解ansible能解决什么问题，为什么选择ansible，怎么使用ansible去解决</li>
<li>Ansible学习成本低但不等同于没有难度，学习路径推荐参考官方文档并积极实践，官网没有答案要善用Google搜索</li>
<li>Ansible纯后台模式只解决了部分问题，还有更多需求要通过基于Ansible的自动化运维平台来实现，拥抱开源技术不能固步自封</li>
</ol>
]]></content>
    
    <summary type="html">
    
      Ansible is Simple IT Automation
    
    </summary>
    
      <category term="学习 | Study" scheme="https://wsgzao.github.io/categories/%E5%AD%A6%E4%B9%A0-Study/"/>
    
    
  </entry>
  
  <entry>
    <title>Django 1.11 和 Django 2.0 学习笔记</title>
    <link href="https://wsgzao.github.io/post/django/"/>
    <id>https://wsgzao.github.io/post/django/</id>
    <published>2018-05-10T06:59:49.000Z</published>
    <updated>2018-05-16T07:12:54.323Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>Django 1.11<br>Django 2.0</p>
<blockquote>
<p>Django 1.x 和 Django2.x 学习笔记</p>
</blockquote>
<h2 id="更新历史"><a href="#更新历史" class="headerlink" title="更新历史"></a>更新历史</h2><p>2018年05月04日 - 初稿</p>
<p>阅读原文 - <a href="https://wsgzao.github.io/post/django/">https://wsgzao.github.io/post/django/</a></p>
<p><strong>扩展阅读</strong></p>
<p>Django - <a href="https://www.djangoproject.com/" target="_blank" rel="external">https://www.djangoproject.com/</a></p>
<hr>
<h2 id="Django-简介"><a href="#Django-简介" class="headerlink" title="Django 简介"></a>Django 简介</h2><p>Django 文档 - <a href="https://docs.djangoproject.com/zh-hans/2.0/" target="_blank" rel="external">https://docs.djangoproject.com/zh-hans/2.0/</a></p>
<p>使用Anaconda实现Python2和Python3共存及相互转换 - <a href="https://wsgzao.github.io/post/anaconda/">https://wsgzao.github.io/post/anaconda/</a></p>
<h2 id="Django-1-11"><a href="#Django-1-11" class="headerlink" title="Django 1.11"></a>Django 1.11</h2><blockquote>
<p>以下操作为 anaconda python3.6 环境下进入Anaconda Prompt安装django 1.11的实践过程</p>
</blockquote>
<p><a href="https://docs.djangoproject.com/en/1.11/intro/tutorial01/" target="_blank" rel="external">https://docs.djangoproject.com/en/1.11/intro/tutorial01/</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 在python3.6环境下进入Anaconda Prompt创建django1.x专用虚拟环境</span></div><div class="line">conda create -n django1.x</div><div class="line"><span class="comment"># 激活专用虚拟环境</span></div><div class="line">conda activate django1.x</div><div class="line"><span class="comment"># 查看conda当前django可用版本</span></div><div class="line">conda search django</div><div class="line">conda install django==1.11.10</div><div class="line"><span class="comment"># 切换到虚拟环境家目录</span></div><div class="line"><span class="built_in">cd</span> C:\Users\wsgzao\AppData\Local\conda\conda\envs\django1.x</div><div class="line"><span class="comment"># 创建项目</span></div><div class="line">django-admin startproject mysite</div><div class="line"><span class="comment"># 启动Django中的开发服务器</span></div><div class="line"><span class="built_in">cd</span> mysite</div><div class="line">python manage.py runserver</div><div class="line"><span class="comment"># 创建app</span></div><div class="line">python manage.py startapp myapp</div><div class="line"><span class="comment"># 帮助文档</span></div><div class="line">python manage.py -h</div><div class="line"><span class="comment"># Django命令</span></div><div class="line">python manage.py &lt;<span class="built_in">command</span>&gt; [options]</div></pre></td></tr></table></figure>
<h2 id="Django-2-0"><a href="#Django-2-0" class="headerlink" title="Django 2.0"></a>Django 2.0</h2><blockquote>
<p>以下操作为 anaconda python3.6 环境下进入Anaconda Prompt安装django 2.0的实践过程</p>
</blockquote>
<p><a href="https://docs.djangoproject.com/zh-hans/2.0/intro/tutorial01/" target="_blank" rel="external">https://docs.djangoproject.com/zh-hans/2.0/intro/tutorial01/</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 在python3.6环境下进入Anaconda Prompt创建django2.x专用虚拟环境</span></div><div class="line">conda create -n django2.x</div><div class="line"><span class="comment"># 激活专用虚拟环境</span></div><div class="line">conda activate djangox.x</div><div class="line"><span class="comment"># 查看conda当前django可用版本</span></div><div class="line">conda search django</div><div class="line">conda install django</div><div class="line"><span class="comment"># 切换到虚拟环境家目录</span></div><div class="line"><span class="built_in">cd</span> C:\Users\wsgzao\AppData\Local\conda\conda\envs\django2.x</div><div class="line"><span class="comment"># 创建项目</span></div><div class="line">django-admin startproject mysite</div><div class="line"><span class="comment"># 启动Django中的开发服务器，万不要将这个服务器用于和生产环境相关的任何地方，这个服务器只是为了开发而设计的</span></div><div class="line"><span class="built_in">cd</span> mysite</div><div class="line">python manage.py runserver</div><div class="line"><span class="comment"># 默认情况下，runserver 命令会将服务器设置为监听本机内部 IP 的 8000 端口，如果你想更换服务器的监听端口，请使用命令行参数</span></div><div class="line">python manage.py runserver 8080</div><div class="line"><span class="comment"># 0 是 0.0.0.0 的简写</span></div><div class="line">python manage.py runserver 0:8000</div><div class="line"><span class="comment"># 帮助文档</span></div><div class="line">python manage.py -h</div><div class="line"><span class="comment"># Django命令</span></div><div class="line">python manage.py &lt;<span class="built_in">command</span>&gt; [options]</div><div class="line"></div><div class="line"><span class="comment"># mysite目录结构</span></div><div class="line">mysite/</div><div class="line">    manage.py</div><div class="line">    mysite/</div><div class="line">        __init__.py</div><div class="line">        settings.py</div><div class="line">        urls.py</div><div class="line">        wsgi.py</div></pre></td></tr></table></figure>
<p>这些目录和文件的用处是：</p>
<ul>
<li>最外层的:file: mysite/ 根目录只是你项目的容器， Django 不关心它的名字，你可以将它重命名为任何你喜欢的名字。</li>
<li>manage.py: 一个让你用各种方式管理 Django 项目的命令行工具。你可以阅读 django-admin and manage.py 获取所有 manage.py 的细节。</li>
<li>里面一层的 mysite/ 目录包含你的项目，它是一个纯 Python 包。它的名字就是当你引用它内部任何东西时需要用到的 Python 包名。 (比如 mysite.urls).</li>
<li>mysite/<strong>init</strong>.py：一个空文件，告诉 Python 这个目录应该被认为是一个 Python 包。如果你是 Python 初学者，阅读官方文档中的 更多关于包的知识。</li>
<li>mysite/settings.py：Django 项目的配置文件。如果你想知道这个文件是如何工作的，请查看 Django settings 了解细节。</li>
<li>mysite/urls.py：Django 项目的 URL 声明，就像你网站的“目录”。阅读 URL调度器 文档来获取更多关于 URL 的内容。</li>
<li>mysite/wsgi.py：作为你的项目的运行在 WSGI 兼容的Web服务器上的入口。阅读 如何使用 WSGI 进行部署 了解更多细节。</li>
</ul>
<blockquote>
<p>会自动重新加载的服务器 runserver</p>
</blockquote>
<p>用于开发的服务器在需要的情况下会对每一次的访问请求重新载入一遍 Python 代码。所以你不需要为了让修改的代码生效而频繁的重新启动服务器。然而，一些动作，比如添加新文件，将不会触发自动重新加载，这时你得自己手动重启服务器。</p>
]]></content>
    
    <summary type="html">
    
      Django 1.x 和 Django2.x 学习笔记
    
    </summary>
    
      <category term="学习 | Study" scheme="https://wsgzao.github.io/categories/%E5%AD%A6%E4%B9%A0-Study/"/>
    
    
  </entry>
  
  <entry>
    <title>HPQLOCFG 批量管理 HP iLO 实践</title>
    <link href="https://wsgzao.github.io/post/hpqlocfg/"/>
    <id>https://wsgzao.github.io/post/hpqlocfg/</id>
    <published>2018-05-06T08:40:53.000Z</published>
    <updated>2018-05-07T02:36:43.723Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>HP iLO, Dell iDRAC, IBM/Lenovo IMM 等这些名字对于服务器硬件工程师来说应该不会陌生，当然在服务器采购回来大规模上架的时刻很多小伙伴估计就要崩溃了，OOB带外管理的IP需要手动配置，NTP和License也需要记得配置，万一忘记了，咳咳，那可就惨喽。这次我们就碰上了NTP时间同步没有配置，导致时区和时间的显示直接影响硬件故障时收集日志判断，为了避免人力资源浪费，网上搜索了一圈发现HP iLO有自己的批量化管理客户端程序，希望大家举一反三提升运维的效率。</p>
<blockquote>
<p>HP Lights-Out Configuration Utility 批量管理 HP iLO 2/3/4</p>
</blockquote>
<h2 id="更新记录"><a href="#更新记录" class="headerlink" title="更新记录"></a>更新记录</h2><p>2018年05月06日 - 补充GitHub开源的代码<br>2018年04月01日 - 初稿</p>
<p>阅读原文 - <a href="https://wsgzao.github.io/post/hpqlocfg/">https://wsgzao.github.io/post/hpqlocfg/</a></p>
<p><strong>扩展阅读</strong></p>
<p>HP ilo4 批量管理 - <a href="http://blog.51cto.com/gregdefanhua/2089408" target="_blank" rel="external">http://blog.51cto.com/gregdefanhua/2089408</a></p>
<h2 id="下载-HP-iLO-管理软件和模板"><a href="#下载-HP-iLO-管理软件和模板" class="headerlink" title="下载 HP iLO 管理软件和模板"></a>下载 HP iLO 管理软件和模板</h2><blockquote>
<p>扩展阅读中的信息已过期，cpqlocfg现在更名为hpqlocfg，沿用了作者的思路在此表示感谢</p>
</blockquote>
<p>RECOMMENDED * HP Lights-Out Configuration Utility<br><a href="https://support.hpe.com/hpsc/swd/public/detail?swItemId=MTX_d7e7146b56324eb0879f0a98e2#tab1" target="_blank" rel="external">https://support.hpe.com/hpsc/swd/public/detail?swItemId=MTX_d7e7146b56324eb0879f0a98e2#tab1</a></p>
<p>用于 Windows 的 HP Lights-Out XML Scripting Sample<br><a href="https://support.hpe.com/hpsc/swd/public/detail?swItemId=MTX_f045db3f567040f291bf645684#tab1" target="_blank" rel="external">https://support.hpe.com/hpsc/swd/public/detail?swItemId=MTX_f045db3f567040f291bf645684#tab1</a></p>
<h2 id="实践方法"><a href="#实践方法" class="headerlink" title="实践方法"></a>实践方法</h2><blockquote>
<p>拷贝HPQLOCFG.exe和相关dll文件至脚本当前路径</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line">file://C:\Users\wsgzao\Desktop\ilo_ntp	(1 folders, 12 files, 211.96 KB, 3.70 MB <span class="keyword">in</span> total.)</div><div class="line">│  172.25.240.45	266 bytes</div><div class="line">│  HPQLOCFG.exe	59.00 KB</div><div class="line">│  HPQLOCFG.exe.config	712 bytes</div><div class="line">│  HPSSLConnection.dll	13.50 KB</div><div class="line">│  ilo_ntp.log	0 bytes</div><div class="line">│  ip.txt	150 bytes</div><div class="line">│  log.txt	2.24 KB</div><div class="line">│  Parser.dll	133.00 KB</div><div class="line">│  README.txt	2.03 KB</div><div class="line">│  SetNTP.bat	181 bytes</div><div class="line">│  SetNTP.xml	555 bytes</div><div class="line">│  操作步骤.txt	381 bytes</div><div class="line">└─HP官方文件	(0 folders, 3 files, 3.50 MB, 3.50 MB <span class="keyword">in</span> total.)</div><div class="line">        HPE iLO 4 脚本和命令行指南.pdf	2.95 MB</div><div class="line">        SP58155.exe	392.67 KB</div><div class="line">        windows-LOsamplescripts4.80.0.zip	168.34 KB</div></pre></td></tr></table></figure>
<p>编写XML文件 SetNTP.xml</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">RIBCL</span> <span class="attr">VERSION</span>=<span class="string">"2.0"</span>&gt;</span></div><div class="line">    <span class="tag">&lt;<span class="name">LOGIN</span> <span class="attr">USER_LOGIN</span>=<span class="string">"iloadmin"</span> <span class="attr">PASSWORD</span>=<span class="string">"iloadmin"</span>&gt;</span></div><div class="line">        <span class="tag">&lt;<span class="name">RIB_INFO</span> <span class="attr">MODE</span>=<span class="string">"write"</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">MOD_NETWORK_SETTINGS</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">DHCP_SNTP_SETTINGS</span> <span class="attr">value</span>=<span class="string">"No"</span>/&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">DHCPV6_SNTP_SETTINGS</span> <span class="attr">value</span>=<span class="string">"No"</span>/&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">SNTP_SERVER1</span> <span class="attr">value</span>=<span class="string">"%ntp1%"</span>/&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">TIMEZONE</span> <span class="attr">value</span>=<span class="string">"Asia/Shanghai"</span>/&gt;</span></div><div class="line">            <span class="tag">&lt;/<span class="name">MOD_NETWORK_SETTINGS</span>&gt;</span></div><div class="line">            <span class="tag">&lt;<span class="name">MOD_GLOBAL_SETTINGS</span>&gt;</span></div><div class="line">                <span class="tag">&lt;<span class="name">PROPAGATE_TIME_TO_HOST</span> <span class="attr">VALUE</span>=<span class="string">"No"</span> /&gt;</span> </div><div class="line">            <span class="tag">&lt;/<span class="name">MOD_GLOBAL_SETTINGS</span>&gt;</span></div><div class="line">        <span class="tag">&lt;/<span class="name">RIB_INFO</span>&gt;</span></div><div class="line">    <span class="tag">&lt;/<span class="name">LOGIN</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">RIBCL</span>&gt;</span></div></pre></td></tr></table></figure>
<p>编写批处理  SetNTP.bat</p>
<figure class="highlight bat"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">@<span class="built_in">echo</span> off</div><div class="line"><span class="keyword">for</span> /f <span class="variable">%%a</span> <span class="keyword">in</span> (ip.txt) <span class="keyword">do</span> (</div><div class="line">    <span class="built_in">set</span> ip=<span class="variable">%%a</span></div><div class="line">    <span class="built_in">set</span> ntp="<span class="number">172</span>.<span class="number">25</span>.<span class="number">240</span>.<span class="number">254</span>"</div><div class="line">    <span class="keyword">call</span> hpqlocfg -s <span class="variable">%%i</span>p%% -l log.txt -f SetNTP.xml -u iloadmin -p iloadmin -t ntp1=<span class="variable">%%n</span>tp%%</div><div class="line">)</div></pre></td></tr></table></figure>
<blockquote>
<p>修改2处内容</p>
</blockquote>
<ol>
<li>修改ip.txt，添加信息</li>
<li>修改SetNTP.bat中set ntp=”172.28.70.254”</li>
</ol>
<blockquote>
<p>执行方法</p>
</blockquote>
<pre><code>SetNTP.bat
</code></pre><blockquote>
<p>文章中所有提到的代码和HP官方文件都放在GitHub中</p>
</blockquote>
<p><a href="https://github.com/wsgzao/hpqlocfg/" target="_blank" rel="external">https://github.com/wsgzao/hpqlocfg/</a></p>
]]></content>
    
    <summary type="html">
    
      HP Lights-Out Configuration Utility 批量管理 HP iLO 2/3/4
    
    </summary>
    
      <category term="学习 | Study" scheme="https://wsgzao.github.io/categories/%E5%AD%A6%E4%B9%A0-Study/"/>
    
    
  </entry>
  
  <entry>
    <title>使用Anaconda实现Python2和Python3共存及相互转换</title>
    <link href="https://wsgzao.github.io/post/anaconda/"/>
    <id>https://wsgzao.github.io/post/anaconda/</id>
    <published>2018-05-04T06:59:49.000Z</published>
    <updated>2018-05-10T08:16:59.079Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>初学Python时，总是被python的两个不太兼容的版本搞得头昏脑胀。按目前的发展趋势，python未来的主流版为python3。但是我们经常会遇到一些很有意思代码使用的是python2版本。于是我们需要同时拥有python2和python3的运行环境。这里介绍一个强大的软件Anaconda，它实现python2和python3两个版本的共存，并且可以相互转换。Anaconda 是一个用于科学计算的 Python 发行版，支持 Linux, Mac, Windows, 包含了众多流行的科学计算、数据分析的 Python 包。</p>
<blockquote>
<p>使用Anaconda轻松解决Python2和Python3共存</p>
</blockquote>
<h2 id="更新历史"><a href="#更新历史" class="headerlink" title="更新历史"></a>更新历史</h2><p>2018年05月04日 - 初稿</p>
<p>阅读原文 - <a href="https://wsgzao.github.io/post/anaconda/">https://wsgzao.github.io/post/anaconda/</a></p>
<p><strong>扩展阅读</strong></p>
<p>Anaconda - <a href="https://anaconda.org/" target="_blank" rel="external">https://anaconda.org/</a></p>
<hr>
<h2 id="为什么选择Anaconda"><a href="#为什么选择Anaconda" class="headerlink" title="为什么选择Anaconda"></a>为什么选择Anaconda</h2><p>Anaconda 实际上是一个软件发行版，它附带了 conda、Python 和多个科学包及其依赖项。应用程序 conda 是包和环境管理器。Anaconda 的下载文件比较大（约 500 MB），因为它附带了 Python 中最常用的数据科学包。如果只需要某些包，或者需要节省带宽或存储空间，也可以使用 Miniconda 这个较小的发行版（仅包含 conda 和 Python）。</p>
<h3 id="什么是-Anaconda"><a href="#什么是-Anaconda" class="headerlink" title="什么是 Anaconda"></a>什么是 Anaconda</h3><p>Anaconda是专注于数据分析的Python发行版本，包含了conda、Python等多个科学包及其依赖项。作为好奇宝宝的你是不是发现了一个新名词 conda，那么你一定会问 conda 又是什么呢？</p>
<h3 id="什么是-conda"><a href="#什么是-conda" class="headerlink" title="什么是 conda"></a>什么是 conda</h3><blockquote>
<p>conda 是开源包（packages）和虚拟环境（environment）的管理系统</p>
</blockquote>
<p>packages 管理： 可以使用 conda 来安装、更新 、卸载工具包 ，并且它更关注于数据科学相关的工具包。在安装 anaconda 时就预先集成了像 Numpy、Scipy、 pandas、Scikit-learn 这些在数据分析中常用的包。另外值得一提的是，conda 并不仅仅管理Python的工具包，它也能安装非python的包。比如在新版的 Anaconda 中就可以安装R语言的集成开发环境 Rstudio。</p>
<p>虚拟环境管理： 在conda中可以建立多个虚拟环境，用于隔离不同项目所需的不同版本的工具包，以防止版本上的冲突。对纠结于 Python 版本的同学们，我们也可以建立 Python2 和 Python3 两个环境，来分别运行不同版本的 Python 代码。</p>
<p>知道 是什么（what） 的同时，我们也需要问一问 为什么（why）。那么，为什么要选择用Anaconda呢？</p>
<h3 id="Anaconda-的优点"><a href="#Anaconda-的优点" class="headerlink" title="Anaconda 的优点"></a>Anaconda 的优点</h3><p>Anaconda的优点总结起来就八个字：省时省心、分析利器。</p>
<p><strong>省时省心</strong>： Anaconda通过管理工具包、开发环境、Python版本，大大简化了你的工作流程。不仅可以方便地安装、更新、卸载工具包，而且安装时能自动安装相应的依赖包，同时还能使用不同的虚拟环境隔离不同要求的项目。</p>
<p><strong>分析利器</strong>： 在 Anaconda 官网中是这么宣传自己的：适用于企业级大数据分析的Python工具。其包含了720多个数据科学相关的开源包，在数据可视化、机器学习、深度学习等多方面都有涉及。不仅可以做数据分析，甚至可以用在大数据和人工智能领域。</p>
<p>解决了 <strong>是什么</strong> 以及 <strong>为什么</strong> 的问题后，下面让我们看一下 <strong>怎么做（How）</strong>。</p>
<p>说明一下conda的设计理念——<strong>conda将几乎所有的工具、第三方包都当做package对待，甚至包括python和conda自身！</strong>因此，conda打破了包管理与环境管理的约束，能非常方便地安装各种版本python、各种package并方便地切换。</p>
<h3 id="Anaconda中的重要组件"><a href="#Anaconda中的重要组件" class="headerlink" title="Anaconda中的重要组件"></a>Anaconda中的重要组件</h3><p>Anaconda Navigator ：用于管理工具包和环境的图形用户界面，后续涉及的众多管理命令也可以在 Navigator 中手工实现。</p>
<p>Jupyter notebook ：基于web的交互式计算环境，可以编辑易于人们阅读的文档，用于展示数据分析的过程。</p>
<p>qtconsole ：一个可执行 IPython 的仿终端图形界面程序，相比 Python Shell 界面，qtconsole 可以直接显示代码生成的图形，实现多行代码输入执行，以及内置许多有用的功能和函数。</p>
<p>spyder ：一个使用Python语言、跨平台的、科学运算集成开发环境。Spyder的最大优点就是模仿MATLAB的“工作空间”。</p>
<p>Conda : Conda的包管理就比较好理解了，这部分功能与pip类似。</p>
<h2 id="安装Anaconda"><a href="#安装Anaconda" class="headerlink" title="安装Anaconda"></a>安装Anaconda</h2><p>Anaconda 可用于 Windows、Mac OS X 和 Linux。可以在官网上找到安装程序和安装说明<br><a href="https://www.anaconda.com/download/" target="_blank" rel="external">https://www.anaconda.com/download/</a></p>
<p>如果计算机上已经安装了 Python，这不会有任何影响。实际上，脚本和程序使用的默认 Python 是 Anaconda 附带的 Python。这里需要注意的是选对自己操作系统对应的版本。安装完后打开cmd,输入conda list可以查看当前安装的内容。输入conda upgrade –all，可以更新默认环境下的所有包。并在提示是否更新的时候输入y（Yes）以便让更新继续。初次安装下的软件包版本一般都比较老旧，因此提前更新可以避免未来不必要的问题。</p>
<p>本人使用的操作系统：Win10，前往anaconda官网下载对应的版本，本人选择的是Python3.6 + Python 2.7（实际上下载一个即可，推荐3.6）</p>
<h3 id="设置Path变量"><a href="#设置Path变量" class="headerlink" title="设置Path变量"></a>设置Path变量</h3><blockquote>
<p>默认安装不会自动添加全局变量，如果有需求可以手动配置Path，以Anaconda2为例</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 将加入到PATH路径</span></div><div class="line">D:\Programs\Anaconda2</div><div class="line">D:\Programs\Anaconda2\Scripts</div><div class="line"></div><div class="line"><span class="comment"># 在cmd输入</span></div><div class="line">python -V</div><div class="line"></div><div class="line">Python 2.7.14 :: Anaconda, Inc.</div></pre></td></tr></table></figure>
<h3 id="python2和python3版本转换"><a href="#python2和python3版本转换" class="headerlink" title="python2和python3版本转换"></a>python2和python3版本转换</h3><blockquote>
<p>在win10环境下进行傻瓜式安装。当安装完成时，计算机便具备了Python3.6的环境，推荐使用 Anaconda Prompt 进入命令行</p>
</blockquote>
<p>接下来，在cmd的环境下，输入以下命令安装Python2.7的环境</p>
<pre><code>conda create -n python27 python=2.7 anaconda
</code></pre><p>上面的代码创建了一个名为python27的python2.7的环境，最后一个参数表示安装anaconda下python2.7的所有默认包，这个参数时可选的。 </p>
<p>我们进入cmd环境，现在默认的python版本时python3.6，只需要一行简单的代码就可以转为python2.7的环境</p>
<pre><code>activate python27
</code></pre><p>此时本窗口下的python版本变为了python2.7，那么你肯定猜到了恢复到python3.6的命令</p>
<pre><code>deactivate python27
</code></pre><p>其实呢，一般没有必要恢复到原环境。只要打开一个新的cmd窗口，默认的python版本就是python3.6</p>
<h3 id="Anaconda-镜像"><a href="#Anaconda-镜像" class="headerlink" title="Anaconda 镜像"></a>Anaconda 镜像</h3><blockquote>
<p>这里使用了清华大学开源软件镜像站tuna提供的资源，在此表示感谢</p>
</blockquote>
<p><a href="https://mirrors.tuna.tsinghua.edu.cn/help/anaconda/" target="_blank" rel="external">https://mirrors.tuna.tsinghua.edu.cn/help/anaconda/</a></p>
<p>Anaconda 安装包可以到以下地址分流下载<br><a href="https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/" target="_blank" rel="external">https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive/</a> </p>
<p>因为Anaconda.org的服务器在国外，conda下载的速度经常很慢。可以设置国内的镜像源来加速：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># TUNA 还提供了 Anaconda 仓库的镜像，运行以下命令即可添加 Anaconda Python 免费仓库</span></div><div class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/</div><div class="line">conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/</div><div class="line"><span class="comment"># 设置搜索时显示通道地址</span></div><div class="line">conda config --<span class="built_in">set</span> show_channel_urls yes</div><div class="line"></div><div class="line"><span class="comment"># 执行完上述命令后，会生成配置文件记录着我们对conda的配置，直接手动创建、编辑该文件是相同的效果</span></div><div class="line"><span class="comment"># Linux/Mac</span></div><div class="line">~/.condarc</div><div class="line"><span class="comment"># Windows</span></div><div class="line">C:\Users\USER_NAME\.condarc</div><div class="line"></div><div class="line"><span class="comment"># 运行测试一下吧</span></div><div class="line">conda install numpy</div></pre></td></tr></table></figure>
<blockquote>
<p>常见问题：conda无法安装更新，报错内容如下：</p>
</blockquote>
<p>CondaHTTPError: HTTP 000 CONNECTION FAILED for url <a href="https://repo.anaconda.com/pkgs/free/win-64/repodata.json.bz2" target="_blank" rel="external">https://repo.anaconda.com/pkgs/free/win-64/repodata.json.bz2</a><br>Elapsed: -</p>
<p>An HTTP error occurred when trying to retrieve this URL.<br>HTTP errors are often intermittent, and a simple retry will get you on your way.</p>
<p>If your current network has <a href="https://www.anaconda.com" target="_blank" rel="external">https://www.anaconda.com</a> blocked, please file<br>a support request with your network engineering team.</p>
<p>SSLError(MaxRetryError(‘HTTPSConnectionPool(host=\’repo.anaconda.com\’, port=443): Max retries exceeded with url: /pkgs/free/win-64/repodata.json.bz2 (Caused by SSLError(SSLError(“bad handshake: SysCallError(10054, \’WSAECONNRESET\’)”,),))’,),)</p>
<p>A reportable application error has occurred. Conda has prepared the above report.<br>If submitted, this report will be used by core maintainers to improve<br>future releases of conda.<br>Would you like conda to send this report to the core maintainers?</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 编辑.condarc注释defalts</span></div><div class="line">channels:</div><div class="line">  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/</div><div class="line">  - https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/</div><div class="line"><span class="comment">#  - defaults</span></div><div class="line">ssl_verify: <span class="literal">true</span></div><div class="line">show_channel_urls: <span class="literal">true</span></div></pre></td></tr></table></figure>
<h2 id="conda安装django实践"><a href="#conda安装django实践" class="headerlink" title="conda安装django实践"></a>conda安装django实践</h2><blockquote>
<p>以下操作为 anaconda python3.6 环境下进入Anaconda Prompt安装django1.11的实践过程</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 在python3.6环境下进入Anaconda Prompt创建django1.x专用虚拟环境</span></div><div class="line">conda create -n django1.x</div><div class="line"><span class="comment"># 激活专用虚拟环境</span></div><div class="line">conda activate django1.x</div><div class="line"><span class="comment"># 查看conda当前django可用版本</span></div><div class="line">conda search django</div><div class="line">conda install django==1.11.10</div><div class="line"><span class="comment"># 切换到虚拟环境家目录</span></div><div class="line"><span class="built_in">cd</span> C:\Users\wsgzao\AppData\Local\conda\conda\envs\django1.x</div><div class="line"><span class="comment"># 创建项目</span></div><div class="line">django-admin.py startproject myweb</div><div class="line"><span class="comment"># 创建app</span></div><div class="line">python manage.py startapp myapp</div><div class="line"><span class="comment"># 启动Django中的开发服务器</span></div><div class="line">python manage.py runserver</div><div class="line"><span class="comment"># 帮助文档</span></div><div class="line">python manage.py -h</div><div class="line"><span class="comment"># Django命令</span></div><div class="line">python manage.py &lt;<span class="built_in">command</span>&gt; [options]</div></pre></td></tr></table></figure>
<h2 id="conda常用命令"><a href="#conda常用命令" class="headerlink" title="conda常用命令"></a>conda常用命令</h2><p>最新版的conda是从site-packages文件夹中搜索已经安装的包，不依赖于pip，因此可以显示出通过各种方式安装的包。conda将conda、python等都视为package，因此完全可以使用conda来管理conda和python的版本</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 列出所有已安装的包</span></div><div class="line">conda list</div><div class="line"><span class="comment"># 安装软件包，同时它会自动安装此软件包的依赖项 </span></div><div class="line">conda install package_name</div><div class="line"><span class="comment"># 同时安装多个包</span></div><div class="line">conda install numpy pandas</div><div class="line"><span class="comment"># 安装指定版本的包</span></div><div class="line">conda install python=2.7</div><div class="line"><span class="comment"># 安装离线包</span></div><div class="line">conda install /package-path/package-filename.tar.bz2</div><div class="line"><span class="comment"># 卸载包</span></div><div class="line">conda remove package_name</div><div class="line"><span class="comment"># 更新环境中的所有已安装的包</span></div><div class="line">conda update/upgrade --all</div><div class="line"><span class="comment"># 更新conda，保持conda最新</span></div><div class="line">conda update conda</div><div class="line"><span class="comment"># 更新anaconda</span></div><div class="line">conda update anaconda</div><div class="line"><span class="comment"># 更新python</span></div><div class="line">conda update python</div><div class="line"><span class="comment"># 查看conda安装信息</span></div><div class="line">conda info</div><div class="line"><span class="comment"># 查看conda帮助</span></div><div class="line">conda <span class="built_in">help</span></div><div class="line"><span class="comment"># 搜索可以安装的包</span></div><div class="line">conda search package_name</div><div class="line"><span class="comment"># 创建conda虚拟环境</span></div><div class="line">conda create -n env_name</div><div class="line"><span class="comment"># 在这里，-n env_name 设置环境的名称（-n 是指名称），而 list of packages 是要安装在环境中的包的列表</span></div><div class="line">conda create -n env_name list of packages</div><div class="line"><span class="comment"># 可以创建具有特定 Python 版本的环境</span></div><div class="line">conda create -n py2.7.14 python=2.7.14</div><div class="line"><span class="comment"># 查看conda版本</span></div><div class="line">conda -V</div><div class="line"></div><div class="line"><span class="comment"># 进入环境</span></div><div class="line"><span class="comment"># linux 下用 </span></div><div class="line"><span class="built_in">source</span> activate env_name</div><div class="line"><span class="comment"># windows 下用</span></div><div class="line">activate env_name</div><div class="line"></div><div class="line"><span class="comment"># 离开环境</span></div><div class="line"><span class="comment"># linux 下用 </span></div><div class="line"><span class="built_in">source</span> deactivate</div><div class="line"><span class="comment"># windows 下用</span></div><div class="line">deactivate</div><div class="line"></div><div class="line"><span class="comment"># 列出环境</span></div><div class="line">conda env list</div><div class="line"><span class="comment"># 删除环境</span></div><div class="line">conda env remove -n env_name</div><div class="line"><span class="comment"># 导出环境将包保存为 YAML，输出环境中的所有包的名称（包括 Python 版本）</span></div><div class="line">conda env <span class="built_in">export</span> &gt; environment.yaml</div><div class="line"><span class="comment"># 加载环境</span></div><div class="line">conda env create -f environment.yaml</div></pre></td></tr></table></figure>
<h2 id="anaconda与vscode整合"><a href="#anaconda与vscode整合" class="headerlink" title="anaconda与vscode整合"></a>anaconda与vscode整合</h2><p>打开vscode，选择文件-首选项-设置，搜索<code>python.pythonPath</code></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div></pre></td><td class="code"><pre><div class="line">&#123;</div><div class="line">    <span class="string">"editor.minimap.enabled"</span>: <span class="literal">true</span>,</div><div class="line">    <span class="string">"editor.renderControlCharacters"</span>: <span class="literal">false</span>,</div><div class="line">    <span class="string">"editor.renderWhitespace"</span>: <span class="string">"all"</span>,</div><div class="line">    <span class="string">"python.disablePromptForFeatures"</span>: [</div><div class="line">        <span class="string">"pylint"</span></div><div class="line">    ],</div><div class="line">    <span class="string">"python.pythonPath"</span>: <span class="string">"C:\\ProgramData\\Anaconda3"</span>,</div><div class="line">    <span class="string">"workbench.iconTheme"</span>: <span class="string">"vscode-icons"</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      使用Anaconda轻松解决Python2和Python3共存
    
    </summary>
    
      <category term="学习 | Study" scheme="https://wsgzao.github.io/categories/%E5%AD%A6%E4%B9%A0-Study/"/>
    
    
  </entry>
  
  <entry>
    <title>pip离线安装和配置pypi国内加速镜像实践</title>
    <link href="https://wsgzao.github.io/post/pip/"/>
    <id>https://wsgzao.github.io/post/pip/</id>
    <published>2018-05-03T06:59:49.000Z</published>
    <updated>2018-05-04T07:46:00.180Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>pip安装本身很简单官方推荐的安装方法就一条命令，但离线安装pip时就有点痛苦了，因为不知道缺少什么依赖包。有时候我们下载python的第三方库入django的时候pip install django 或者 easy_install django 发现下载的速度非常的慢。慢的原因其实就是从Python的官方源<a href="https://pypi.org/" target="_blank" rel="external">https://pypi.org/</a> 下载到本地，然后解包安装。不过因为某些原因，访问官方的pypi不稳定，很慢甚至有些还时不时的访问不了。为了解决这个下载慢的问题，可以使用国内的pypi镜像。</p>
<blockquote>
<p>轻轻松松解决pip离线安装，配置pypi国内加速镜像</p>
</blockquote>
<h2 id="更新历史"><a href="#更新历史" class="headerlink" title="更新历史"></a>更新历史</h2><p>2018年05月03日 - 初稿</p>
<p>阅读原文 - <a href="https://wsgzao.github.io/post/pip/">https://wsgzao.github.io/post/pip/</a></p>
<p><strong>扩展阅读</strong></p>
<p>PyPA - <a href="https://www.pypa.io/" target="_blank" rel="external">https://www.pypa.io/</a></p>
<hr>
<h2 id="pip简介"><a href="#pip简介" class="headerlink" title="pip简介"></a>pip简介</h2><p>The PyPA recommended tool for installing Python packages.</p>
<h2 id="pip安装"><a href="#pip安装" class="headerlink" title="pip安装"></a>pip安装</h2><p><a href="https://pip.pypa.io/en/stable/installing/" target="_blank" rel="external">https://pip.pypa.io/en/stable/installing/</a></p>
<h3 id="pip在线安装"><a href="#pip在线安装" class="headerlink" title="pip在线安装"></a>pip在线安装</h3><p>To install pip, securely download get-pip.py:</p>
<pre><code>curl https://bootstrap.pypa.io/get-pip.py -o get-pip.py
</code></pre><p>Inspect get-pip.py for any malevolence. Then run the following:</p>
<pre><code>python get-pip.py
</code></pre><h3 id="pip离线安装"><a href="#pip离线安装" class="headerlink" title="pip离线安装"></a>pip离线安装</h3><blockquote>
<p>以 Linux 下 Python 2.7.14 和 pip 9.0.1 为例，Windows 可以参考最后的推荐链接</p>
</blockquote>
<p>下文中提到的压缩包都可以在官方找到对应的版本 - <a href="https://pypi.org/" target="_blank" rel="external">https://pypi.org/</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Install Packages</span></div><div class="line">yum install gcc zlib zlib-devel openssl-devel -y</div><div class="line"></div><div class="line"><span class="comment"># Install Python</span></div><div class="line">tar xf Python-2.7.14.tgz</div><div class="line"><span class="built_in">cd</span> Python-2.7.14</div><div class="line">./configure</div><div class="line">make</div><div class="line">make install</div><div class="line"><span class="built_in">cd</span> ..</div><div class="line"></div><div class="line"><span class="comment"># ImportError: No module named six.moves</span></div><div class="line">tar xf six-1.11.0.tar.gz </div><div class="line"><span class="built_in">cd</span> six-1.11.0</div><div class="line">python setup.py install</div><div class="line"><span class="built_in">cd</span> ..</div><div class="line"></div><div class="line"><span class="comment"># ImportError: No module named packaging.version</span></div><div class="line">tar xf packaging-17.1.tar.gz </div><div class="line"><span class="built_in">cd</span> packaging-17.1</div><div class="line">python setup.py install</div><div class="line"><span class="built_in">cd</span> ..</div><div class="line"></div><div class="line"><span class="comment"># ImportError: No module named pyparsing</span></div><div class="line">tar xf pyparsing-2.2.0.tar.gz </div><div class="line"><span class="built_in">cd</span> pyparsing-2.2.0</div><div class="line">python setup.py install</div><div class="line"><span class="built_in">cd</span> ..</div><div class="line"></div><div class="line"><span class="comment"># ImportError: No module named appdirs</span></div><div class="line">tar xf appdirs-1.4.3.tar.gz </div><div class="line"><span class="built_in">cd</span> appdirs-1.4.3</div><div class="line">python setup.py install</div><div class="line"><span class="built_in">cd</span> ..</div><div class="line"></div><div class="line"><span class="comment"># Install Setuptools</span></div><div class="line">unzip setuptools-38.5.2.zip</div><div class="line"><span class="built_in">cd</span> setuptools-38.5.2</div><div class="line">python setup.py install</div><div class="line"><span class="built_in">cd</span> ..</div><div class="line"></div><div class="line"><span class="comment"># Install pip</span></div><div class="line">tar xf pip-9.0.1.tar.gz</div><div class="line"><span class="built_in">cd</span> pip-9.0.1</div><div class="line">python setup.py install</div><div class="line"><span class="built_in">cd</span> ..</div><div class="line"></div><div class="line"><span class="comment"># Upgrading pip</span></div><div class="line">pip install -U pip</div></pre></td></tr></table></figure>
<h2 id="配置pypi国内加速镜像"><a href="#配置pypi国内加速镜像" class="headerlink" title="配置pypi国内加速镜像"></a>配置pypi国内加速镜像</h2><blockquote>
<p>由于众所周知的原因，国内访问和下载国外的镜像仓库不畅，所以需要做些小小的优化</p>
</blockquote>
<p>阿里云(aliyun) - <a href="https://mirrors.aliyun.com/pypi/simple/" target="_blank" rel="external">https://mirrors.aliyun.com/pypi/simple/</a><br>豆瓣(douban) - <a href="https://pypi.douban.com/simple/" target="_blank" rel="external">https://pypi.douban.com/simple/</a><br>清华大学(tuna) - <a href="https://pypi.tuna.tsinghua.edu.cn/simple/" target="_blank" rel="external">https://pypi.tuna.tsinghua.edu.cn/simple/</a> </p>
<h3 id="临时使用"><a href="#临时使用" class="headerlink" title="临时使用"></a>临时使用</h3><blockquote>
<p>注意，simple 不能少, 是 https 而不是 http</p>
</blockquote>
<pre><code>pip install -i https://pypi.tuna.tsinghua.edu.cn/simple ansible
</code></pre><h3 id="永久生效"><a href="#永久生效" class="headerlink" title="永久生效"></a>永久生效</h3><blockquote>
<p>pip配置文件不存在则需要手动创建，具体配置信息参考官方文档</p>
</blockquote>
<p><a href="https://pip.pypa.io/en/stable/user_guide/#config-file" target="_blank" rel="external">https://pip.pypa.io/en/stable/user_guide/#config-file</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Linux</span></div><div class="line">~/.config/pip/pip.conf</div><div class="line"><span class="comment"># Windows</span></div><div class="line">%APPDATA%\pip\pip.ini</div><div class="line"><span class="comment"># macOS</span></div><div class="line"><span class="variable">$HOME</span>/Library/Application Support/pip/pip.conf</div></pre></td></tr></table></figure>
<blockquote>
<p>Linux更换pypi国内源</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Linux更换pypi国内源</span></div><div class="line">tee ~/.config/pip/pip.conf &lt;&lt;-<span class="string">'EOF'</span></div><div class="line">[global]</div><div class="line">index-url = https://mirrors.aliyun.com/pypi/simple/</div><div class="line">[install]</div><div class="line">trusted-host= mirrors.aliyun.com</div><div class="line">EOF</div></pre></td></tr></table></figure>
<blockquote>
<p>Windows更换pypi国内源</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Windows更换pypi国内源，运行以下python代码会自动建立pip.ini</span></div><div class="line"><span class="keyword">import</span> os</div><div class="line"></div><div class="line">ini=<span class="string">"""[global]</span></div><div class="line"><span class="string">index-url = https://pypi.doubanio.com/simple/</span></div><div class="line"><span class="string">[install]</span></div><div class="line"><span class="string">trusted-host=pypi.doubanio.com</span></div><div class="line"><span class="string">"""</span></div><div class="line">pippath=os.environ[<span class="string">"USERPROFILE"</span>]+<span class="string">"\\pip\\"</span></div><div class="line"></div><div class="line"><span class="keyword">if</span> <span class="keyword">not</span> os.path.exists(pippath):</div><div class="line">    os.mkdir(pippath)</div><div class="line"></div><div class="line"><span class="keyword">with</span> open(pippath+<span class="string">"pip.ini"</span>,<span class="string">"w+"</span>) <span class="keyword">as</span> f:</div><div class="line">    f.write(ini)</div></pre></td></tr></table></figure>
<h2 id="推荐参考的文章"><a href="#推荐参考的文章" class="headerlink" title="推荐参考的文章"></a>推荐参考的文章</h2><p>Python 2.6 升级至 Python 2.7 的实践心得 - <a href="https://wsgzao.github.io/post/python-2-6-update-to-2-7/">https://wsgzao.github.io/post/python-2-6-update-to-2-7/</a><br>pip离线安装和配置pypi国内加速镜像实践 - <a href="https://wsgzao.github.io/post/pip/">https://wsgzao.github.io/post/pip/</a><br>使用pypiserver快速搭建内网离线pypi仓库实践 - <a href="https://wsgzao.github.io/post/pypiserver/">https://wsgzao.github.io/post/pypiserver/</a><br>RHEL7/CentOS7在线和离线安装GitLab配置使用实践 - <a href="https://wsgzao.github.io/post/gitlab/">https://wsgzao.github.io/post/gitlab/</a><br>使用pipenv代替virtualenv管理python包 - <a href="https://wsgzao.github.io/post/pipenv/">https://wsgzao.github.io/post/pipenv/</a></p>
]]></content>
    
    <summary type="html">
    
      轻轻松松解决pip离线安装，配置pypi国内加速镜像
    
    </summary>
    
      <category term="学习 | Study" scheme="https://wsgzao.github.io/categories/%E5%AD%A6%E4%B9%A0-Study/"/>
    
    
  </entry>
  
  <entry>
    <title>通过关闭Windows Update更新解决服务主机本地系统CPU使用率高问题</title>
    <link href="https://wsgzao.github.io/post/windows-update/"/>
    <id>https://wsgzao.github.io/post/windows-update/</id>
    <published>2018-05-02T06:59:49.000Z</published>
    <updated>2018-05-02T09:04:21.644Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>最近经常发现Windows10系统卡顿，笔记本风扇声音特别响，本地系统的CPU占用就一直维持在100%左右，程序响应慢严重影响效率。不同的Windows版本情况可能不同，但通过任务管理器查看CPU较高的进程发现集中在Windows Update，而CPU高的问题也正是来源于此。然而回顾此前一路从Windows XP/Vista/7/8.1/10的自动更新经历来看其实微软一直再向前走，至少我的x230换上SSD和大内存后使用Windows10 Pro初版一路升级到现在1803，没有遇到太大的问题，也再也没因为垃圾数据太多或者系统响应慢而隔三差五重装电脑，你们的故事呢？</p>
<blockquote>
<p>CPU使用率高居然是Windows Update更新进程惹的祸</p>
</blockquote>
<h2 id="更新历史"><a href="#更新历史" class="headerlink" title="更新历史"></a>更新历史</h2><p>2018年05月02日 - 初稿</p>
<p>阅读原文 - <a href="https://wsgzao.github.io/post/windows-update/">https://wsgzao.github.io/post/windows-update/</a></p>
<p><strong>扩展阅读</strong></p>
<p>Win10关闭自动更新,windows10怎么关闭自动更新 - <a href="http://jingyan.baidu.com/article/f71d6037702c7c1ab641d194.html" target="_blank" rel="external">http://jingyan.baidu.com/article/f71d6037702c7c1ab641d194.html</a></p>
<hr>
<h2 id="禁用-Windows-10-更新"><a href="#禁用-Windows-10-更新" class="headerlink" title="禁用 Windows 10 更新"></a>禁用 Windows 10 更新</h2><blockquote>
<p>如不想禁用Windows 10 更新，手动停止Windows Update服务观察是否可以解决即可</p>
</blockquote>
<ol>
<li>找到任务管理器中的“ 服务主机：本地系统”-&gt;“Windows Update”，右键，进入“服务”</li>
<li>在服务列表中找到“Windows Update”，右键，停止</li>
<li>在服务列表中找到“Windows Update”，右键，属性，启动类型选择“禁用”</li>
<li>打开C:\Windows\SoftwareDistribution，删除里面所有文件，如果可以删除所有文件，那么CPU应该已经恢复正常了，如果有些文件不能删除，则可能是“Windows Update”没有完全关闭，继续下面步骤</li>
<li>按Win键+R键调出运行，输入“gpedit.msc”点击“确定”，调出“本地组策略编辑器”</li>
<li>依次展开”计算机配置”，”管理模板” ，”windows组件” ，”windows更新 “，在右面找到“配置自动更新”，并双击</li>
<li>在配置窗口上按1-3的顺序选择“已禁用”，点击“应用”，“确定”，重启电脑</li>
<li>打开C:\Windows\SoftwareDistribution，删除里面所有文件</li>
</ol>
<p>至此，应该CPU会恢复正常，如果还没有，那就具体问题具体分析吧</p>
<h2 id="启用-Windows-10-更新"><a href="#启用-Windows-10-更新" class="headerlink" title="启用 Windows 10 更新"></a>启用 Windows 10 更新</h2><ol>
<li>先打开服务，把Windows Update停止并禁用</li>
<li>然后打开设置里的更新和安全，此时Windows更新会显示不可用</li>
<li>这时去服务里启用Windows Update</li>
<li>然后去更新里点重试</li>
<li>最后就等吧</li>
</ol>
]]></content>
    
    <summary type="html">
    
      CPU使用率高居然是Windows Update更新进程惹的祸
    
    </summary>
    
      <category term="学习 | Study" scheme="https://wsgzao.github.io/categories/%E5%AD%A6%E4%B9%A0-Study/"/>
    
    
  </entry>
  
  <entry>
    <title>使用pipenv代替virtualenv管理python包</title>
    <link href="https://wsgzao.github.io/post/pipenv/"/>
    <id>https://wsgzao.github.io/post/pipenv/</id>
    <published>2018-04-25T06:59:49.000Z</published>
    <updated>2018-05-03T03:16:05.864Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>第一次接触到 pipenv 是因为看到@董明伟大神的《使用pipenv管理你的项目》，之前可能和大家的选择类似使用 virtualenv 或者 pyenv 来管理 python 的包环境。virtualenv 是针对python的包的多版本管理，通过将python包安装到一个模块来作为python的包虚拟环境，通过切换目录来实现不同包环境间的切换。pyenv 是针对 python 版本的管理，通过修改环境变量的方式实现；虽然我自己对pipenv的掌握程度还不深，但是我自己能感受到更加简单而清晰的python包管理方式，并且pipenv还是Python官方正式推荐的python包管理工具。原文如下：</p>
<p>Pipenv — the officially recommended Python packaging tool from Python.org, free (as in freedom).</p>
<blockquote>
<p>Pipenv 官方推荐的 Python 包管理工具</p>
</blockquote>
<h2 id="更新历史"><a href="#更新历史" class="headerlink" title="更新历史"></a>更新历史</h2><p>2017年04月25日 - 初稿</p>
<p>阅读原文 - <a href="https://wsgzao.github.io/post/pipenv/">https://wsgzao.github.io/post/pipenv/</a></p>
<p><strong>扩展阅读</strong></p>
<p>Pipenv - <a href="https://docs.pipenv.org/" target="_blank" rel="external">https://docs.pipenv.org/</a><br>Pipenv &amp; 虚拟环境 - <a href="http://pythonguidecn.readthedocs.io/zh/latest/dev/virtualenvs.html" target="_blank" rel="external">http://pythonguidecn.readthedocs.io/zh/latest/dev/virtualenvs.html</a></p>
<hr>
<h2 id="推荐阅读"><a href="#推荐阅读" class="headerlink" title="推荐阅读"></a>推荐阅读</h2><p>使用pipenv管理你的项目 @董伟明<br><a href="http://www.dongwm.com/archives/%E4%BD%BF%E7%94%A8pipenv%E7%AE%A1%E7%90%86%E4%BD%A0%E7%9A%84%E9%A1%B9%E7%9B%AE/" target="_blank" rel="external">http://www.dongwm.com/archives/%E4%BD%BF%E7%94%A8pipenv%E7%AE%A1%E7%90%86%E4%BD%A0%E7%9A%84%E9%A1%B9%E7%9B%AE/</a></p>
<p>【 python 基础系列 】 - pipenv 试用过程分享<br><a href="http://pylixm.cc/posts/2018-01-13-python-pipenv.html" target="_blank" rel="external">http://pylixm.cc/posts/2018-01-13-python-pipenv.html</a></p>
<h2 id="Pipenv-官方简介"><a href="#Pipenv-官方简介" class="headerlink" title="Pipenv 官方简介"></a>Pipenv 官方简介</h2><blockquote>
<p>Pipenv: Python Development Workflow for Humans</p>
</blockquote>
<p><strong>Pipenv</strong> — the officially recommended Python packaging tool from Python.org, free (as in freedom).</p>
<p>Pipenv is a tool that aims to bring the best of all packaging worlds (bundler, composer, npm, cargo, yarn, etc.) to the Python world. Windows is a first–class citizen, in our world.</p>
<p>It automatically creates and manages a virtualenv for your projects, as well as adds/removes packages from your Pipfile as you install/uninstall packages. It also generates the ever–important Pipfile.lock, which is used to produce deterministic builds.</p>
<p><img src="https://i.loli.net/2018/04/26/5ae14a41a5a8e.gif" alt=""></p>
<blockquote>
<p>The problems that Pipenv seeks to solve are multi-faceted:</p>
</blockquote>
<p>You no longer need to use <code>pip</code> and <code>virtualenv</code> separately. They work together.<br>Managing a <code>requirements.txt</code> file can be problematic, so Pipenv uses the upcoming <code>Pipfile</code> and <code>Pipfile.lock</code> instead, which is superior for basic use cases.<br>Hashes are used everywhere, always. Security. Automatically expose security vulnerabilities.<br>Give you insight into your dependency graph (e.g. <code>$ pipenv graph</code>).<br>Streamline development workflow by loading <code>.env</code> files.</p>
<h2 id="Pipenv-安装和使用"><a href="#Pipenv-安装和使用" class="headerlink" title="Pipenv 安装和使用"></a>Pipenv 安装和使用</h2><blockquote>
<p>我的使用深度不高，就以目前我实际使用pipenv的方式为例</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># pip 离线下载</span></div><div class="line"><span class="comment"># pip install --download DIR -r requirements.txt</span></div><div class="line">mkdir pipenv</div><div class="line">pip install -d ~/pipenv/ pipenv</div><div class="line"></div><div class="line"><span class="comment"># pip 离线安装pipenv</span></div><div class="line">pip install --no-index --find-links=pipenv/ pipenv</div><div class="line"></div><div class="line"><span class="comment"># 使用pipenv创建虚拟环境</span></div><div class="line">mkdir win_ansible</div><div class="line"><span class="built_in">cd</span> win_ansible</div><div class="line">pipenv shell</div><div class="line">pip install --no-index --find-links=pip-ansible-2.4.3.0/ -r requirements.txt</div><div class="line"></div><div class="line"><span class="comment"># 升级ansible版本</span></div><div class="line">pip install --no-index --find-links=pip-ansible-2.5.0/ -r requirements.txt -U</div><div class="line"></div><div class="line"><span class="comment"># 退出虚拟环境</span></div><div class="line"><span class="built_in">exit</span></div><div class="line"></div><div class="line"><span class="comment"># 对不同开发用户自动创建python虚拟环境</span></div><div class="line">vim ~/.bash_profile</div><div class="line">pipenv shell</div><div class="line"></div><div class="line"><span class="comment"># 虚拟环境会在当前用户家目录自动创建</span></div><div class="line">test101@JQ/root<span class="comment">#su - wangao</span></div><div class="line">Spawning environment shell (/bin/bash). Use <span class="string">'exit'</span> to leave.</div><div class="line">test101@JQ/home/wangao$. /home/wangao/.<span class="built_in">local</span>/share/virtualenvs/wangao-iOSX51hl/bin/activate</div><div class="line"></div><div class="line"><span class="comment"># 沿用pip创建requirements.txt，该方法相对Pipfile来说不是最佳</span></div><div class="line">(wangao-iOSX51hl) test101@JQ/home/wangao/git/ansible<span class="variable">$cat</span> requirements.txt </div><div class="line">--index-url=http://172.31.96.201:8081/simple/</div><div class="line">--trusted-host=172.31.96.201</div><div class="line">ansible</div><div class="line">ansible-cmdb</div><div class="line">pywinrm</div><div class="line"></div><div class="line"><span class="comment"># 通过gitlab同步控制python包环境</span></div><div class="line">git checkout develop</div><div class="line">git pull origin develop</div><div class="line">pip install -r requirements.txt -U</div></pre></td></tr></table></figure>
<h2 id="推荐参考的文章"><a href="#推荐参考的文章" class="headerlink" title="推荐参考的文章"></a>推荐参考的文章</h2><p>Python 2.6 升级至 Python 2.7 的实践心得 - <a href="https://wsgzao.github.io/post/python-2-6-update-to-2-7/">https://wsgzao.github.io/post/python-2-6-update-to-2-7/</a><br>使用pypiserver快速搭建内网离线pypi仓库实践 - <a href="https://wsgzao.github.io/post/pypiserver/">https://wsgzao.github.io/post/pypiserver/</a><br>RHEL7/CentOS7在线和离线安装GitLab配置使用实践 - <a href="https://wsgzao.github.io/post/gitlab/">https://wsgzao.github.io/post/gitlab/</a></p>
]]></content>
    
    <summary type="html">
    
      Pipenv 官方推荐的 Python 包管理工具
    
    </summary>
    
      <category term="学习 | Study" scheme="https://wsgzao.github.io/categories/%E5%AD%A6%E4%B9%A0-Study/"/>
    
    
  </entry>
  
  <entry>
    <title>VMware兼容性检查指北</title>
    <link href="https://wsgzao.github.io/post/vmware-compatibility-guide/"/>
    <id>https://wsgzao.github.io/post/vmware-compatibility-guide/</id>
    <published>2018-04-22T06:59:49.000Z</published>
    <updated>2018-04-23T06:29:52.899Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>本文记录了具体如何从VMware官方网站检查硬件（BIOS/RAID/NIC/HBA）等兼容性信息，提前确认VMware软硬件兼容性结果避免数据中心建设规划时候采坑回退。说一句不相关的想法，整个IT行业从VMware转投OpenStack的进程越来越快，而VMware面对的竞争者会越来越多，Nutanix/OpenStack/Docker等一波接着一波，VMware确实很成熟也很好用，但企业规模不断扩大之后也抵挡不住成本的压力和新技术的降维攻击。</p>
<blockquote>
<p>VMware Compatibility Guide</p>
</blockquote>
<h2 id="更新历史"><a href="#更新历史" class="headerlink" title="更新历史"></a>更新历史</h2><p>2018年04月22日 - 初稿</p>
<p>阅读原文 - <a href="https://wsgzao.github.io/post/vmware-compatibility-guide/">https://wsgzao.github.io/post/vmware-compatibility-guide/</a></p>
<p><strong>扩展阅读</strong></p>
<p>VMware Compatibility Guide - <a href="https://www.vmware.com/resources/compatibility/" target="_blank" rel="external">https://www.vmware.com/resources/compatibility/</a></p>
<hr>
<h2 id="VMware兼容性检查概述"><a href="#VMware兼容性检查概述" class="headerlink" title="VMware兼容性检查概述"></a>VMware兼容性检查概述</h2><h3 id="VMware-Compatibility-Guide"><a href="#VMware-Compatibility-Guide" class="headerlink" title="VMware Compatibility Guide"></a>VMware Compatibility Guide</h3><p>登录VMware Compatibility Guide网站，输入已知硬件关键字信息如DL980<br><a href="https://www.vmware.com/resources/compatibility/search.php" target="_blank" rel="external">https://www.vmware.com/resources/compatibility/search.php</a></p>
<p>根据型号和CPU判断硬件所支持的版本，以下内容以HP DL980 Gen7为例<br><a href="https://www.vmware.com/resources/compatibility/detail.php?deviceCategory=server&amp;productid=19802&amp;deviceCategory=server&amp;details=1&amp;keyword=dl980&amp;page=1&amp;display_interval=10&amp;sortColumn=Partner&amp;sortOrder=Asc" target="_blank" rel="external">https://www.vmware.com/resources/compatibility/detail.php?deviceCategory=server&amp;productid=19802&amp;deviceCategory=server&amp;details=1&amp;keyword=dl980&amp;page=1&amp;display_interval=10&amp;sortColumn=Partner&amp;sortOrder=Asc</a></p>
<p>根据查询结果我们可以得出这样的结论<br>HP DL980 Gen7支持的最高版本为ESXi 6.0 U3，BIOS版本要求为P66</p>
<h3 id="VMware-Lifecycle-Product-Matrix"><a href="#VMware-Lifecycle-Product-Matrix" class="headerlink" title="VMware Lifecycle Product Matrix"></a>VMware Lifecycle Product Matrix</h3><p>根据第一步得到了ESXi的版本信息，需要了解VMware当前的生命周期技术支持政策<br><a href="https://www.vmware.com/support/policies/lifecycle.html" target="_blank" rel="external">https://www.vmware.com/support/policies/lifecycle.html</a><br><a href="https://www.vmware.com/content/dam/digitalmarketing/vmware/en/pdf/support/product-lifecycle-matrix.pdf" target="_blank" rel="external">https://www.vmware.com/content/dam/digitalmarketing/vmware/en/pdf/support/product-lifecycle-matrix.pdf</a></p>
<h3 id="VMware-Product-Interoperability-Matrices"><a href="#VMware-Product-Interoperability-Matrices" class="headerlink" title="VMware Product Interoperability Matrices"></a>VMware Product Interoperability Matrices</h3><p>将ESXi 6.0 U3作为已知条件，增加你需要部署的组件进一步了解兼容性上的安装建议，比如下面是增加了VMware vCenter Server和VMware Horizon，由这个页面我们可以大致确认组件的安装版本对应关系</p>
<p><a href="https://www.vmware.com/resources/compatibility/sim/interop_matrix.php" target="_blank" rel="external">https://www.vmware.com/resources/compatibility/sim/interop_matrix.php</a></p>
<p>VMware ESXi 6.0 U3<br>VMware vCenter Server 6.5 U1e or 6.0 U3d<br>VMware Horizon 7.4.</p>
<h3 id="Firmware"><a href="#Firmware" class="headerlink" title="Firmware"></a>Firmware</h3><blockquote>
<p>BIOS/RAID/NIC/HBA等信息获取请往下看</p>
</blockquote>
<p>Checking your firmware and BIOS levels to ensure compatibility with ESX/ESXi (1037257)<br><a href="https://kb.vmware.com/kb/1037257" target="_blank" rel="external">https://kb.vmware.com/kb/1037257</a></p>
<p>Determining Network/Storage firmware and driver version in ESXi 4.x and later (1027206)<br><a href="https://kb.vmware.com/kb/1027206" target="_blank" rel="external">https://kb.vmware.com/kb/1027206</a></p>
<p>Identifying the firmware of a Qlogic or Emulex FC HBA (1002413)<br><a href="https://kb.vmware.com/kb/1002413" target="_blank" rel="external">https://kb.vmware.com/kb/1002413</a></p>
<h2 id="ESXi兼容性信息收集"><a href="#ESXi兼容性信息收集" class="headerlink" title="ESXi兼容性信息收集"></a>ESXi兼容性信息收集</h2><h3 id="基础配置"><a href="#基础配置" class="headerlink" title="基础配置"></a>基础配置</h3><blockquote>
<p>开启ESXi Shell和SSH</p>
</blockquote>
<ol>
<li>完成ESXi系统安装</li>
<li>按<f2> Customize System/Viewlogs</f2></li>
<li>Troubleshooting Options </li>
<li>Enable ESXi Shell</li>
<li>Enable SSH</li>
</ol>
<blockquote>
<p>图形化与命令行切换快捷键</p>
</blockquote>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 切换至命令行</span></div><div class="line">Alt + F1</div><div class="line"><span class="comment"># 切换至图形化</span></div><div class="line">Alt + F2</div></pre></td></tr></table></figure>
<h3 id="BIOS"><a href="#BIOS" class="headerlink" title="BIOS"></a>BIOS</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 查找BIOS微码和CPU型号</span></div><div class="line">smbiosDump | more</div><div class="line"></div><div class="line">[root@DESK-VIEW1:~] smbiosDump | more</div><div class="line">Dumping live SMBIOS data!</div><div class="line">  BIOS Info: <span class="comment">#0</span></div><div class="line">    Size: 0x00018</div><div class="line">    Vendor: <span class="string">"HP"</span></div><div class="line">    Version: <span class="string">"P66"</span></div><div class="line">    Date: <span class="string">"07/29/2013"</span></div><div class="line">    Start Address: 0xf0000</div><div class="line">    ROM Size: 8192 kB</div><div class="line">    Features: 0x0703000000007dc9da80</div><div class="line">      PCI supported</div><div class="line">      PnP supported</div><div class="line">      BIOS flashable</div><div class="line">      BIOS shadowing allowed</div><div class="line">      ESCD supported</div><div class="line">      CD boot supported</div><div class="line">      Selectable boot supported</div><div class="line">      EDD spec supported</div><div class="line">      360kB Floppy supported</div><div class="line">      1.2MB Floppy supported</div><div class="line">      720kB Floppy supported</div><div class="line">      Print Screen supported</div><div class="line">      8042 Keyboard Services supported</div><div class="line">      Serial Services supported</div><div class="line">      Printer Services supported</div><div class="line">      CGA/Mono Video supported</div><div class="line">      ACPI supported</div><div class="line">      USB Legacy supported</div><div class="line">      BIOS Boot Spec supported</div><div class="line">      F12 Network boot supported</div><div class="line">      Enable targeted content distribution</div><div class="line">  System Info: <span class="comment">#256</span></div><div class="line">    Manufacturer: <span class="string">"HP"</span></div><div class="line">    Product: <span class="string">"ProLiant DL980 G7"</span></div><div class="line">    Serial: <span class="string">"SGH3301F85"</span></div><div class="line">    UUID: 35384631303333484753413135344d41</div><div class="line">    Wake-up: 0x06 (Power Switch)</div><div class="line">  Chassis Info: <span class="comment">#768</span></div><div class="line">    Manufacturer: <span class="string">"Hewlett-Packard"</span></div><div class="line">    Serial: <span class="string">"SGH3301F85"</span></div><div class="line">    Type: 0x17 (Rack Mount Chassis)</div><div class="line">    Bootup State: 0x03 (Safe)</div><div class="line">    Power Supply State: 0x03 (Safe)</div><div class="line">    Thermal State: 0x03 (Safe)</div><div class="line">    Security Status: 0x02 (Unknown)</div><div class="line">  Processor Info: <span class="comment">#1024</span></div><div class="line">    Payload length: 0x2a</div><div class="line">    Socket: <span class="string">"Proc 1 (Upper Tray, Processor 1)"</span></div><div class="line">    Socket Type: 0x1e (Socket LGA1567)</div><div class="line">    Socket Status: Populated</div><div class="line">    Type: 0x03 (CPU)</div><div class="line">    Family: 0xb3 (Xeon)</div><div class="line">    Manufacturer: <span class="string">"Intel"</span></div><div class="line">    Version: <span class="string">"Intel(R) Xeon(R) CPU E7- 2860 @ 2.27GHz"</span></div><div class="line">    Processor ID: 0xbfebfbff000206f2</div><div class="line">    Status: 0x01 (Enabled)</div><div class="line">    Voltage: 1.4 V</div><div class="line">    External Clock: 133 MHz</div><div class="line">    Max. Speed: 4800 MHz</div><div class="line">    Current Speed: 2267 MHz</div><div class="line">    L1 Cache: <span class="comment">#1808</span></div><div class="line">    L2 Cache: <span class="comment">#1824</span></div><div class="line">    L3 Cache: <span class="comment">#1840</span></div><div class="line">    Core Count: <span class="comment">#10</span></div><div class="line">    Core Enabled Count: <span class="comment">#10</span></div><div class="line">    Thread Count: <span class="comment">#20</span></div></pre></td></tr></table></figure>
<h3 id="RAID"><a href="#RAID" class="headerlink" title="RAID"></a>RAID</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 查看RAID微码</span></div><div class="line">cat /proc/driver/hpsa/hpsa0</div><div class="line"></div><div class="line">[root@DESK-VIEW1:~] cat /proc/driver/hpsa/hpsa0</div><div class="line">hpsa0: HP Smart Array P410i Controller</div><div class="line">Board ID: 0x3245103c</div><div class="line">Firmware Version: 6.40</div><div class="line">Driver Version: HP HPSA Driver (v 6.0.0.44-4vmw)</div><div class="line">Driver Build: 01</div><div class="line">IRQ: 45</div><div class="line">Logical drives: 1</div><div class="line">Current Q depth: 0</div><div class="line">Current <span class="comment"># commands on controller: 0</span></div><div class="line">Max Q depth since init: 0</div><div class="line">Max <span class="comment"># commands on controller since init: 6</span></div><div class="line">Max SG entries since init: 128</div><div class="line">Max Commands supported: 1020</div><div class="line">SCSI host number: 12</div><div class="line">Offline volume monitoring: Not running</div><div class="line"></div><div class="line">hpsa0/C12:B0:T0:L1	Direct-Access    	LOGICAL VOLUME  	6.40	RAID 1(1+0)</div></pre></td></tr></table></figure>
<h3 id="NIC"><a href="#NIC" class="headerlink" title="NIC"></a>NIC</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 查看当前网卡列表</span></div><div class="line">vmkchdev -l | grep vmnic</div><div class="line"><span class="comment"># 查看某块网卡具体信息</span></div><div class="line">ethtool -i vmnic0</div><div class="line"></div><div class="line">[root@DESK-VIEW1:~] vmkchdev -l | grep vmnic</div><div class="line">0000:04:00.0 4040:0100 103c:705a vmkernel vmnic0</div><div class="line">0000:04:00.1 4040:0100 103c:705a vmkernel vmnic1</div><div class="line">0000:04:00.2 4040:0100 103c:705a vmkernel vmnic2</div><div class="line">0000:04:00.3 4040:0100 103c:705a vmkernel vmnic3</div><div class="line">0000:54:00.0 14e4:1639 103c:7059 vmkernel vmnic4</div><div class="line">0000:54:00.1 14e4:1639 103c:7059 vmkernel vmnic5</div><div class="line">0000:57:00.0 14e4:1639 103c:7059 vmkernel vmnic6</div><div class="line">0000:57:00.1 14e4:1639 103c:7059 vmkernel vmnic7</div><div class="line">0000:5d:00.0 14e4:1639 103c:7059 vmkernel vmnic8</div><div class="line">0000:5d:00.1 14e4:1639 103c:7059 vmkernel vmnic9</div><div class="line">0000:60:00.0 14e4:1639 103c:7059 vmkernel vmnic10</div><div class="line">0000:60:00.1 14e4:1639 103c:7059 vmkernel vmnic11</div><div class="line">[root@DESK-VIEW1:~] ethtool -i vmnic0</div><div class="line">driver: nx_nic</div><div class="line">version: 5.0.621</div><div class="line">firmware-version: 4.0.593</div><div class="line">bus-info: 0000:04:00.0</div><div class="line">[root@DESK-VIEW1:~] ethtool -i vmnic11</div><div class="line">driver: bnx2</div><div class="line">version: 2.2.4f.v60.10</div><div class="line">firmware-version: bc 5.2.3</div><div class="line">bus-info: 0000:60:00.1</div><div class="line"></div><div class="line"><span class="comment"># 使用esxcli command可以查看更多设备描述信息</span></div><div class="line">esxcli network nic list</div><div class="line"><span class="comment"># 使用esxcli 查看更加详细的网卡信息</span></div><div class="line">esxcli network nic get -n vmnic0</div><div class="line"></div><div class="line">[root@DESK-VIEW1:~] esxcli network nic list</div><div class="line">Name     PCI Device    Driver  Admin Status  Link Status  Speed  Duplex  MAC Address         MTU  Description                                                                         </div><div class="line">-------  ------------  ------  ------------  -----------  -----  ------  -----------------  ----  ------------------------------------------------------------------------------------</div><div class="line">vmnic0   0000:04:00.0  nx_nic  Up            Down             0  Full    d8:9d:67:77:99:38  1500  NetXen HP NC375i Integrated Quad Port Multifunction Gigabit Server Adapter          </div><div class="line">vmnic1   0000:04:00.1  nx_nic  Up            Down             0  Full    d8:9d:67:77:99:39  1500  NetXen HP NC375i Integrated Quad Port Multifunction Gigabit Server Adapter          </div><div class="line">vmnic10  0000:60:00.0  bnx2    Up            Up            1000  Full    10:60:4b:a2:4a:90  1500  QLogic Corporation NC382T PCI Express Dual Port Multifunction Gigabit Server Adapter</div><div class="line">vmnic11  0000:60:00.1  bnx2    Up            Up            1000  Full    10:60:4b:a2:4a:92  1500  QLogic Corporation NC382T PCI Express Dual Port Multifunction Gigabit Server Adapter</div><div class="line">vmnic2   0000:04:00.2  nx_nic  Up            Down             0  Full    d8:9d:67:77:99:3a  1500  NetXen HP NC375i Integrated Quad Port Multifunction Gigabit Server Adapter          </div><div class="line">vmnic3   0000:04:00.3  nx_nic  Up            Down             0  Full    d8:9d:67:77:99:3b  1500  NetXen HP NC375i Integrated Quad Port Multifunction Gigabit Server Adapter          </div><div class="line">vmnic4   0000:54:00.0  bnx2    Up            Up            1000  Full    10:60:4b:a2:03:70  1500  QLogic Corporation NC382T PCI Express Dual Port Multifunction Gigabit Server Adapter</div><div class="line">vmnic5   0000:54:00.1  bnx2    Up            Up            1000  Full    10:60:4b:a2:03:72  1500  QLogic Corporation NC382T PCI Express Dual Port Multifunction Gigabit Server Adapter</div><div class="line">vmnic6   0000:57:00.0  bnx2    Up            Up            1000  Full    10:60:4b:a2:ca:08  1500  QLogic Corporation NC382T PCI Express Dual Port Multifunction Gigabit Server Adapter</div><div class="line">vmnic7   0000:57:00.1  bnx2    Up            Up            1000  Full    10:60:4b:a2:ca:0a  1500  QLogic Corporation NC382T PCI Express Dual Port Multifunction Gigabit Server Adapter</div><div class="line">vmnic8   0000:5d:00.0  bnx2    Up            Up            1000  Full    10:60:4b:a2:d9:bc  1500  QLogic Corporation NC382T PCI Express Dual Port Multifunction Gigabit Server Adapter</div><div class="line">vmnic9   0000:5d:00.1  bnx2    Up            Up            1000  Full    10:60:4b:a2:d9:be  1500  QLogic Corporation NC382T PCI Express Dual Port Multifunction Gigabit Server Adapter</div><div class="line">[root@DESK-VIEW1:~] esxcli network nic get -n vmnic11</div><div class="line">   Advertised Auto Negotiation: <span class="literal">true</span></div><div class="line">   Advertised Link Modes: 10baseT/Half, 10baseT/Full, 100baseT/Half, 100baseT/Full, 1000baseT/Full</div><div class="line">   Auto Negotiation: <span class="literal">true</span></div><div class="line">   Cable Type: Twisted Pair</div><div class="line">   Current Message Level: 0</div><div class="line">   Driver Info: </div><div class="line">         Bus Info: 0000:60:00.1</div><div class="line">         Driver: bnx2</div><div class="line">         Firmware Version: bc 5.2.3</div><div class="line">         Version: 2.2.4f.v60.10</div><div class="line">   Link Detected: <span class="literal">true</span></div><div class="line">   Link Status: Up </div><div class="line">   Name: vmnic11</div><div class="line">   PHYAddress: 1</div><div class="line">   Pause Autonegotiate: <span class="literal">true</span></div><div class="line">   Pause RX: <span class="literal">true</span></div><div class="line">   Pause TX: <span class="literal">true</span></div><div class="line">   Supported Ports: TP</div><div class="line">   Supports Auto Negotiation: <span class="literal">true</span></div><div class="line">   Supports Pause: <span class="literal">true</span></div><div class="line">   Supports Wakeon: <span class="literal">true</span></div><div class="line">   Transceiver: internal</div><div class="line">   Virtual Address: 00:50:56:54:71:e6</div><div class="line">   Wakeon: MagicPacket(tm)</div></pre></td></tr></table></figure>
<h3 id="HBA"><a href="#HBA" class="headerlink" title="HBA"></a>HBA</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 查看HBA卡驱动类型</span></div><div class="line">esxcfg-scsidevs -a</div><div class="line"><span class="comment"># 查找HBA卡具体驱动程序</span></div><div class="line">vmkload_mod -s &lt;HBADriver&gt; | grep Version</div><div class="line">vmkload_mod -s qlnativefc | grep Version</div><div class="line"><span class="comment"># 查看HBA卡供应商信息，便于之后确认VMware推荐HBA驱动</span></div><div class="line">vmkchdev -l | grep vmhba2</div><div class="line">000:0b:00.0 1077:2532 103c:3263 vmkernel vmhba2</div><div class="line">Vendor ID(VID): 1077</div><div class="line">Device ID(DID): 2532</div><div class="line">Sub-Vendor ID(SVID): 103c</div><div class="line">Sub-Device ID(SDID): 3263</div><div class="line"></div><div class="line">[root@DESK-VIEW1:~] esxcfg-scsidevs -a</div><div class="line">vmhba38 bnx2i             unbound   iscsi.vmhba38                           QLogic NetXtreme II iSCSI Adapter</div><div class="line">vmhba39 bnx2i             unbound   iscsi.vmhba39                           QLogic NetXtreme II iSCSI Adapter</div><div class="line">vmhba0  ata_piix          link-n/a  sata.vmhba0                             (0000:00:1f.2) Intel Corporation ICH10 4 port SATA IDE Controller</div><div class="line">vmhba1  hpsa              link-n/a  sas.500143802597a240                    (0000:03:00.0) Hewlett-Packard Company Smart Array P410i</div><div class="line">vmhba2  qlnativefc        link-up   fc.5001438024275201:5001438024275200    (0000:0b:00.0) QLogic Corp ISP2532-based 8Gb Fibre Channel to PCI Express HBA</div><div class="line">vmhba3  qlnativefc        link-n/a  fc.5001438024275203:5001438024275202    (0000:0b:00.1) QLogic Corp ISP2532-based 8Gb Fibre Channel to PCI Express HBA</div><div class="line">vmhba4  qlnativefc        link-up   fc.5001438024274bc1:5001438024274bc0    (0000:11:00.0) QLogic Corp ISP2532-based 8Gb Fibre Channel to PCI Express HBA</div><div class="line">vmhba40 ata_piix          link-n/a  sata.vmhba40                            (0000:00:1f.2) Intel Corporation ICH10 4 port SATA IDE Controller</div><div class="line">vmhba5  qlnativefc        link-n/a  fc.5001438024274bc3:5001438024274bc2    (0000:11:00.1) QLogic Corp ISP2532-based 8Gb Fibre Channel to PCI Express HBA</div><div class="line">vmhba32 bnx2i             unbound   iscsi.vmhba32                           QLogic NetXtreme II iSCSI Adapter</div><div class="line">vmhba33 bnx2i             unbound   iscsi.vmhba33                           QLogic NetXtreme II iSCSI Adapter</div><div class="line">vmhba34 bnx2i             unbound   iscsi.vmhba34                           QLogic NetXtreme II iSCSI Adapter</div><div class="line">vmhba35 bnx2i             unbound   iscsi.vmhba35                           QLogic NetXtreme II iSCSI Adapter</div><div class="line">vmhba36 bnx2i             unbound   iscsi.vmhba36                           QLogic NetXtreme II iSCSI Adapter</div><div class="line">vmhba37 bnx2i             unbound   iscsi.vmhba37                           QLogic NetXtreme II iSCSI Adapter</div><div class="line">[root@DESK-VIEW1:~] vmkload_mod -s qlnativefc | grep Version</div><div class="line"> Version: 2.1.50.0-1vmw.600.3.57.5050593</div><div class="line">[root@DESK-VIEW1:~] vmkchdev -l | grep vmhba2</div><div class="line">0000:0b:00.0 1077:2532 103c:3263 vmkernel vmhba2</div><div class="line"></div><div class="line"><span class="comment"># In ESXi 5.5 and later, you do not see native drivers in the /proc nodes. To view native driver information, run the command:</span></div><div class="line">/usr/lib/vmware/vmkmgmt_keyval/vmkmgmt_keyval -a</div><div class="line"></div><div class="line">[root@DESK-VIEW1:~] /usr/lib/vmware/vmkmgmt_keyval/vmkmgmt_keyval -a | more</div><div class="line">Listing all system keys:</div><div class="line">Key Value Instance:  vmhba3/qlogic</div><div class="line">Listing keys:</div><div class="line">Name:   ADAPTER</div><div class="line">Type:   string</div><div class="line">value:  </div><div class="line">QLogic PCI to Fibre Channel Host Adapter <span class="keyword">for</span> HPAJ764A:</div><div class="line">        FC Firmware version 8.02.00 (90d5), Driver version 2.1.50.0</div><div class="line"></div><div class="line">Host Device Name vmhba3</div><div class="line"></div><div class="line">BIOS version 3.13</div><div class="line">FCODE version N/A</div><div class="line">EFI version 6.15</div><div class="line">Flash FW version 5.09.00</div><div class="line">ISP: ISP2532, Serial<span class="comment"># MY532922UB</span></div><div class="line">MSI-X enabled</div><div class="line">Request Queue = 0x430c04a9e000, Response Queue = 0x430c04abf000</div><div class="line">Request Queue count = 2048, Response Queue count = 512</div><div class="line">Number of response queues <span class="keyword">for</span> CPU affinity operation: 8</div><div class="line">CPU Affinity mode enabled</div></pre></td></tr></table></figure>
<h3 id="IO-Devices"><a href="#IO-Devices" class="headerlink" title="IO Devices"></a>IO Devices</h3><p>登录VMware Compatibility Guide选择查找内容中的IO Devices<br><a href="https://www.vmware.com/resources/compatibility/search.php" target="_blank" rel="external">https://www.vmware.com/resources/compatibility/search.php</a></p>
<p>在右侧可以选择匹配VID/DID/SVID/Max SSID信息，输入上述案例中的DL980的HBA卡信息则可以得到更加精确的结果，1077:2532 103c:3263</p>
<h3 id="ESXi"><a href="#ESXi" class="headerlink" title="ESXi"></a>ESXi</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 查看ESXi版本</span></div><div class="line">[root@DESK-VIEW1:~] vmware -v</div><div class="line">VMware ESXi 6.0.0 build-5572656</div></pre></td></tr></table></figure>
<h3 id="vm-support"><a href="#vm-support" class="headerlink" title="vm-support"></a>vm-support</h3><p>如果需要做应急处置，直接使用vm-support命令收集打包交付给VMware工程师分析也会包含上述硬件微码信息</p>
<p>“vm-support” command in ESX/ESXi to collect diagnostic information (1010705)<br><a href="https://kb.vmware.com/kb/1010705" target="_blank" rel="external">https://kb.vmware.com/kb/1010705</a></p>
]]></content>
    
    <summary type="html">
    
      VMware Compatibility Guide
    
    </summary>
    
      <category term="学习 | Study" scheme="https://wsgzao.github.io/categories/%E5%AD%A6%E4%B9%A0-Study/"/>
    
    
  </entry>
  
  <entry>
    <title>使用Network Recycle Bin启用映射网络驱动器上的回收站</title>
    <link href="https://wsgzao.github.io/post/network-recycle-bin/"/>
    <id>https://wsgzao.github.io/post/network-recycle-bin/</id>
    <published>2018-04-20T02:59:49.000Z</published>
    <updated>2018-04-20T03:06:00.547Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>在内网环境中我们经常会使用NAS或者Samba在Windows中映射网络驱动器，方便局域网用户实时共享交换数据。但当存储在网络或映射网络上的任何文件被删除时，该文件将被永久删除。它不会去到本地计算机回收站，也不会去到服务器的回收站，我通过google在mydigitallife和microsoft technet中搜索到很多方法，但针对不同操作系统且涉及到域用户管理的复杂情况下，单纯的依赖注册表修改可能已经支撑不住需求的膨胀了。在所有的方法中使用Network Recycle Bin可以轻松解决映射网络驱动器上的回收站。</p>
<blockquote>
<p>使用Network Recycle Bin为局域网巧设“回收站”</p>
</blockquote>
<h2 id="更新历史"><a href="#更新历史" class="headerlink" title="更新历史"></a>更新历史</h2><p>2018年04月20日 - 初稿</p>
<p>阅读原文 - <a href="https://wsgzao.github.io/post/network-recycle-bin/">https://wsgzao.github.io/post/network-recycle-bin/</a></p>
<p><strong>扩展阅读</strong></p>
<p>Network Recycle Bin Tool - <a href="http://www.networkrecyclebin.info/index.html" target="_blank" rel="external">http://www.networkrecyclebin.info/index.html</a></p>
<hr>
<h2 id="如何启用映射网络驱动器上的回收站"><a href="#如何启用映射网络驱动器上的回收站" class="headerlink" title="如何启用映射网络驱动器上的回收站"></a>如何启用映射网络驱动器上的回收站</h2><p>映射驱动器不过是将本地驱动器连接到另一台计算机上特别分配的共享目录或文件夹。 一旦驱动器被映射，您就可以访问共享资源，您可以像对待您的系统本地一样对待它。可以将多个计算机驱动器映射到共享资源，并利用此网络空间。</p>
<p>当存储在网络或映射网络上的任何文件被删除时，该文件将被永久删除。 它不会去到本地计算机回收站，也不会去到服务器的回收站。 为了避免将来出现这种数据丢失情况，您可以在映射的网络驱动器上启用回收站。 按照以下给出的步骤在映射的网络驱动器上启用回收站.</p>
<ol>
<li>将网络驱动器映射到要使用的网络共享。 确保登录后重新连接驱动器</li>
<li>然后进入C：&gt; 用户 &gt; 用户名</li>
<li>右键单击该位置的任何文件夹，然后单击 属性 &gt; 位置选项卡</li>
<li>单击移动并浏览根驱动器（在步骤1中映射），然后点击选择文件夹</li>
<li>然后点击 好 并当对话框出现命中 是</li>
<li>只需在PC上为每个用户重复这些步骤</li>
</ol>
<p>注意：要验证此过程是否正常工作，请右键单击回收站并转至属性，并检查网络驱动器是否在回收站的位置列中列出。</p>
<p><img src="https://i.loli.net/2018/04/20/5ad9525cde76c.jpg" alt=""><br><img src="https://i.loli.net/2018/04/20/5ad956a54cab2.jpg" alt=""></p>
<p><strong>需要注意的事情</strong></p>
<p>这仅适用于通过映射的网络驱动器而不是UNC路径访问的文件。 我们举一个例子：如果你已经将\server\share映射到E：并从这个E：驱动器中删除了一些东西，那么它将会进入回收站。 但是，如果您浏览到\server\share并擦除文件，它将被永久删除。</p>
<h2 id="Enable-Recycle-Bin-on-mapped-network-drives"><a href="#Enable-Recycle-Bin-on-mapped-network-drives" class="headerlink" title="Enable Recycle Bin on mapped network drives"></a>Enable Recycle Bin on mapped network drives</h2><blockquote>
<p>方案1，通过重定向文件位置的方式我自己在Windows 10下测试可用，但Windows 7失败了</p>
</blockquote>
<p><a href="https://forums.mydigitallife.net/threads/tip-network-recycle-bin.16974/" target="_blank" rel="external">https://forums.mydigitallife.net/threads/tip-network-recycle-bin.16974/</a></p>
<p>You may have noticed that when you delete a file stored on a network location or mapped network drive that the file is permanently deleted. It does not go to the local computer’s recycle bin and does not go to the server’s recycle bin. I have discovered a work-around that extends recycle bin coverage to include mapped network drives. The solution is not 100% perfect, but works extremely well and does not rely on Shadow Copies or 3rd-party software.</p>
<p><img src="https://i.loli.net/2018/04/20/5ad951ff94b8e.png" alt=""></p>
<p>Here’s how:</p>
<ol>
<li>Map a network drive to the network share you want to use. Make sure that the drive is re-connected on logon. If you don’t know how to do this, search Google.</li>
<li>Browse to C:\users\<user name="">.</user></li>
<li>Right-click on one of the folders in this location (I chose saved games) and click properties.</li>
<li>Select the Location tab.</li>
<li>Click Move, browse to to root of the drive you mapped in step 1, and click Select Folder.</li>
<li>Click Ok and click yes in the dialogue box that appears.</li>
<li>Repeat these same steps for all users on the computer.</li>
</ol>
<blockquote>
<p>方案2，通过修改注册表搞定回收站问题，实际测试喜忧参半，通用性不高，不推荐</p>
</blockquote>
<p><a href="https://social.technet.microsoft.com/Forums/windows/en-US/a349801f-398f-4139-8e8b-b0a92f599e2b/enable-recycle-bin-on-mapped-network-drives" target="_blank" rel="external">https://social.technet.microsoft.com/Forums/windows/en-US/a349801f-398f-4139-8e8b-b0a92f599e2b/enable-recycle-bin-on-mapped-network-drives</a></p>
<p>Just copy and paste the following into notepad<br>and save it as “Network Recycling Bin - auto make registry file.bat”</p>
<figure class="highlight bat"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">echo</span> off </div><div class="line"><span class="comment">REM ========== MAIN FUNCTION  ======================== </span></div><div class="line">  </div><div class="line"><span class="keyword">Call</span> :CreateREGfile </div><div class="line"><span class="built_in">PAUSE</span> </div><div class="line"><span class="keyword">goto</span> :eof </div><div class="line">  </div><div class="line">  </div><div class="line">  </div><div class="line">  </div><div class="line"><span class="comment">REM ========== SUB FUNCTIONS  ======================== </span></div><div class="line">  </div><div class="line">:CreateREGfile </div><div class="line"><span class="built_in">set</span> /p RelativePath=Enter current mapped <span class="built_in">path</span> of drive (e.g. X:\FileShare\D_Drive): </div><div class="line"><span class="comment">REM replace \ with \\ (for reg value its a requirement) </span></div><div class="line"><span class="built_in">Set</span> RelativePath=<span class="variable">%RelativePath:\=\\%</span>  </div><div class="line">  </div><div class="line">  </div><div class="line"><span class="built_in">set</span> /p MaxBinSize_Dec=Enter max size (<span class="keyword">in</span> mb) (eg <span class="number">11</span>gb=<span class="number">11000</span>): </div><div class="line"><span class="keyword">call</span> :toHex <span class="variable">%MaxBinSize_Dec%</span> MaxBinSize_Hex </div><div class="line">  </div><div class="line">  </div><div class="line"><span class="built_in">Set</span> outputREG="Network Recycling Bin - <span class="variable">%RelativePath:~0,1%</span> Drive (<span class="variable">%MaxBinSize_Dec%</span>mb).reg" </div><div class="line">  </div><div class="line">  </div><div class="line"><span class="keyword">call</span> :MakeGUID_VBS NewGUID </div><div class="line"><span class="comment">REM echo My new GUID : %NewGUID% </span></div><div class="line">  </div><div class="line">  </div><div class="line"><span class="built_in">echo</span> Windows Registry Editor Version <span class="number">5</span>.<span class="number">00</span> &gt; <span class="variable">%outputREG%</span> </div><div class="line"><span class="built_in">echo</span> [HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Windows\CurrentVersion\Explorer\FolderDescriptions\<span class="variable">%NewGUID%</span>] &gt;&gt; <span class="variable">%outputREG%</span> </div><div class="line"><span class="built_in">echo</span> "RelativePath"="<span class="variable">%RelativePath%</span>" &gt;&gt; <span class="variable">%outputREG%</span> </div><div class="line"><span class="built_in">echo</span> "Category"=dword:<span class="number">00000004</span> &gt;&gt; <span class="variable">%outputREG%</span> </div><div class="line"><span class="built_in">echo</span> "Name"="NetworkDrive2RecyclingBin_<span class="variable">%NewGUID:~1,5%</span>" &gt;&gt; <span class="variable">%outputREG%</span> </div><div class="line"><span class="comment">      REM The "Name" value is required, but is not the name that will be shown if you right-click on the Recycle Bin and select properties. That will be autoset to the network drive name. </span></div><div class="line"><span class="built_in">echo</span>.&gt;&gt; <span class="variable">%outputREG%</span> </div><div class="line"><span class="built_in">echo</span> [HKEY_CURRENT_USER\Software\Microsoft\Windows\CurrentVersion\Explorer\BitBucket\KnownFolder\<span class="variable">%NewGUID%</span>]  &gt;&gt; <span class="variable">%outputREG%</span> </div><div class="line"><span class="built_in">echo</span> "MaxCapacity"=dword:<span class="variable">%MaxBinSize_Hex%</span> &gt;&gt; <span class="variable">%outputREG%</span> </div><div class="line"><span class="built_in">echo</span> "NukeOnDelete"=dword:<span class="number">00000000</span> &gt;&gt; <span class="variable">%outputREG%</span> </div><div class="line"><span class="keyword">goto</span> :eof </div><div class="line">  </div><div class="line">  </div><div class="line">  </div><div class="line">:MakeGUID_VBS </div><div class="line"><span class="built_in">echo</span> <span class="built_in">set</span> obj = CreateObject("Scriptlet.TypeLib") &gt; TEMP_generateGUID.vbs </div><div class="line"><span class="built_in">echo</span> WScript.<span class="built_in">Echo</span> obj.GUID &gt;&gt; TEMP_generateGUID.vbs </div><div class="line"><span class="keyword">FOR</span> /F "usebackq tokens=*" <span class="variable">%%r</span><span class="keyword">in</span> (`CSCRIPT "TEMP_generateGUID.vbs"`)<span class="keyword">DO</span> <span class="built_in">SET</span> RESULT=<span class="variable">%%r</span> </div><div class="line"><span class="built_in">set</span> <span class="variable">%1=%</span>RESULT% </div><div class="line">  </div><div class="line"><span class="built_in">del</span> TEMP_generateGUID.vbs </div><div class="line"><span class="keyword">goto</span> :eof </div><div class="line">  </div><div class="line">  </div><div class="line">:toDec </div><div class="line">:: todec hex dec -- <span class="built_in">convert</span> a hexadecimal number to decimal </div><div class="line">::             -- hex [<span class="keyword">in</span>]      - hexadecimal number to <span class="built_in">convert</span> </div><div class="line">::             -- dec [out,opt] - variable to store the converted decimal number <span class="keyword">in</span> </div><div class="line"><span class="built_in">SETLOCAL</span> </div><div class="line"><span class="built_in">set</span> /a dec=<span class="number">0</span>x%~<span class="number">1</span> </div><div class="line">( <span class="built_in">ENDLOCAL</span> &amp; <span class="built_in">REM</span> RETURN VALUES </div><div class="line">    <span class="keyword">IF</span> "%~<span class="number">2</span>" <span class="keyword">NEQ</span> "" (<span class="built_in">SET</span> <span class="variable">%~2=%</span>dec%)<span class="keyword">ELSE</span> <span class="built_in">ECHO</span>.<span class="variable">%dec%</span> </div><div class="line">) </div><div class="line"><span class="keyword">EXIT</span> /b </div><div class="line">  </div><div class="line">  </div><div class="line">:toHex </div><div class="line">:: eg  <span class="keyword">call</span> :toHex dec hex -- <span class="built_in">convert</span> a decimal number to hexadecimal, i.e. -<span class="number">20</span> to FFFFFFEC or <span class="number">26</span> to <span class="number">0000001</span>A </div><div class="line">::             -- dec [<span class="keyword">in</span>]      - decimal number to <span class="built_in">convert</span> </div><div class="line">::             -- hex [out,opt] - variable to store the converted hexadecimal number <span class="keyword">in</span> </div><div class="line">::Thanks to 'dbenham' dostips forum users who inspired to improve this function </div><div class="line">:$created <span class="number">20091203</span> :$changed <span class="number">20110330</span> :$categories Arithmetic,Encoding </div><div class="line">:$source http://www.dostips.com </div><div class="line"><span class="built_in">SETLOCAL</span> ENABLEDELAYEDEXPANSION </div><div class="line"><span class="built_in">set</span> /a dec=%~<span class="number">1</span> </div><div class="line"><span class="built_in">set</span> "hex=" </div><div class="line"><span class="built_in">set</span> "map=<span class="number">0123456789</span>ABCDEF" </div><div class="line"><span class="keyword">for</span> /L <span class="variable">%%N</span><span class="keyword">in</span> (<span class="number">1</span>,<span class="number">1</span>,<span class="number">8</span>)<span class="keyword">do</span> ( </div><div class="line">    <span class="built_in">set</span> /a "d=dec&amp;<span class="number">15</span>,dec&gt;&gt;=<span class="number">4</span>" </div><div class="line">    <span class="keyword">for</span> <span class="variable">%%D</span><span class="keyword">in</span> (<span class="variable">!d!</span>)<span class="keyword">do</span> <span class="built_in">set</span> "hex=<span class="variable">!map:~%%D,1!</span><span class="variable">!hex!</span>" </div><div class="line">) </div><div class="line"><span class="comment">rem !!!! REMOVE LEADING ZEROS by activating the next line, e.g. will return 1A instead of 0000001A </span></div><div class="line"><span class="comment">rem for /f "tokens=* delims=0" %%A in ("%hex%") do set "hex=%%A"&amp;if not defined hex set "hex=0" </span></div><div class="line">( <span class="built_in">ENDLOCAL</span> &amp; <span class="built_in">REM</span> RETURN VALUES </div><div class="line">    <span class="keyword">IF</span> "%~<span class="number">2</span>" <span class="keyword">NEQ</span> "" (<span class="built_in">SET</span> <span class="variable">%~2=%</span>hex%)<span class="keyword">ELSE</span> <span class="built_in">ECHO</span>.<span class="variable">%hex%</span> </div><div class="line">) </div><div class="line"><span class="keyword">EXIT</span> /b </div><div class="line">  </div><div class="line">  </div><div class="line">:eof</div></pre></td></tr></table></figure>
<h2 id="Network-Recycle-Bin-Tool简介"><a href="#Network-Recycle-Bin-Tool简介" class="headerlink" title="Network Recycle Bin Tool简介"></a>Network Recycle Bin Tool简介</h2><blockquote>
<p>本文主要使用Network Recycle Bin Tool Personal Client Machine Edition客户端</p>
</blockquote>
<h3 id="Server-Edition"><a href="#Server-Edition" class="headerlink" title="Server Edition"></a>Server Edition</h3><p>version 6.1.1.3</p>
<p>This version has been designed for the server usage. You should install it on the server to monitor shared folders. When network user will delete a shared file it will copy it to the “network recycle bin”. You have not install any additional software on client machines.</p>
<h3 id="Personal-Client-Machine-Edition"><a href="#Personal-Client-Machine-Edition" class="headerlink" title="Personal Client Machine Edition"></a>Personal Client Machine Edition</h3><p>version 5.2.3.8</p>
<p>When you delete a file stored on a <code>network location</code> or mapped network drive that the file is permanently deleted. It does not go to the local computer’s recycle bin and does not go to the server’s <code>recycle bin</code>.</p>
<p>How to enable a recycle bin for shared folders on a network ? There is the proper solution of restoring and securing your information even after deleting it - The Network Recycle Bin Tool allows you to <code>recover deleted files</code>.</p>
<p>Once you have this tool in your system, it will automatically keep a track of all the network deleted files and you can easily recover them. Instead of removing the files, this tool sends them directly to its predefined recycle bin folder.</p>
<p>There are various options to tune it up. For example: you can set size limits for files stored in the <code>Network Recycle Bin</code>, you can define the list of network drives or network folders to track deleted files.</p>
<p>Additionaly it offers you the Protect Files tool which <code>prevents deletion</code> of network files for specified folders according the file mask. Export and import functions help you to install software with same options on network machines. The <code>password control</code> disallows unauthorized access.</p>
<p>In the long run, losing your important network files and information accidentally is not an issue these days. Instead of getting anxious and worried, feel free to download network recycle bin tool from any reliable source and make sure that you have pre-installed this <code>recovery tool</code>.</p>
<h3 id="Network-Recycle-Bin-Tool使用方法"><a href="#Network-Recycle-Bin-Tool使用方法" class="headerlink" title="Network Recycle Bin Tool使用方法"></a>Network Recycle Bin Tool使用方法</h3><blockquote>
<p>使用方法非常简单，安装好Network Recycle Bin Tool只需要4步即可，其它需求可以自定义Options</p>
</blockquote>
<ol>
<li>选择<code>Protect Folders</code>添加你需要保护的的映射网络驱动器</li>
<li>在<code>Options</code>中确认删除文件的存储路径，默认可以不修改</li>
<li>在映射网络驱动器中尝试删除测试文件，在<code>Deleted Files</code>可以看到删除的文件</li>
<li>可以批量选中要恢复或者删除的文件点击<code>Recovery Files</code>或者<code>Delete Files</code></li>
</ol>
<p><img src="http://www.networkrecyclebin.info/images/network_recycle_bin2.png" alt=""><br><img src="http://www.networkrecyclebin.info/images/network_recycle_bin1.png" alt=""><br><img src="http://www.networkrecyclebin.info/images/network_recycle_bin3.png" alt=""></p>
]]></content>
    
    <summary type="html">
    
      使用Network Recycle Bin为局域网巧设“回收站”
    
    </summary>
    
      <category term="学习 | Study" scheme="https://wsgzao.github.io/categories/%E5%AD%A6%E4%B9%A0-Study/"/>
    
    
  </entry>
  
  <entry>
    <title>Jacman基于Pacman修改的Hexo主题</title>
    <link href="https://wsgzao.github.io/post/hexo-jacman/"/>
    <id>https://wsgzao.github.io/post/hexo-jacman/</id>
    <published>2018-04-19T09:11:20.000Z</published>
    <updated>2018-04-19T03:11:17.272Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>Pacman是一款为Hexo打造的一款扁平化，有着响应式设计的主题。 由于Pacman已经暂停更新，加上Hexo已经升级为3.0，很多主题需要重新适配，而Jacman是基于Pacman修改而来，在前端设计样式和功能上做了很多合理的修改和完善，相信你也一定可以很快上手。</p>
<blockquote>
<p>Jacman是一款基于Pacman修改并坚持更新的Hexo主题</p>
</blockquote>
<hr>
<h2 id="更新历史"><a href="#更新历史" class="headerlink" title="更新历史"></a>更新历史</h2><p>2018年04月19日 - 更新Hexo自动部署至GitLab方案<br>2015年12月30日 - 更新Jacman配置参数<br>2015年11月29日 - 更新Jacman配置细节<br>2015年03月22日 - 初稿</p>
<p>阅读原文 - <a href="https://wsgzao.github.io/post/hexo-pacman/">https://wsgzao.github.io/post/hexo-pacman/</a></p>
<p>扩展阅读</p>
<ul>
<li>Jacman - <a href="https://github.com/wuchong/jacman" target="_blank" rel="external">https://github.com/wuchong/jacman</a></li>
<li>HelloDog Index - <a href="https://wsgzao.github.io/index/#Hexo">https://wsgzao.github.io/index/#Hexo</a></li>
</ul>
<hr>
<h2 id="主题安装"><a href="#主题安装" class="headerlink" title="主题安装"></a>主题安装</h2><blockquote>
<p>设置很简单，请参考原文中文说明</p>
</blockquote>
<h3 id="Jacman"><a href="#Jacman" class="headerlink" title="Jacman"></a>Jacman</h3><p><a href="http://wuchong.me/blog/2014/11/20/how-to-use-jacman/" target="_blank" rel="external">http://wuchong.me/blog/2014/11/20/how-to-use-jacman/</a></p>
<hr>
<h2 id="配置yml"><a href="#配置yml" class="headerlink" title="配置yml"></a>配置yml</h2><blockquote>
<p>这是我自己的真实配置文件，请参考原文注释做修改</p>
</blockquote>
<h3 id="全局yml"><a href="#全局yml" class="headerlink" title="全局yml"></a>全局yml</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># Hexo Configuration</span></div><div class="line"><span class="comment">## Docs: https://hexo.io/docs/configuration.html</span></div><div class="line"><span class="comment">## Source: https://github.com/hexojs/hexo/</span></div><div class="line"></div><div class="line"><span class="comment"># Site</span></div><div class="line"><span class="attr">title:</span> <span class="string">HelloDog</span></div><div class="line"><span class="attr">subtitle:</span> <span class="string">Keep</span> <span class="string">Calm</span> <span class="string">and</span> <span class="string">Carry</span> <span class="string">On</span></div><div class="line"><span class="attr">description:</span> <span class="string">HelloDog是一个基于Github和Hexo的静态Blog，希望用简单而清晰的写作方式Markdown分享自己的心得体会。</span></div><div class="line"><span class="attr">author:</span> <span class="string">wsgzao</span></div><div class="line"><span class="attr">language:</span> <span class="string">zh-CN</span></div><div class="line"><span class="attr">timezone:</span></div><div class="line"></div><div class="line"><span class="comment"># URL</span></div><div class="line"><span class="comment">## If your site is put in a subdirectory, set url as 'http://yoursite.com/child' and root as '/child/'</span></div><div class="line"><span class="attr">url:</span> <span class="attr">https://wsgzao.github.io</span> <span class="comment"># with the https protocol</span></div><div class="line"><span class="attr">enforce_ssl:</span> <span class="string">wsgzao.github.io</span> <span class="comment"># without any protocol</span></div><div class="line"><span class="attr">root:</span> <span class="string">/</span></div><div class="line"><span class="attr">permalink:</span> <span class="string">post/:title/</span></div><div class="line"><span class="attr">permalink_defaults:</span></div><div class="line"></div><div class="line"><span class="comment"># Directory</span></div><div class="line"><span class="attr">source_dir:</span> <span class="string">source</span></div><div class="line"><span class="attr">public_dir:</span> <span class="string">public</span></div><div class="line"><span class="attr">tag_dir:</span> <span class="string">tags</span></div><div class="line"><span class="attr">archive_dir:</span> <span class="string">archives</span></div><div class="line"><span class="attr">category_dir:</span> <span class="string">categories</span></div><div class="line"><span class="attr">code_dir:</span> <span class="string">downloads/code</span></div><div class="line"><span class="attr">i18n_dir:</span> <span class="string">:lang</span></div><div class="line"><span class="attr">skip_render:</span></div><div class="line"></div><div class="line"><span class="comment"># Writing</span></div><div class="line"><span class="attr">new_post_name:</span> <span class="string">:title.md</span> <span class="comment"># File name of new posts</span></div><div class="line"><span class="attr">default_layout:</span> <span class="string">post</span></div><div class="line"><span class="attr">titlecase:</span> <span class="literal">false</span> <span class="comment"># Transform title into titlecase</span></div><div class="line"><span class="attr">external_link:</span> <span class="literal">true</span> <span class="comment"># Open external links in new tab</span></div><div class="line"><span class="attr">filename_case:</span> <span class="number">0</span></div><div class="line"><span class="attr">render_drafts:</span> <span class="literal">false</span></div><div class="line"><span class="attr">post_asset_folder:</span> <span class="literal">false</span></div><div class="line"><span class="attr">relative_link:</span> <span class="literal">false</span></div><div class="line"><span class="attr">future:</span> <span class="literal">true</span></div><div class="line"><span class="attr">highlight:</span></div><div class="line"><span class="attr">  enable:</span> <span class="literal">true</span></div><div class="line"><span class="attr">  line_number:</span> <span class="literal">true</span></div><div class="line"><span class="attr">  tab_replace:</span></div><div class="line"></div><div class="line"><span class="comment"># Category &amp; Tag</span></div><div class="line"><span class="attr">default_category:</span> <span class="string">uncategorized</span></div><div class="line"><span class="attr">category_map:</span></div><div class="line"><span class="attr">tag_map:</span></div><div class="line"></div><div class="line"><span class="comment"># Date / Time format</span></div><div class="line"><span class="comment">## Hexo uses Moment.js to parse and display date</span></div><div class="line"><span class="comment">## You can customize the date format as defined in</span></div><div class="line"><span class="comment">## http://momentjs.com/docs/#/displaying/format/</span></div><div class="line"><span class="attr">date_format:</span> <span class="string">YYYY-MM-DD</span></div><div class="line"><span class="attr">time_format:</span> <span class="attr">HH:mm:ss</span></div><div class="line"></div><div class="line"><span class="comment"># Pagination</span></div><div class="line"><span class="comment">## Set per_page to 0 to disable pagination</span></div><div class="line"><span class="attr">per_page:</span> <span class="number">10</span></div><div class="line"><span class="attr">pagination_dir:</span> <span class="string">page</span></div><div class="line"></div><div class="line"><span class="comment"># Extensions</span></div><div class="line"><span class="comment">## Plugins: https://hexo.io/plugins/</span></div><div class="line"><span class="comment">## Themes: https://hexo.io/themes/</span></div><div class="line"><span class="attr">theme:</span> <span class="string">jacman</span></div><div class="line"></div><div class="line"><span class="comment"># Deployment</span></div><div class="line"><span class="comment">## Docs: https://hexo.io/docs/deployment.html</span></div><div class="line"><span class="attr">deploy:</span></div><div class="line"><span class="attr">  type:</span></div><div class="line"></div><div class="line"><span class="comment"># Others</span></div><div class="line"><span class="attr">index_generator:</span></div><div class="line"><span class="attr">  per_page:</span> <span class="number">5</span> <span class="comment">##首页默认10篇文章标题 如果值为0不分页</span></div><div class="line"></div><div class="line"><span class="attr">archive_generator:</span></div><div class="line"><span class="attr">    per_page:</span> <span class="number">0</span> <span class="comment">##归档页面默认10篇文章标题</span></div><div class="line"><span class="attr">    yearly:</span> <span class="literal">true</span>  <span class="comment">##生成年视图</span></div><div class="line"><span class="attr">    monthly:</span> <span class="literal">true</span> <span class="comment">##生成月视图</span></div><div class="line"></div><div class="line"><span class="attr">tag_generator:</span></div><div class="line"><span class="attr">    per_page:</span> <span class="number">0</span> <span class="comment">##标签分类页面默认10篇文章</span></div><div class="line"></div><div class="line"><span class="attr">category_generator:</span> </div><div class="line"><span class="attr">    per_page:</span> <span class="number">0</span> <span class="comment">###分类页面默认10篇文章</span></div><div class="line"></div><div class="line"><span class="attr">feed:</span></div><div class="line"><span class="attr">    type:</span> <span class="string">atom</span> <span class="comment">##feed类型 atom或者rss2</span></div><div class="line"><span class="attr">    path:</span> <span class="string">atom.xml</span> <span class="comment">##feed路径</span></div><div class="line"><span class="attr">    limit:</span> <span class="number">20</span>  <span class="comment">##feed文章最小数量</span></div></pre></td></tr></table></figure>
<hr>
<h3 id="主题yml"><a href="#主题yml" class="headerlink" title="主题yml"></a>主题yml</h3><figure class="highlight yml"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div></pre></td><td class="code"><pre><div class="line"><span class="comment">##### Menu</span></div><div class="line"><span class="attr">menu:</span></div><div class="line">  <span class="string">主页</span> <span class="string">| Home: /</span></div><div class="line"><span class="string">  索引 | Index: /index/</span></div><div class="line"><span class="string">  归档 | Archives: /archives/</span></div><div class="line"><span class="string">  简介 | About: /about/</span></div><div class="line"><span class="string">## you can create `tags` and `categories` folders in `../source`.</span></div><div class="line"><span class="string">## And create a `index.md` file in each of them.</span></div><div class="line"><span class="string">## set `front-matter`as</span></div><div class="line"><span class="string">## layout: tags (or categories)</span></div><div class="line"><span class="string">## title: tags (or categories)</span></div><div class="line"><span class="string">## ---</span></div><div class="line"><span class="string"></span></div><div class="line"><span class="string">#### Widgets</span></div><div class="line"><span class="string"></span><span class="attr">widgets:</span> </div><div class="line"><span class="bullet">-</span> <span class="string">github-card</span></div><div class="line"><span class="bullet">-</span> <span class="string">category</span></div><div class="line"><span class="bullet">-</span> <span class="string">links</span></div><div class="line"><span class="bullet">-</span> <span class="string">rss</span></div><div class="line">  <span class="comment">## provide eight widgets:github-card,category,tag,rss,archive,tagcloud,links,weibo</span></div><div class="line"></div><div class="line"><span class="comment">#### RSS </span></div><div class="line"><span class="attr">rss:</span> <span class="string">/atom.xml</span> <span class="comment">## RSS address.</span></div><div class="line"></div><div class="line"><span class="comment">#### Image</span></div><div class="line"><span class="attr">imglogo:</span></div><div class="line"><span class="attr">  enable:</span> <span class="literal">true</span>             <span class="comment">## display image logo true/false.</span></div><div class="line"><span class="attr">  src:</span> <span class="string">img/logo.png</span>        <span class="comment">## `.svg` and `.png` are recommended,please put image into the theme folder `/jacman/source/img`.</span></div><div class="line"><span class="attr">favicon:</span> <span class="string">img/favicon.ico</span>   <span class="comment">## size:32px*32px,`.ico` is recommended,please put image into the theme folder `/jacman/source/img`.     </span></div><div class="line"><span class="attr">apple_icon:</span> <span class="string">img/jacman.jpg</span> <span class="comment">## size:114px*114px,please put image into the theme folder `/jacman/source/img`.</span></div><div class="line"><span class="attr">author_img:</span> <span class="string">img/author.jpg</span> <span class="comment">## size:220px*220px.display author avatar picture.if don't want to display,please don't set this.</span></div><div class="line"><span class="attr">banner_img:</span> <span class="comment">#img/banner.jpg ## size:1920px*200px+. Banner Picture</span></div><div class="line"><span class="comment">### Theme Color </span></div><div class="line"><span class="attr">theme_color:</span></div><div class="line"><span class="attr">    theme:</span> <span class="string">'#ea6753'</span>    <span class="comment">##the defaut theme color is blue</span></div><div class="line"></div><div class="line"><span class="comment"># 代码高亮主题</span></div><div class="line"><span class="comment"># available: default | night</span></div><div class="line"><span class="attr">highlight_theme:</span> <span class="string">night</span></div><div class="line"></div><div class="line"><span class="comment">#### index post is expanding or not </span></div><div class="line"><span class="attr">index:</span></div><div class="line"><span class="attr">  expand:</span> <span class="literal">false</span>           <span class="comment">## default is unexpanding,so you can only see the short description of each post.</span></div><div class="line"><span class="attr">  excerpt_link:</span> <span class="string">Read</span> <span class="string">More</span>  </div><div class="line"></div><div class="line"><span class="attr">close_aside:</span> <span class="literal">true</span>  <span class="comment">#close sidebar in post page if true</span></div><div class="line"><span class="attr">mathjax:</span> <span class="literal">false</span>      <span class="comment">#enable mathjax if true</span></div><div class="line"></div><div class="line"><span class="comment">### Creative Commons License Support, see http://creativecommons.org/ </span></div><div class="line"><span class="comment">### you can choose: by , by-nc , by-nc-nd , by-nc-sa , by-nd , by-sa , zero</span></div><div class="line"><span class="attr">creative_commons:</span> <span class="string">none</span></div><div class="line"></div><div class="line"><span class="comment">#### Author information</span></div><div class="line"><span class="attr">author:</span></div><div class="line"><span class="attr">  intro_line1:</span>  <span class="string">"Hello, I'm OX. This is my blog on GitHub."</span>    <span class="comment">## your introduction on the bottom of the page</span></div><div class="line"><span class="attr">  intro_line2:</span>  <span class="string">"Keep Calm and Carry On."</span>  <span class="comment">## the 2nd line</span></div><div class="line"><span class="attr">  weibo:</span>  <span class="comment">## e.g. wuchong1014 or 2176287895 for http://weibo.com/2176287895</span></div><div class="line"><span class="attr">  weibo_verifier:</span>  <span class="comment">## e.g. b3593ceb Your weibo-show widget verifier ,if you use weibo-show it is needed.</span></div><div class="line"><span class="attr">  tsina:</span>      <span class="comment">## e.g. 2176287895  Your weibo ID,It will be used in share button.</span></div><div class="line"><span class="attr">  douban:</span>     <span class="comment">## e.g. wuchong1014 or your id for https://www.douban.com/people/wuchong1014</span></div><div class="line"><span class="attr">  zhihu:</span>      <span class="comment">## e.g. jark  for http://www.zhihu.com/people/jark</span></div><div class="line"><span class="attr">  email:</span>      <span class="comment">## e.g. imjark@gmail.com</span></div><div class="line"><span class="attr">  twitter:</span>    <span class="comment">## e.g. jarkwu for https://twitter.com/jarkwu</span></div><div class="line"><span class="attr">  github:</span> <span class="string">wsgzao</span>    <span class="comment">## e.g. wuchong for https://github.com/wuchong</span></div><div class="line"><span class="attr">  facebook:</span>   <span class="comment">## e.g. imjark for https://facebook.com/imjark</span></div><div class="line"><span class="attr">  linkedin:</span> <span class="string">aowang</span>  <span class="comment">## e.g. wuchong1014 for https://www.linkedin.com/in/wuchong1014</span></div><div class="line"><span class="attr">  google_plus:</span>    <span class="comment">## e.g. "111190881341800841449" for https://plus.google.com/u/0/111190881341800841449, the "" is needed!</span></div><div class="line"><span class="attr">  stackoverflow:</span>  <span class="comment">## e.g. 3222790 for http://stackoverflow.com/users/3222790/jark</span></div><div class="line"><span class="comment">## if you set them, the corresponding  share button will show on the footer</span></div><div class="line"></div><div class="line"><span class="comment">#### Toc</span></div><div class="line"><span class="attr">toc:</span></div><div class="line"><span class="attr">  article:</span> <span class="literal">true</span>   <span class="comment">## show contents in article.</span></div><div class="line"><span class="attr">  aside:</span> <span class="literal">true</span>     <span class="comment">## show contents in aside.</span></div><div class="line"><span class="comment">## you can set both of the value to true of neither of them.</span></div><div class="line"><span class="comment">## if you don't want display contents in a specified post,you can modify `front-matter` and add `toc: false`.</span></div><div class="line"></div><div class="line"><span class="comment">#### Links</span></div><div class="line"><span class="attr">links:</span></div><div class="line">  <span class="string">Jark's</span> <span class="attr">Blog:</span> <span class="attr">http://wuchong.me</span></div><div class="line"><span class="attr">  LinkedIn:</span> <span class="attr">https://www.linkedin.com/in/aowang</span></div><div class="line"></div><div class="line"><span class="comment">#### Comment</span></div><div class="line"><span class="attr">duoshuo_shortname:</span>    <span class="comment">## e.g. wuchong   your duoshuo short name.</span></div><div class="line"><span class="attr">disqus_shortname:</span> <span class="string">wsgzao</span>    <span class="comment">## e.g. wuchong   your disqus short name.</span></div><div class="line"><span class="attr">gentie_key:</span>           <span class="comment">## your 163 gentie key, see https://gentie.163.com/</span></div><div class="line"><span class="attr">changyan_appid:</span>       <span class="comment">## changyan app id, see http://changyan.kuaizhan.com/</span></div><div class="line"><span class="attr">changyan_appkey:</span>      <span class="comment">## changyan app key, see http://changyan.kuaizhan.com/</span></div><div class="line"><span class="attr">xianliao_appid:</span> <span class="number">12835</span>       <span class="comment">## xianliao app key, see https://www.xianliao.me/</span></div><div class="line"></div><div class="line"><span class="comment">#### Share button</span></div><div class="line"><span class="attr">jiathis:</span></div><div class="line"><span class="attr">  enable:</span> <span class="literal">false</span> <span class="comment">## if you use jiathis as your share tool,the built-in share tool won't be display.</span></div><div class="line"><span class="attr">  id:</span> <span class="number">1503875</span>   <span class="comment">## e.g. 1889330 your jiathis ID. </span></div><div class="line"><span class="attr">  tsina:</span> <span class="number">1913082125</span> <span class="comment">## e.g. 2176287895 Your weibo id,It will be used in share button.</span></div><div class="line"></div><div class="line"><span class="comment">#### Analytics</span></div><div class="line"><span class="attr">google_analytics:</span></div><div class="line"><span class="attr">  enable:</span> <span class="literal">true</span></div><div class="line"><span class="attr">  id:</span> <span class="string">UA-77732745-1</span>       <span class="comment">## e.g. UA-46321946-2 your google analytics ID.</span></div><div class="line"><span class="attr">  site:</span> <span class="string">wsgzao.github.io</span>     <span class="comment">## e.g. wuchong.me your google analytics site or set the value as auto.</span></div><div class="line"><span class="comment">## You MUST upgrade to Universal Analytics first!</span></div><div class="line"><span class="comment">## https://developers.google.com/analytics/devguides/collection/upgrade/?hl=zh_CN</span></div><div class="line"><span class="attr">baidu_tongji:</span></div><div class="line"><span class="attr">  enable:</span> <span class="literal">true</span></div><div class="line"><span class="attr">  sitecode:</span> <span class="string">c2c5fc7d844d0973d9f77abd87f49c3c</span> <span class="comment">## e.g. e6d1f421bbc9962127a50488f9ed37d1 your baidu tongji site code</span></div><div class="line"><span class="attr">cnzz_tongji:</span></div><div class="line"><span class="attr">  enable:</span> <span class="literal">false</span></div><div class="line"><span class="attr">  siteid:</span>    <span class="comment">## e.g. 1253575964 your cnzz tongji site id</span></div><div class="line"></div><div class="line"><span class="comment">#### Miscellaneous</span></div><div class="line"><span class="attr">ShowCustomFont:</span> <span class="literal">true</span>  <span class="comment">## you can change custom font in `variable.styl` and `font.styl` which in the theme folder `/jacman/source/css`.</span></div><div class="line"><span class="attr">fancybox:</span> <span class="literal">true</span>        <span class="comment">## if you use gallery post or want use fancybox please set the value to true.</span></div><div class="line"><span class="attr">totop:</span> <span class="literal">true</span>           <span class="comment">## if you want to scroll to top in every post set the value to true</span></div><div class="line"></div><div class="line"><span class="comment">#### Custom Search</span></div><div class="line"><span class="attr">google_cse:</span> </div><div class="line"><span class="attr">  enable:</span> <span class="literal">false</span></div><div class="line"><span class="attr">  cx:</span>   <span class="comment">## e.g. 018294693190868310296:abnhpuysycw your Custom Search ID.</span></div><div class="line"><span class="comment">## https://www.google.com/cse/ </span></div><div class="line"><span class="comment">## To enable the custom search You must create a "search" folder in '/source' and a "index.md" file</span></div><div class="line"><span class="comment">## set the 'front-matter' as</span></div><div class="line"><span class="comment">## layout: search </span></div><div class="line"><span class="comment">## title: search</span></div><div class="line"><span class="comment">## ---</span></div><div class="line"><span class="attr">baidu_search:</span>     <span class="comment">## http://zn.baidu.com/</span></div><div class="line"><span class="attr">  enable:</span> <span class="literal">false</span></div><div class="line"><span class="attr">  id:</span> <span class="string">"3783770861532079376"</span>  <span class="comment">## e.g. "783281470518440642"  for your baidu search id</span></div><div class="line"><span class="attr">  site:</span> <span class="attr">http://zhannei.baidu.com/cse/search</span>  <span class="comment">## your can change to your site instead of the default site</span></div><div class="line">  </div><div class="line"><span class="attr">swiftype:</span>     <span class="comment">## https://swiftype.com/</span></div><div class="line"><span class="attr">  enable:</span> <span class="literal">true</span></div></pre></td></tr></table></figure>
<hr>
<h2 id="内容发布"><a href="#内容发布" class="headerlink" title="内容发布"></a>内容发布</h2><h3 id="修改post预设格式"><a href="#修改post预设格式" class="headerlink" title="修改post预设格式"></a>修改post预设格式</h3><blockquote>
<p>建议按照个人习惯修改<code>hexo\scaffolds</code>中的<code>post.md</code></p>
</blockquote>
<figure class="highlight md"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">title: &#123;&#123; title &#125;&#125;</div><div class="line">date: &#123;&#123; date &#125;&#125;</div><div class="line">categories:</div><div class="line">description:</div></pre></td></tr></table></figure>
<h3 id="生成文章"><a href="#生成文章" class="headerlink" title="生成文章"></a>生成文章</h3><blockquote>
<p>文章如含有有中文请修改编码为<code>UTF-8</code>避免乱码</p>
</blockquote>
<p>1.命令生成初始文章，文件名空格会自动加<code>-</code>hyphen中横线</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">hexo n <span class="string">"hexo post"</span></div></pre></td></tr></table></figure>
<p>2.在<code>hexo\source\_posts</code>中编辑生成出来的<code>hexo-post</code>文件</p>
<figure class="highlight md"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line">title: hexo post #可以改成中文的，如“新文章”</div><div class="line">date: 2015-01-14 21:31:42 #发表日期，可自定义修改排序</div><div class="line">categories: blog #文章文类</div><div class="line">tags: [博客,文章] #文章标签，可以加入多标签</div><div class="line">---</div><div class="line"><span class="section">#这里是正文，用Markdown书写</span></div></pre></td></tr></table></figure>
<p>3.本地预览文章内容，登录<code>localhost:4000</code>查看效果<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">hexo s</div></pre></td></tr></table></figure></p>
<p>4.发布内容到<code>public</code>文件夹，然后我选择手动复制同步到GitHub<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">hexo clean</div><div class="line">hexo g</div></pre></td></tr></table></figure></p>
<h3 id="导航栏添加自定义页面"><a href="#导航栏添加自定义页面" class="headerlink" title="导航栏添加自定义页面"></a>导航栏添加自定义页面</h3><p>1.命令手动生成自定义页面<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">hexo n page <span class="string">"about"</span></div></pre></td></tr></table></figure></p>
<p>2.编辑<code>hexo/source/about/index.md</code>内容<br>3.修改<code>themes/jacman/_config.yml</code>文件<br><figure class="highlight md"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">menu:</div><div class="line">  关于: /about</div></pre></td></tr></table></figure></p>
<hr>
<h2 id="其它修改"><a href="#其它修改" class="headerlink" title="其它修改"></a>其它修改</h2><h3 id="RSS和sitemap"><a href="#RSS和sitemap" class="headerlink" title="RSS和sitemap"></a>RSS和sitemap</h3><p>1.安装RSS和sitemap插件<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">npm install hexo-generator-feed@1 --save</div><div class="line">npm install hexo-generator-sitemap@1 --save</div></pre></td></tr></table></figure></p>
<p>2.开启RSS和sitemap功能，编辑<code>hexo/_config.yml</code><br><figure class="highlight md"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">feed:</div><div class="line">  type: atom       #feed 类型 (atom/rss2)</div><div class="line">  path: atom.xml   #rss 路径</div><div class="line">  limit: 20        #在 rss 中最多生成的文章数(0显示所有)</div></pre></td></tr></table></figure></p>
<p>3.修改<code>thems/jacman/_config.yml</code>，编辑Widgets和rss<br><figure class="highlight md"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="section">#### Widgets</span></div><div class="line">widgets:</div><div class="line"><span class="bullet">- </span>rss</div><div class="line"></div><div class="line">rss: /atom.xml</div></pre></td></tr></table></figure></p>
<p>4.手动提交生成出来的<code>atom.xml</code>文件给搜索引擎</p>
<h3 id="添加404页面"><a href="#添加404页面" class="headerlink" title="添加404页面"></a>添加404页面</h3><p>在GitHub根目录下如<code>wsgzao.github.io</code>设置404.html即可，建议使用<code>腾讯公益404</code><br><figure class="highlight html"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div></pre></td><td class="code"><pre><div class="line"><span class="tag">&lt;<span class="name">html</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">"UTF-8"</span> /&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">title</span>&gt;</span>404 | HelloDog<span class="tag">&lt;/<span class="name">title</span>&gt;</span>                                                                                              </div><div class="line"><span class="tag">&lt;/<span class="name">head</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">type</span>=<span class="string">"text/javascript"</span> <span class="attr">src</span>=<span class="string">"http://www.qq.com/404/search_children.js"</span> <span class="attr">charset</span>=<span class="string">"utf-8"</span>&gt;</span><span class="undefined"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></div><div class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></div></pre></td></tr></table></figure></p>
<h3 id="网站统计"><a href="#网站统计" class="headerlink" title="网站统计"></a>网站统计</h3><p>Jacman自带的选择足够了</p>
<h3 id="站内搜索"><a href="#站内搜索" class="headerlink" title="站内搜索"></a>站内搜索</h3><p>swiftype - <a href="https://swiftype.com/" target="_blank" rel="external">https://swiftype.com/</a></p>
<p>利用swiftype为hexo添加站内搜索v2.0<br><a href="http://www.jerryfu.net/post/search-engine-for-hexo-with-swiftype-v2.html" target="_blank" rel="external">http://www.jerryfu.net/post/search-engine-for-hexo-with-swiftype-v2.html</a></p>
<h2 id="常见错误"><a href="#常见错误" class="headerlink" title="常见错误"></a>常见错误</h2><ol>
<li>修改配置文件时注意<code>YAML</code>语法，参数<code>冒号:</code>后一定要留<code>空格</code></li>
<li>中文乱码请修改文件编码格式为<code>UTF-8</code></li>
<li>GitHub同步慢或者失败请使用代理加速</li>
</ol>
<h2 id="Hexo-自动部署至-GitLab"><a href="#Hexo-自动部署至-GitLab" class="headerlink" title="Hexo 自动部署至 GitLab"></a>Hexo 自动部署至 GitLab</h2><p>网上很多已经有很多方法了，常见的可能有2种思路，当然也有人选择容器或者Bitcron</p>
<ol>
<li>基于hexo deploy 一键部署</li>
<li>基于Travis CI自动部署Hexo到GitHub</li>
</ol>
<p>我想满足的需求和大家一样越简单越好，只是我更多时候在本地编辑通过Evernote和Dropbox同步数据，发送至wsgzao.github.io的GitHub Page中，其实仔细思考一下用最纯粹的命令不就好了。</p>
<p>以 Windows 10 环境 PowerShell 为例，在 Git Shell 家目录创建 deploy_hexo.ps1</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"># hexo g</div><div class="line">cd .\hexo</div><div class="line">hexo clean</div><div class="line">hexo g</div><div class="line"></div><div class="line"># del old files</div><div class="line">cd ..\wsgzao.github.io</div><div class="line">Remove-Item about,archives,categories,css,fancybox,font,img,index,js,page,post -recurse -force</div><div class="line"></div><div class="line"># deploy github</div><div class="line">Copy-Item ..\hexo\public\* .\ -recurse -force</div><div class="line">git add *</div><div class="line">git commit -m &quot;mod&quot;</div><div class="line">git push</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      Jacman是一款基于Pacman修改并坚持更新的Hexo主题
    
    </summary>
    
      <category term="Hexo" scheme="https://wsgzao.github.io/categories/Hexo/"/>
    
    
  </entry>
  
  <entry>
    <title>RHEL7/CentOS7在线和离线安装GitLab配置使用实践</title>
    <link href="https://wsgzao.github.io/post/gitlab/"/>
    <id>https://wsgzao.github.io/post/gitlab/</id>
    <published>2018-04-19T08:40:53.000Z</published>
    <updated>2018-04-23T06:31:13.219Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>GitLab Community Edition 新版本已经集成了CI/CD的支持，从某种程度上来说可以告别对于Jenkins的依赖，我本来计划是写基于Docker部署GitLab但感觉还是有点重，对于内网离线环境来说基于容器部署也未必是合理的方案，这里沿用传统的部署方式介绍简单且长期有效的GitLab部署方案供大家参考，或许未来会增加基于容器的部署方案和CI/CD的分享，因需而变。</p>
<blockquote>
<p>RHEL7/CentOS7在线和离线安装GitLab配置实践，GitLab汉化配置使用小结</p>
</blockquote>
<h2 id="更新记录"><a href="#更新记录" class="headerlink" title="更新记录"></a>更新记录</h2><p>2018年04月19日 - 完善内容<br>2018年04月10日 - 初稿</p>
<p>阅读原文 - <a href="https://wsgzao.github.io/post/gitlab/">https://wsgzao.github.io/post/gitlab/</a></p>
<p><strong>扩展阅读</strong></p>
<p>GitLab Installation - <a href="https://about.gitlab.com/installation" target="_blank" rel="external">https://about.gitlab.com/installation</a></p>
<h2 id="GitLab简介"><a href="#GitLab简介" class="headerlink" title="GitLab简介"></a>GitLab简介</h2><p>GitLab是利用Ruby On Rails开发的一个开源版本管理系统，实现了一个自托管的Git项目仓库，是集代码托管，测试，部署于一体的开源git仓库管理软件，可通过web界面来进行访问公开的或私人项目。与Github类似，GitLab能够浏览代码，管理缺陷和注释。可以管理团队对仓库的访问，它非常易于浏览提交过的版本，并提供一个文件历史库。它还提供一个代码片段收集功能可以轻松实现代码复用，便于日后需要的时候查找。</p>
<blockquote>
<p>Git的家族成员</p>
</blockquote>
<ul>
<li>Git：是一种版本控制系统，是一个命令，是一种工具。</li>
<li>Gitlib：是用于实现Git功能的开发库。</li>
<li>Github：是一个基于Git实现的在线代码托管仓库，公开项目是免费的，也可以付费创建私人项目。</li>
<li>GitLab：是一个基于Git实现的在线代码仓库托管软件，可以用GitLab搭建一套类似Github的系统。</li>
</ul>
<p>GitLab对硬件还是有一定要求的，1核心的CPU基本上可以满足需求，大概支撑100个左右的用户，不过在运行GitLab网站的同时还需要运行多个后台job，就会显得有点捉襟见肘了。需要至少4GB的可寻址内存（RAM交换）来安装和使用GitLab，操作系统和任何其他正在运行的应用程序也将使用内存，因此请记住，在运行GitLab之前，您至少需要4GB的可用空间。如果使用更少的内存，GitLab将在重新配置运行期间给出奇怪的错误，我用虚拟机来分别新建1G,2G内存的CentOS系统来装GitLab，确实非常捉襟见肘啊，伤不起。</p>
<h3 id="Gitlab的服务构成"><a href="#Gitlab的服务构成" class="headerlink" title="Gitlab的服务构成"></a>Gitlab的服务构成</h3><ul>
<li>Nginx：静态web服务器</li>
<li>gitlab-shell：用于处理Git命令和修改authorized keys列表</li>
<li>gitlab-workhorse: 轻量级的反向代理服务器</li>
<li>logrotate：日志文件管理工具</li>
<li>postgresql：数据库</li>
<li>redis：缓存数据库</li>
<li>sidekiq：用于在后台执行队列任务（异步执行）</li>
<li>unicorn：An HTTP server for Rack applications，GitLab Rails应用是托管在这个服务器上面的</li>
</ul>
<h3 id="GitLab工作流程"><a href="#GitLab工作流程" class="headerlink" title="GitLab工作流程"></a>GitLab工作流程</h3><p><img src="http://docs-aliyun.cn-hangzhou.oss.aliyun-inc.com/assets/pic/52857/cn_zh/1492756915645/%E5%9B%BE%E7%89%878.png" alt=""></p>
<h2 id="GitLab安装"><a href="#GitLab安装" class="headerlink" title="GitLab安装"></a>GitLab安装</h2><h3 id="基础依赖"><a href="#基础依赖" class="headerlink" title="基础依赖"></a>基础依赖</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line">yum install curl policycoreutils openssh-server openssh-clients -y</div><div class="line">systemctl <span class="built_in">enable</span> sshd</div><div class="line">systemctl start sshd</div><div class="line">yum install postfix</div><div class="line">systemctl <span class="built_in">enable</span> postfix</div><div class="line"></div><div class="line"><span class="comment"># 检查修改邮件下面2项配置，不配置可以跳过</span></div><div class="line">vim /etc/postfix/main.cf </div><div class="line"></div><div class="line">inet_interfaces = all</div><div class="line">inet_protocols = ipv4</div><div class="line"></div><div class="line">systemctl start postfix</div></pre></td></tr></table></figure>
<h3 id="在线安装gitlab-ce"><a href="#在线安装gitlab-ce" class="headerlink" title="在线安装gitlab-ce"></a>在线安装gitlab-ce</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 安装必要的依赖包，如果不需要可以考虑跳过</span></div><div class="line">yum install pygpgme yum-utils</div><div class="line"><span class="comment"># On CentOS 7 (and RedHat/Oracle/Scientific Linux 7), the commands below will also open HTTP and SSH access in the system firewall.</span></div><div class="line">sudo yum install -y curl policycoreutils-python openssh-server</div><div class="line">sudo systemctl <span class="built_in">enable</span> sshd</div><div class="line">sudo systemctl start sshd</div><div class="line">sudo firewall-cmd --permanent --add-service=http</div><div class="line">sudo systemctl reload firewalld</div><div class="line"><span class="comment"># Next, install Postfix to send notification emails. If you want to use another solution to send emails please skip this step and configure an external SMTP server after GitLab has been installed.</span></div><div class="line">sudo yum install postfix</div><div class="line">sudo systemctl <span class="built_in">enable</span> postfix</div><div class="line">sudo systemctl start postfix</div><div class="line"></div><div class="line"><span class="comment"># 使用阿里云作加速</span></div><div class="line"><span class="built_in">cd</span> /etc/yum.repos.d/ &amp;&amp; rm -f *.repo</div><div class="line">wget -O /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/epel-7.repo</div><div class="line">wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo</div><div class="line"></div><div class="line"><span class="comment"># 添加GitLab镜像源并安装，建议切换国内资源加速访问</span></div><div class="line">curl https://packages.gitlab.com/install/repositories/gitlab/gitlab-ce/script.rpm.sh | sudo bash</div><div class="line"></div><div class="line"><span class="comment"># 创建gitlab-ce的repo，使用清华大学加速</span></div><div class="line">vim /etc/yum.repos.d/gitlab_gitlab-ce.repo</div><div class="line"></div><div class="line">[gitlab-ce]</div><div class="line">name=gitlab-ce</div><div class="line">baseurl=http://mirrors.tuna.tsinghua.edu.cn/gitlab-ce/yum/el7</div><div class="line">repo_gpgcheck=0</div><div class="line">gpgcheck=0</div><div class="line">enabled=1</div><div class="line">gpgkey=https://packages.gitlab.com/gpg.key</div><div class="line"></div><div class="line"><span class="comment">#配置并启动 GitLab</span></div><div class="line">gitlab-ctl reconfigure</div><div class="line"></div><div class="line"><span class="comment"># 第一次访问GitLab，系统会重定向页面到重定向到重置密码页面，你需要输入初始化管理员账号的密码，管理员的用户名为root，重置密码后新密码即为刚输入的密码。</span></div><div class="line">0.0.0.0:80</div></pre></td></tr></table></figure>
<h3 id="离线安装gitlab-ce"><a href="#离线安装gitlab-ce" class="headerlink" title="离线安装gitlab-ce"></a>离线安装gitlab-ce</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 使用阿里云作加速</span></div><div class="line"><span class="built_in">cd</span> /etc/yum.repos.d/ &amp;&amp; rm -f *.repo</div><div class="line">wget -O /etc/yum.repos.d/epel.repo http://mirrors.aliyun.com/repo/epel-7.repo</div><div class="line">wget -O /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo</div><div class="line"></div><div class="line"><span class="comment"># 添加GitLab镜像源并安装，建议切换国内资源加速访问</span></div><div class="line">curl https://packages.gitlab.com/install/repositories/gitlab/gitlab-ce/script.rpm.sh | sudo bash</div><div class="line"></div><div class="line"><span class="comment"># 创建gitlab-ce的repo，使用清华大学加速</span></div><div class="line">vim /etc/yum.repos.d/gitlab_gitlab-ce.repo</div><div class="line"></div><div class="line">[gitlab-ce]</div><div class="line">name=gitlab-ce</div><div class="line">baseurl=http://mirrors.tuna.tsinghua.edu.cn/gitlab-ce/yum/el7</div><div class="line">repo_gpgcheck=0</div><div class="line">gpgcheck=0</div><div class="line">enabled=1</div><div class="line">gpgkey=https://packages.gitlab.com/gpg.key</div><div class="line"></div><div class="line"><span class="comment">#安装yum-plugin-downloadonly插件</span></div><div class="line">yum install -y yum-plugin-downloadonly</div><div class="line"></div><div class="line"><span class="comment"># 下载gitlab-ce相关rpm到指定目录</span></div><div class="line">mkdir -p /tmp/repo/gitlab-ce/</div><div class="line">yum install --downloadonly --downloaddir=/tmp/repo/gitlab-ce/ gitlab-ce</div><div class="line"></div><div class="line"><span class="comment"># 拷贝文件至内网离线安装</span></div><div class="line">rpm -ivh /tmp/repo/gitlab-ce/*</div><div class="line"></div><div class="line"><span class="comment">#配置并启动 GitLab</span></div><div class="line">gitlab-ctl reconfigure</div><div class="line"></div><div class="line"><span class="comment"># 第一次访问GitLab，系统会重定向页面到重定向到重置密码页面，你需要输入初始化管理员账号的密码，管理员的用户名为root，重置密码后新密码即为刚输入的密码。</span></div><div class="line">0.0.0.0:80</div></pre></td></tr></table></figure>
<h2 id="GitLab汉化"><a href="#GitLab汉化" class="headerlink" title="GitLab汉化"></a>GitLab汉化</h2><blockquote>
<p>如果团队里英文水平都不错的话，是没必要汉化的，我个人的建议是坚持使用原版不做汉化</p>
</blockquote>
<p>我这边测试GitLab 10.6.3 新版本中官方已经集成了简体中文，虽然不完整但应该是一个好的开端，设置方式如下<br>右上角用户头像-Settings-Profile-Main settings-Preferred language-简体中文<br>保存选择Update profile settings，然后Sign out重新登录就可以看到效果了<br>当然我还是希望大家习惯English界面，Trouble Shooting也方便</p>
<p>GitLab中文社区的项目，v7-v8.8是由Larry Li发起的“GitLab中文社区版项目”<br><a href="https://gitlab.com/larryli/gitlab" target="_blank" rel="external">https://gitlab.com/larryli/gitlab</a></p>
<p>从v8.9之后由@xhang开始继续汉化项目<br><a href="https://gitlab.com/xhang/gitlab" target="_blank" rel="external">https://gitlab.com/xhang/gitlab</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 如没安装git，需提前安装</span></div><div class="line">yum install -y git</div><div class="line"></div><div class="line"><span class="comment"># 创建gitlba汉化包下载目录</span></div><div class="line">mkdir -p /tmp/gitlab</div><div class="line"><span class="built_in">cd</span> /tmp/gitlab</div><div class="line"></div><div class="line"><span class="comment"># 下载最新的汉化包</span></div><div class="line">git <span class="built_in">clone</span> https://gitlab.com/xhang/gitlab.git</div><div class="line"></div><div class="line"><span class="comment"># 如果是要下载老版本的汉化包，需要加上老版本的分支，如果想下载10.0.2，可以运行如下语句</span></div><div class="line">git <span class="built_in">clone</span> https://gitlab.com/xhang/gitlab.git -b v10.0.2-zh</div><div class="line"></div><div class="line"><span class="comment"># 停止GitLab并执行如下语句</span></div><div class="line">gitlab-ctl stop</div><div class="line">cp /tmp/gitlab/gitlab/* /opt/gitlab/embedded/service/gitlab-rails/ -rf</div><div class="line"></div><div class="line"><span class="comment"># 复制时可能不断提示是否要覆盖，这时可能是系统每次执行cp命令时，其实是执行了cp -i命令的别名。出现这种情况可以修改~/.bashrc，在“alias cp=’cp-i’”前加#注释即可。使用命令或者注销登录即可</span></div><div class="line"><span class="built_in">source</span> ~/.bashrc</div><div class="line"></div><div class="line"><span class="comment"># 接下来可以重新配置和启动</span></div><div class="line">gitlab-ctl reconfigure</div><div class="line">gitlab-ctl restart</div></pre></td></tr></table></figure>
<h2 id="GitLab-常用命令"><a href="#GitLab-常用命令" class="headerlink" title="GitLab 常用命令"></a>GitLab 常用命令</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 语法</span></div><div class="line">gitlab-ctl <span class="built_in">command</span> (subcommand)</div><div class="line"></div><div class="line">Service Management Commands</div><div class="line"></div><div class="line">start <span class="comment"># 启动所有服务</span></div><div class="line">stop <span class="comment"># 关闭所有服务</span></div><div class="line">restart <span class="comment"># 重启所有服务</span></div><div class="line">status <span class="comment"># 查看所有服务状态</span></div><div class="line">tail <span class="comment"># 查看日志信息</span></div><div class="line">service-list <span class="comment"># 列举所有启动服务</span></div><div class="line">graceful-kill <span class="comment"># 平稳停止一个服务</span></div><div class="line"></div><div class="line"><span class="comment"># 启动所有服务</span></div><div class="line">gitlab-ctl start </div><div class="line"><span class="comment"># 启动单独一个服务</span></div><div class="line">gitlab-ctl start nginx</div><div class="line"><span class="comment">#查看日志，查看所有日志</span></div><div class="line">gitlab-ctl tail</div><div class="line"><span class="comment">#查看具体一个日志,类似tail -f</span></div><div class="line">gitlab-ctl tail nginx</div><div class="line"></div><div class="line">General Commands</div><div class="line"></div><div class="line"><span class="built_in">help</span> <span class="comment"># 帮助</span></div><div class="line">reconfigure <span class="comment"># 修改配置文件之后，需要重新加载下</span></div><div class="line">show-config <span class="comment"># 查看所有服务配置文件信息</span></div><div class="line">uninstall <span class="comment"># 卸载这个软件</span></div><div class="line">cleanse <span class="comment"># 删除gitlab数据，重新白手起家</span></div><div class="line"></div><div class="line"><span class="comment"># 显示所有服务配置文件</span></div><div class="line">gitlab-ctl show-config</div><div class="line"></div><div class="line"><span class="comment"># 卸载gitlab</span></div><div class="line">gitlab-ctl uninstall</div></pre></td></tr></table></figure>
<h2 id="公网邮箱配置"><a href="#公网邮箱配置" class="headerlink" title="公网邮箱配置"></a>公网邮箱配置</h2><p>默认情况下，GitLab用qq邮箱注册是发不出确认邮件的。查看了网上很多邮箱配置的教程，大部分都是误导的。像这类软件，归根到底总结为一句话：一切以官网文档为准。QQ邮箱最好用企业邮箱，本人用个人邮箱进行测试是有些小问题的，正确配置如下：</p>
<p>其他邮箱可以参考官方给出的 SMTP 配置 SMTP Setting<br><a href="https://docs.gitlab.com/omnibus/settings/smtp.html" target="_blank" rel="external">https://docs.gitlab.com/omnibus/settings/smtp.html</a></p>
<h3 id="QQ企业邮箱"><a href="#QQ企业邮箱" class="headerlink" title="QQ企业邮箱"></a>QQ企业邮箱</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 编辑gitlab.rb</span></div><div class="line">vim /etc/gitlab/gitlab.rb</div><div class="line"></div><div class="line">gitlab_rails[<span class="string">'smtp_enable'</span>] = <span class="literal">true</span></div><div class="line">gitlab_rails[<span class="string">'smtp_address'</span>] = <span class="string">"smtp.exmail.qq.com"</span></div><div class="line">gitlab_rails[<span class="string">'smtp_port'</span>] = 465</div><div class="line">gitlab_rails[<span class="string">'smtp_user_name'</span>] = <span class="string">"xxxx@xx.com"</span></div><div class="line">gitlab_rails[<span class="string">'smtp_password'</span>] = <span class="string">"password"</span></div><div class="line">gitlab_rails[<span class="string">'smtp_authentication'</span>] = <span class="string">"login"</span></div><div class="line">gitlab_rails[<span class="string">'smtp_enable_starttls_auto'</span>] = <span class="literal">true</span></div><div class="line">gitlab_rails[<span class="string">'smtp_tls'</span>] = <span class="literal">true</span></div><div class="line">gitlab_rails[<span class="string">'gitlab_email_from'</span>] = <span class="string">'xxxx@xx.com'</span></div></pre></td></tr></table></figure>
<h3 id="163邮箱"><a href="#163邮箱" class="headerlink" title="163邮箱"></a>163邮箱</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 编辑gitlab.rb</span></div><div class="line">vim /etc/gitlab/gitlab.rb</div><div class="line"></div><div class="line">gitlab_rails[<span class="string">'smtp_enable'</span>] = <span class="literal">true</span></div><div class="line">gitlab_rails[<span class="string">'smtp_address'</span>] = <span class="string">"smtp.163.com"</span></div><div class="line">gitlab_rails[<span class="string">'smtp_port'</span>] = 25</div><div class="line">gitlab_rails[<span class="string">'smtp_user_name'</span>] = <span class="string">"gitlab@163.com"</span></div><div class="line">gitlab_rails[<span class="string">'smtp_password'</span>] = <span class="string">"123456"</span></div><div class="line">gitlab_rails[<span class="string">'smtp_domain'</span>] = <span class="string">"163.com"</span></div><div class="line">gitlab_rails[<span class="string">'smtp_authentication'</span>] = <span class="string">"login"</span></div><div class="line">gitlab_rails[<span class="string">'smtp_enable_starttls_auto'</span>] = <span class="literal">true</span></div><div class="line">gitlab_rails[<span class="string">'gitlab_email_from'</span>] = <span class="string">'gitlab@163.com'</span></div><div class="line">gitlab_rails[<span class="string">'smtp_tls'</span>] = <span class="literal">false</span></div><div class="line">gitlab_rails[<span class="string">'smtp_openssl_verify_mode'</span>] = <span class="literal">false</span></div></pre></td></tr></table></figure>
<h3 id="阿里云企业邮箱"><a href="#阿里云企业邮箱" class="headerlink" title="阿里云企业邮箱"></a>阿里云企业邮箱</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 编辑gitlab.rb</span></div><div class="line">vim /etc/gitlab/gitlab.rb</div><div class="line"></div><div class="line">gitlab_rails[<span class="string">'smtp_enable'</span>] = <span class="literal">true</span></div><div class="line">gitlab_rails[<span class="string">'smtp_address'</span>] = <span class="string">"smtp.mxhichina.com"</span></div><div class="line">gitlab_rails[<span class="string">'smtp_port'</span>] = 465</div><div class="line">gitlab_rails[<span class="string">'smtp_user_name'</span>] = <span class="string">"gitlab@aliyun.com"</span></div><div class="line">gitlab_rails[<span class="string">'smtp_password'</span>] = <span class="string">"************"</span></div><div class="line">gitlab_rails[<span class="string">'smtp_domain'</span>] = <span class="string">"aliyun.com"</span></div><div class="line">gitlab_rails[<span class="string">'smtp_authentication'</span>] = <span class="string">"login"</span></div><div class="line">gitlab_rails[<span class="string">'smtp_enable_starttls_auto'</span>] = <span class="literal">true</span></div><div class="line">gitlab_rails[<span class="string">'gitlab_email_from'</span>] = <span class="string">'gitlab@aliyun.com'</span></div></pre></td></tr></table></figure>
<h2 id="GitLab使用"><a href="#GitLab使用" class="headerlink" title="GitLab使用"></a>GitLab使用</h2><h3 id="登录GitLab"><a href="#登录GitLab" class="headerlink" title="登录GitLab"></a>登录GitLab</h3><ol>
<li>在浏览器的地址栏中输入IP即可登录GitLab的界面，老版本第一次登录使用的用户名和密码为 <code>root</code> 和 <code>5iveL!fe</code></li>
<li>首次登录会强制用户修改密码。密码修改成功后，输入新密码进行登录</li>
</ol>
<h3 id="创建Project"><a href="#创建Project" class="headerlink" title="创建Project"></a>创建Project</h3><p>1.安装Git工具linux：安装Git，使用自带的源安装</p>
<pre><code>yum install git
</code></pre><p>2.生成密钥文件：使用ssh-keygen生成密钥文件.ssh/id_rsa.pub。</p>
<pre><code>ssh-keygen -t rsa
</code></pre><p>3.在GitLab的主页中新建一个Project</p>
<p>4.添加ssh key导入步骤2中生成的密钥文件内容：</p>
<pre><code>Profile Settings =&gt; SSH Keys =&gt; Add SSH key
</code></pre><h3 id="简单配置"><a href="#简单配置" class="headerlink" title="简单配置"></a>简单配置</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 配置使用Git仓库的人员姓名</span></div><div class="line">git config --global user.name <span class="string">"wangao"</span> </div><div class="line"><span class="comment"># 配置使用Git仓库的人员email，填写自己的公司邮箱</span></div><div class="line">git config --global user.email <span class="string">"wangao@test.com"</span> </div><div class="line"><span class="comment"># 克隆项目，在本地生成同名目录，并且目录中会有所有的项目文件</span></div><div class="line">git <span class="built_in">clone</span> git@172.28.70.126:root/test.git</div><div class="line"><span class="comment"># 进入到项目目录</span></div><div class="line"><span class="built_in">cd</span> <span class="built_in">test</span>/ </div><div class="line"><span class="comment"># 创建需要上传到GitLab中的目标文件</span></div><div class="line"><span class="built_in">echo</span> <span class="string">"test"</span> &gt; test.sh</div><div class="line"><span class="comment"># 将test.sh文件加入到索引中</span></div><div class="line">git add test.sh</div><div class="line"><span class="comment"># 将test.sh提交到本地仓库</span></div><div class="line">git commit -m <span class="string">"test.sh"</span></div><div class="line"><span class="comment"># 将文件同步到GitLab服务器上</span></div><div class="line">git push -u origin master</div><div class="line"><span class="comment"># 在网页中查看上传的test.sh文件已经同步到GitLab中</span></div></pre></td></tr></table></figure>
<h2 id="配置-GitLab"><a href="#配置-GitLab" class="headerlink" title="配置 GitLab"></a>配置 GitLab</h2><h3 id="设置外部访问链接"><a href="#设置外部访问链接" class="headerlink" title="设置外部访问链接"></a>设置外部访问链接</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 编辑 /etc/gitlab/gitlab.rb</span></div><div class="line">vim /etc/gitlab/gitlab.rb</div><div class="line"></div><div class="line"><span class="comment"># 修改第 13 行，改成 http(s)://ip(: 端口) 或者 http(s):// 域名 (: 端口)，（如果云主机上存在 Web 服务占用了 80,443 端口，则 GitLab 不能适用 80,443），比如：</span></div><div class="line">external_url <span class="string">"https://repo.gitlab.com"</span></div></pre></td></tr></table></figure>
<h3 id="HTTPS-配置"><a href="#HTTPS-配置" class="headerlink" title="HTTPS 配置"></a>HTTPS 配置</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 第513行开始，将SSL证书以及密钥放入/etc/gitlab/ssl/</span></div><div class="line">nginx[<span class="string">'enable'</span>] = <span class="literal">true</span></div><div class="line">nginx[<span class="string">'redirect_http_to_https'</span>] = <span class="literal">true</span></div><div class="line">nginx[<span class="string">'ssl_certificate'</span>] = <span class="string">"/etc/gitlab/ssl/server.crt"</span></div><div class="line">nginx[<span class="string">'ssl_certificate_key'</span>] = <span class="string">"/etc/gitlab/ssl/server.key"</span></div></pre></td></tr></table></figure>
<h3 id="应用配置"><a href="#应用配置" class="headerlink" title="应用配置"></a>应用配置</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 使配置生效</span></div><div class="line">sudo gitlab-ctl reconfigure</div><div class="line"></div><div class="line"><span class="comment"># 开启gitlab</span></div><div class="line">sudo gitlab-ctl start</div><div class="line"></div><div class="line"><span class="comment"># 查看状态</span></div><div class="line">sudo gitlab-ctl status</div></pre></td></tr></table></figure>
<h2 id="GitLab-备份升级迁移"><a href="#GitLab-备份升级迁移" class="headerlink" title="GitLab 备份升级迁移"></a>GitLab 备份升级迁移</h2><h3 id="GitLab-备份"><a href="#GitLab-备份" class="headerlink" title="GitLab 备份"></a>GitLab 备份</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div></pre></td><td class="code"><pre><div class="line">ansible-rhel7.4@JQ/opt/gitlab/etc<span class="comment">#gitlab-rake gitlab:backup:create</span></div><div class="line">Dumping database ... </div><div class="line">Dumping PostgreSQL database gitlabhq_production ... [DONE]</div><div class="line"><span class="keyword">done</span></div><div class="line">Dumping repositories ...</div><div class="line"> * root/ansible ... [DONE]</div><div class="line"> * root/ansible.wiki ...  [SKIPPED]</div><div class="line"><span class="keyword">done</span></div><div class="line">Dumping uploads ... </div><div class="line"><span class="keyword">done</span></div><div class="line">Dumping builds ... </div><div class="line"><span class="keyword">done</span></div><div class="line">Dumping artifacts ... </div><div class="line"><span class="keyword">done</span></div><div class="line">Dumping pages ... </div><div class="line"><span class="keyword">done</span></div><div class="line">Dumping lfs objects ... </div><div class="line"><span class="keyword">done</span></div><div class="line">Dumping container registry images ... </div><div class="line">[DISABLED]</div><div class="line">Creating backup archive: 1524016954_2018_04_18_10.6.3_gitlab_backup.tar ... <span class="keyword">done</span></div><div class="line">Uploading backup archive to remote storage  ... skipped</div><div class="line">Deleting tmp directories ... <span class="keyword">done</span></div><div class="line"><span class="keyword">done</span></div><div class="line"><span class="keyword">done</span></div><div class="line"><span class="keyword">done</span></div><div class="line"><span class="keyword">done</span></div><div class="line"><span class="keyword">done</span></div><div class="line"><span class="keyword">done</span></div><div class="line"><span class="keyword">done</span></div><div class="line">Deleting old backups ... skipping</div><div class="line"></div><div class="line">ansible-rhel7.4@JQ/opt/gitlab<span class="comment">#cd /var/opt/gitlab/backups</span></div><div class="line">ansible-rhel7.4@JQ/var/opt/gitlab/backups<span class="comment">#ll</span></div><div class="line">total 22372</div><div class="line">-rw------- 1 git git 22906880 Apr 18 10:02 1524016954_2018_04_18_10.6.3_gitlab_backup.tar</div></pre></td></tr></table></figure>
<h3 id="GitLab-升级"><a href="#GitLab-升级" class="headerlink" title="GitLab 升级"></a>GitLab 升级</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 停止gitlab相关服务</span></div><div class="line">gitlab-ctl stop</div><div class="line"></div><div class="line"><span class="comment"># 下载离线包升级gitlab，建议不要跨3个以上大版本升级，具体升级方案请参考官方文档</span></div><div class="line">rpm -Uvh gitlab-ce-10.6.3-ce.0.el7.x86_64.rpm</div><div class="line"></div><div class="line"><span class="comment"># 重新配置gitlab</span></div><div class="line">gitlab-ctl reconfigure</div><div class="line"></div><div class="line"><span class="comment"># 启动gitlab</span></div><div class="line">gitlab-ctl start</div></pre></td></tr></table></figure>
<h3 id="GitLab-迁移"><a href="#GitLab-迁移" class="headerlink" title="GitLab 迁移"></a>GitLab 迁移</h3><ol>
<li>GitLab 迁移的前提是新旧机器GitLab版本必须一致</li>
<li>在旧机器备份,默认会在/var/opt/gitlab/backups/ 创建备份文件#gitlab-rake gitlab:backup:create</li>
<li>复制备份文件到新机器 /var/opt/gitlab/backups/</li>
<li>在新机器运行下面命令,停止相关数据连接服务,然后从备份文件恢复</li>
<li>启动gitlab</li>
</ol>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 停止gitlab</span></div><div class="line">gitlab-ctl stop</div><div class="line"><span class="comment"># 从1524016954编号备份中恢复</span></div><div class="line">gitlab-rake gitlab:backup:restore BACKUP=1524016954 </div><div class="line"><span class="comment"># 启动gitlab</span></div><div class="line">gitlab-ctl start</div></pre></td></tr></table></figure>
<h2 id="GitLab-常见问题"><a href="#GitLab-常见问题" class="headerlink" title="GitLab 常见问题"></a>GitLab 常见问题</h2><h3 id="更改管理员密码"><a href="#更改管理员密码" class="headerlink" title="更改管理员密码"></a>更改管理员密码</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line">gitlab-rails console production</div><div class="line"></div><div class="line">Loading production environment (Rails 4.8.5.2)</div><div class="line">irb(main):001:0&gt; user = User.where(id: 1).first</div><div class="line">=&gt; <span class="comment">#&lt;User id: 1, email: "admin@example.com", ...</span></div><div class="line">irb(main):002:0&gt; user.password=123456</div><div class="line">=&gt; 123456</div><div class="line">irb(main):003:0&gt; user.password_confirmation=123456</div><div class="line">=&gt; 123456</div><div class="line">irb(main):004:0&gt; user.save!</div><div class="line">=&gt; <span class="literal">true</span></div><div class="line">irb(main):005:0&gt; quit</div></pre></td></tr></table></figure>
<h3 id="The-requested-URL-returned-error-401-while-accessing"><a href="#The-requested-URL-returned-error-401-while-accessing" class="headerlink" title="The requested URL returned error: 401 while accessing"></a>The requested URL returned error: 401 while accessing</h3><blockquote>
<p>这里遇到的问题是因为需要在参数里增加授权后的用户名和密码，不排除可能因为其它问题引起相同报错，如果是403可能是私有仓库没有授权导致</p>
</blockquote>
<p>(ox-zRbE61dW) test101@JQ/home/ox/git$git clone <a href="http://172.31.96.248/wangao/ansible.git" target="_blank" rel="external">http://172.31.96.248/wangao/ansible.git</a><br>Initialized empty Git repository in /home/ox/git/ansible/.git/<br>error: The requested URL returned error: 401 while accessing <a href="http://172.31.96.248/wangao/ansible.git/info/refs" target="_blank" rel="external">http://172.31.96.248/wangao/ansible.git/info/refs</a></p>
<p>fatal: HTTP request failed<br>(ox-zRbE61dW) test101@JQ/home/ox/git$git clone <a href="http://guest:xxxxxx@172.31.96.248/wangao/ansible.git" target="_blank" rel="external">http://guest:xxxxxx@172.31.96.248/wangao/ansible.git</a><br>Initialized empty Git repository in /home/ox/git/ansible/.git/<br>remote: Counting objects: 257, done.<br>remote: Compressing objects: 100% (153/153), done.<br>remote: Total 257 (delta 91), reused 254 (delta 91)<br>Receiving objects: 100% (257/257), 21.77 MiB | 19.18 MiB/s, done.<br>Resolving deltas: 100% (91/91), done.<br>(ox-zRbE61dW) test101@JQ/home/ox/git$</p>
<h3 id="webhooks不生效"><a href="#webhooks不生效" class="headerlink" title="webhooks不生效"></a>webhooks不生效</h3><p><a href="https://gitlab.com/gitlab-org/gitlab-ce/issues/45334" target="_blank" rel="external">https://gitlab.com/gitlab-org/gitlab-ce/issues/45334</a><br><a href="https://gitlab.com/gitlab-org/omnibus-gitlab/issues/3307#note_64245578" target="_blank" rel="external">https://gitlab.com/gitlab-org/omnibus-gitlab/issues/3307#note_64245578</a></p>
<p>Admin Area - Settings - Outbound request - 勾选以下内容<br>Allow request to the local network from hooks and services</p>
<p><img src="https://www.ilanni.com/wp-content/uploads/2018/04/clip_image011_thumb-1.png" alt=""></p>
]]></content>
    
    <summary type="html">
    
      RHEL7/CentOS7在线和离线安装GitLab配置实践，GitLab汉化配置使用小结
    
    </summary>
    
      <category term="学习 | Study" scheme="https://wsgzao.github.io/categories/%E5%AD%A6%E4%B9%A0-Study/"/>
    
    
  </entry>
  
  <entry>
    <title>3proxy 使用指北</title>
    <link href="https://wsgzao.github.io/post/3proxy/"/>
    <id>https://wsgzao.github.io/post/3proxy/</id>
    <published>2018-04-17T06:59:49.000Z</published>
    <updated>2018-05-03T07:24:43.045Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>本文推荐的是3proxy但是也不能不提一下SSH端口转发，因为很多使用场景可能只需要借助SSH即可实现。SSH有三种端口转发模式，本地端口转发(Local Port Forwarding)，远程端口转发(Remote Port Forwarding)以及动态端口转发(Dynamic Port Forwarding)。对于本地/远程端口转发，两者的方向恰好相反。动态端口转发则可以用于科学上网。3roxy的角色类似于CCProxy，如果你熟悉CCProxy那配置3proxy应该也不会存在太大问题。</p>
<blockquote>
<p>3proxy tiny free proxy server</p>
</blockquote>
<h2 id="更新历史"><a href="#更新历史" class="headerlink" title="更新历史"></a>更新历史</h2><p>2018年04月17日 - 初稿</p>
<p>阅读原文 - <a href="https://wsgzao.github.io/post/3proxy/">https://wsgzao.github.io/post/3proxy/</a></p>
<p><strong>扩展阅读</strong></p>
<p>3proxy - <a href="https://3proxy.ru/" target="_blank" rel="external">https://3proxy.ru/</a></p>
<hr>
<h2 id="3proxy简介"><a href="#3proxy简介" class="headerlink" title="3proxy简介"></a>3proxy简介</h2><p>3proxy是一款代理软件支持http/socks，支持windows和linux平台，安装和配置都很简单<br><a href="http://3proxy.ru/" target="_blank" rel="external">http://3proxy.ru/</a></p>
<p>详细的配置文档可以参考3proxy documentation How To (English, very incomplete)<br><a href="https://3proxy.ru/doc/howtoe.html" target="_blank" rel="external">https://3proxy.ru/doc/howtoe.html</a></p>
<p>关于3proxy的比较好的资料是<br><a href="http://linux.die.net/man/3/3proxy.cfg" target="_blank" rel="external">http://linux.die.net/man/3/3proxy.cfg</a><br><a href="https://github.com/z3APA3A/3proxy/wiki" target="_blank" rel="external">https://github.com/z3APA3A/3proxy/wiki</a></p>
<h2 id="3proxy安装配置"><a href="#3proxy安装配置" class="headerlink" title="3proxy安装配置"></a>3proxy安装配置</h2><h3 id="Linux"><a href="#Linux" class="headerlink" title="Linux"></a>Linux</h3><p>3proxy的代码代管在github上面，地址是：<a href="https://github.com/z3APA3A/3proxy" target="_blank" rel="external">https://github.com/z3APA3A/3proxy</a><br>安装步骤如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 通过git下载最新版3proxy源码</span></div><div class="line">git <span class="built_in">clone</span> https://github.com/z3APA3A/3proxy.git</div><div class="line"><span class="comment"># 切换到3proxy目录</span></div><div class="line"><span class="built_in">cd</span> 3proxy</div><div class="line"><span class="comment"># 编译3proxy,如果你的系统没有gcc，你需求先安装gcc</span></div><div class="line">make -f Makefile.Linux</div><div class="line"><span class="comment"># 安装3proxy</span></div><div class="line">make -f Makefile.Linux install</div></pre></td></tr></table></figure>
<p>编辑生成3proxy.cfg配置文件</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment">#!/usr/local/bin/3proxy</span></div><div class="line"></div><div class="line">timeouts 1 5 30 60 180 1800 15 60</div><div class="line">service</div><div class="line"><span class="comment">#users ox:CL:ox</span></div><div class="line"><span class="built_in">log</span> /etc/3proxy/3proxy.log D</div><div class="line">logformat <span class="string">"- +_L%t.%.  %N.%p %E %U %C:%c %R:%r %O %I %h %T"</span></div><div class="line">rotate 30</div><div class="line">external 0.0.0.0</div><div class="line">internal 0.0.0.0</div><div class="line">auth iponly strong</div><div class="line">allow *</div><div class="line">proxy -a -p6666</div><div class="line">socks -p6667</div></pre></td></tr></table></figure>
<p>执行配置文件，如果有报错比如日志目录不存在和语法错误都会有具体提示</p>
<pre><code>3proxy 3proxy.cfg 
</code></pre><p>后台执行</p>
<pre><code>3proxy 3proxy.cfg &amp;
</code></pre><h3 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h3><figure class="highlight powershell"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># string into 3proxy.cfg. Now, start command prompt (cmd.exe). Change directory to 3proxy installation and run 3proxy.exe --install:</span></div><div class="line">D:\&gt;C:</div><div class="line">C:\&gt;cd C:\Program Files\<span class="number">3</span>proxy</div><div class="line">C:\Program Files\<span class="number">3</span>proxy&gt;<span class="number">3</span>proxy.exe --install</div><div class="line"></div><div class="line"><span class="comment"># Now, you should have 3proxy service installed and running. If service is not started, remove "service" string from 3proxy.cfg, run 3proxy.exe manually and correct all errors.</span></div><div class="line"><span class="comment"># To remove 3proxy run 3proxy --remove:</span></div><div class="line"></div><div class="line">D:\&gt;C:</div><div class="line">C:\&gt;cd C:\Program Files\<span class="number">3</span>proxy</div><div class="line">C:\Program Files\<span class="number">3</span>proxy&gt;net stop <span class="number">3</span>proxy</div><div class="line">C:\Program Files\<span class="number">3</span>proxy&gt;<span class="number">3</span>proxy.exe --remove</div></pre></td></tr></table></figure>
<h2 id="客户端代理使用"><a href="#客户端代理使用" class="headerlink" title="客户端代理使用"></a>客户端代理使用</h2><h3 id="windows"><a href="#windows" class="headerlink" title="windows"></a>windows</h3><blockquote>
<p>有钱任性，服务端可以购买使用CCProxy</p>
</blockquote>
<ul>
<li>浏览器代理</li>
<li>Proxifier</li>
</ul>
<h3 id="Linux-1"><a href="#Linux-1" class="headerlink" title="Linux"></a>Linux</h3><ul>
<li>export http_proxy=””</li>
<li>proxychains(proxychains-ng)</li>
<li>redsocks + iptables</li>
</ul>
]]></content>
    
    <summary type="html">
    
      3proxy tiny free proxy server
    
    </summary>
    
      <category term="学习 | Study" scheme="https://wsgzao.github.io/categories/%E5%AD%A6%E4%B9%A0-Study/"/>
    
    
  </entry>
  
  <entry>
    <title>proxychains 使用指北</title>
    <link href="https://wsgzao.github.io/post/proxychains/"/>
    <id>https://wsgzao.github.io/post/proxychains/</id>
    <published>2018-04-16T06:59:49.000Z</published>
    <updated>2018-04-17T09:34:23.492Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>proxychains新的版本已经称为proxychains-ng由rofl0r托管在GitHub中维护，一般使用proxychains用于加速更新和下载国外的一些开源组件，比如yum和pip。proxychains使用十分简单，甚至都不必编译安装。</p>
<blockquote>
<p>proxychains ng (new generation)</p>
</blockquote>
<h2 id="更新历史"><a href="#更新历史" class="headerlink" title="更新历史"></a>更新历史</h2><p>2017年04月16日 - 初稿</p>
<p>阅读原文 - <a href="https://wsgzao.github.io/post/proxychains/">https://wsgzao.github.io/post/proxychains/</a></p>
<p><strong>扩展阅读</strong></p>
<p>proxychains-ng - <a href="https://github.com/rofl0r/proxychains-ng" target="_blank" rel="external">https://github.com/rofl0r/proxychains-ng</a></p>
<hr>
<h2 id="proxychains-简介"><a href="#proxychains-简介" class="headerlink" title="proxychains 简介"></a>proxychains 简介</h2><p>ProxyChains is a UNIX program, that hooks network-related libc functions in DYNAMICALLY LINKED programs via a preloaded DLL (dlsym(), LD_PRELOAD) and redirects the connections through SOCKS4a/5 or HTTP proxies. It supports TCP only (no UDP/ICMP etc).</p>
<p>The way it works is basically a HACK; so it is possible that it doesn’t work with your program, especially when it’s a script, or starts numerous processes like background daemons or uses dlopen() to load “modules” (bug in glibc dynlinker).</p>
<p>It should work with simple compiled (C/C++) dynamically linked programs though.</p>
<p>If your program doesn’t work with proxychains, consider using an iptables based solution instead; this is much more robust.</p>
<p>Supported Platforms: Linux, BSD, Mac.</p>
<h2 id="proxychains-安装配置"><a href="#proxychains-安装配置" class="headerlink" title="proxychains 安装配置"></a>proxychains 安装配置</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># needs a working C compiler, preferably gcc</span></div><div class="line">yum install gcc -y</div><div class="line">./configure --prefix=/usr --sysconfdir=/etc</div><div class="line">make</div><div class="line">[optional] sudo make install</div><div class="line">[optional] sudo make install-config (installs proxychains.conf)</div><div class="line"></div><div class="line"><span class="comment"># if you dont install, you can use proxychains from the build directory like this: </span></div><div class="line">./proxychains4 -f src/proxychains.conf telnet google.com 80</div><div class="line"></div><div class="line"><span class="comment"># 一般编辑proxychains.conf添加socks5地址即可立即使用</span></div><div class="line">vim /etc/proxychains.conf</div><div class="line"></div><div class="line">[ProxyList]</div><div class="line"><span class="comment"># add proxy here ...</span></div><div class="line"><span class="comment"># meanwile</span></div><div class="line"><span class="comment"># defaults set to "tor"</span></div><div class="line"><span class="comment">#socks4 	127.0.0.1 9050</span></div><div class="line">socks5 172.28.70.26 1080</div><div class="line"></div><div class="line"><span class="comment"># 测试</span></div><div class="line">[root@centos7 ~]<span class="comment"># curl myip.ipip.net</span></div><div class="line">当前 IP：116.228.53.149  来自于：中国 上海 上海  电信</div><div class="line">[root@centos7 ~]<span class="comment"># proxychains4 curl myip.ipip.net</span></div><div class="line">[proxychains] config file found: /etc/proxychains.conf</div><div class="line">[proxychains] preloading /usr/<span class="built_in">local</span>/lib/libproxychains4.so</div><div class="line">[proxychains] DLL init: proxychains-ng 4.12</div><div class="line">[proxychains] Strict chain  ...  172.28.70.26:1080  ...  myip.ipip.net:80  ...  OK</div><div class="line">当前 IP：45.79.192.22  来自于：美国 乔治亚州 亚特兰大  linode.com</div></pre></td></tr></table></figure>
<h2 id="proxychains-conf-配置文件"><a href="#proxychains-conf-配置文件" class="headerlink" title="proxychains.conf 配置文件"></a>proxychains.conf 配置文件</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div></pre></td><td class="code"><pre><div class="line">[root@centos7 ~]<span class="comment"># cat /etc/proxychains.conf </span></div><div class="line"><span class="comment"># proxychains.conf  VER 4.x</span></div><div class="line"><span class="comment">#</span></div><div class="line"><span class="comment">#        HTTP, SOCKS4a, SOCKS5 tunneling proxifier with DNS.</span></div><div class="line"></div><div class="line"></div><div class="line"><span class="comment"># The option below identifies how the ProxyList is treated.</span></div><div class="line"><span class="comment"># only one option should be uncommented at time,</span></div><div class="line"><span class="comment"># otherwise the last appearing option will be accepted</span></div><div class="line"><span class="comment">#</span></div><div class="line"><span class="comment">#dynamic_chain</span></div><div class="line"><span class="comment">#</span></div><div class="line"><span class="comment"># Dynamic - Each connection will be done via chained proxies</span></div><div class="line"><span class="comment"># all proxies chained in the order as they appear in the list</span></div><div class="line"><span class="comment"># at least one proxy must be online to play in chain</span></div><div class="line"><span class="comment"># (dead proxies are skipped)</span></div><div class="line"><span class="comment"># otherwise EINTR is returned to the app</span></div><div class="line"><span class="comment">#</span></div><div class="line">strict_chain</div><div class="line"><span class="comment">#</span></div><div class="line"><span class="comment"># Strict - Each connection will be done via chained proxies</span></div><div class="line"><span class="comment"># all proxies chained in the order as they appear in the list</span></div><div class="line"><span class="comment"># all proxies must be online to play in chain</span></div><div class="line"><span class="comment"># otherwise EINTR is returned to the app</span></div><div class="line"><span class="comment">#</span></div><div class="line"><span class="comment">#round_robin_chain</span></div><div class="line"><span class="comment">#</span></div><div class="line"><span class="comment"># Round Robin - Each connection will be done via chained proxies</span></div><div class="line"><span class="comment"># of chain_len length</span></div><div class="line"><span class="comment"># all proxies chained in the order as they appear in the list</span></div><div class="line"><span class="comment"># at least one proxy must be online to play in chain</span></div><div class="line"><span class="comment"># (dead proxies are skipped).</span></div><div class="line"><span class="comment"># the start of the current proxy chain is the proxy after the last</span></div><div class="line"><span class="comment"># proxy in the previously invoked proxy chain.</span></div><div class="line"><span class="comment"># if the end of the proxy chain is reached while looking for proxies</span></div><div class="line"><span class="comment"># start at the beginning again.</span></div><div class="line"><span class="comment"># otherwise EINTR is returned to the app</span></div><div class="line"><span class="comment"># These semantics are not guaranteed in a multithreaded environment.</span></div><div class="line"><span class="comment">#</span></div><div class="line"><span class="comment">#random_chain</span></div><div class="line"><span class="comment">#</span></div><div class="line"><span class="comment"># Random - Each connection will be done via random proxy</span></div><div class="line"><span class="comment"># (or proxy chain, see  chain_len) from the list.</span></div><div class="line"><span class="comment"># this option is good to test your IDS :)</span></div><div class="line"></div><div class="line"><span class="comment"># Make sense only if random_chain or round_robin_chain</span></div><div class="line"><span class="comment">#chain_len = 2</span></div><div class="line"></div><div class="line"><span class="comment"># Quiet mode (no output from library)</span></div><div class="line"><span class="comment">#quiet_mode</span></div><div class="line"></div><div class="line"><span class="comment"># Proxy DNS requests - no leak for DNS data</span></div><div class="line">proxy_dns </div><div class="line"></div><div class="line"><span class="comment"># set the class A subnet number to use for the internal remote DNS mapping</span></div><div class="line"><span class="comment"># we use the reserved 224.x.x.x range by default,</span></div><div class="line"><span class="comment"># if the proxified app does a DNS request, we will return an IP from that range.</span></div><div class="line"><span class="comment"># on further accesses to this ip we will send the saved DNS name to the proxy.</span></div><div class="line"><span class="comment"># in case some control-freak app checks the returned ip, and denies to </span></div><div class="line"><span class="comment"># connect, you can use another subnet, e.g. 10.x.x.x or 127.x.x.x.</span></div><div class="line"><span class="comment"># of course you should make sure that the proxified app does not need</span></div><div class="line"><span class="comment"># *real* access to this subnet. </span></div><div class="line"><span class="comment"># i.e. dont use the same subnet then in the localnet section</span></div><div class="line"><span class="comment">#remote_dns_subnet 127 </span></div><div class="line"><span class="comment">#remote_dns_subnet 10</span></div><div class="line">remote_dns_subnet 224</div><div class="line"></div><div class="line"><span class="comment"># Some timeouts in milliseconds</span></div><div class="line">tcp_read_time_out 15000</div><div class="line">tcp_connect_time_out 8000</div><div class="line"></div><div class="line"><span class="comment">### Examples for localnet exclusion</span></div><div class="line"><span class="comment">## localnet ranges will *not* use a proxy to connect.</span></div><div class="line"><span class="comment">## Exclude connections to 192.168.1.0/24 with port 80</span></div><div class="line"><span class="comment"># localnet 192.168.1.0:80/255.255.255.0</span></div><div class="line"></div><div class="line"><span class="comment">## Exclude connections to 192.168.100.0/24</span></div><div class="line"><span class="comment"># localnet 192.168.100.0/255.255.255.0</span></div><div class="line"></div><div class="line"><span class="comment">## Exclude connections to ANYwhere with port 80</span></div><div class="line"><span class="comment"># localnet 0.0.0.0:80/0.0.0.0</span></div><div class="line"></div><div class="line"><span class="comment">## RFC5735 Loopback address range</span></div><div class="line"><span class="comment">## if you enable this, you have to make sure remote_dns_subnet is not 127</span></div><div class="line"><span class="comment">## you'll need to enable it if you want to use an application that </span></div><div class="line"><span class="comment">## connects to localhost.</span></div><div class="line"><span class="comment"># localnet 127.0.0.0/255.0.0.0</span></div><div class="line"></div><div class="line"><span class="comment">## RFC1918 Private Address Ranges</span></div><div class="line"><span class="comment"># localnet 10.0.0.0/255.0.0.0</span></div><div class="line"><span class="comment"># localnet 172.16.0.0/255.240.0.0</span></div><div class="line"><span class="comment"># localnet 192.168.0.0/255.255.0.0</span></div><div class="line"></div><div class="line"><span class="comment"># ProxyList format</span></div><div class="line"><span class="comment">#       type  ip  port [user pass]</span></div><div class="line"><span class="comment">#       (values separated by 'tab' or 'blank')</span></div><div class="line"><span class="comment">#</span></div><div class="line"><span class="comment">#       only numeric ipv4 addresses are valid</span></div><div class="line"><span class="comment">#</span></div><div class="line"><span class="comment">#</span></div><div class="line"><span class="comment">#        Examples:</span></div><div class="line"><span class="comment">#</span></div><div class="line"><span class="comment">#            	socks5	192.168.67.78	1080	lamer	secret</span></div><div class="line"><span class="comment">#		http	192.168.89.3	8080	justu	hidden</span></div><div class="line"><span class="comment">#	 	socks4	192.168.1.49	1080</span></div><div class="line"><span class="comment">#	        http	192.168.39.93	8080	</span></div><div class="line"><span class="comment">#		</span></div><div class="line"><span class="comment">#</span></div><div class="line"><span class="comment">#       proxy types: http, socks4, socks5</span></div><div class="line"><span class="comment">#        ( auth types supported: "basic"-http  "user/pass"-socks )</span></div><div class="line"><span class="comment">#</span></div><div class="line">[ProxyList]</div><div class="line"><span class="comment"># add proxy here ...</span></div><div class="line"><span class="comment"># meanwile</span></div><div class="line"><span class="comment"># defaults set to "tor"</span></div><div class="line"><span class="comment">#socks4 	127.0.0.1 9050</span></div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      proxychains ng (new generation)
    
    </summary>
    
      <category term="学习 | Study" scheme="https://wsgzao.github.io/categories/%E5%AD%A6%E4%B9%A0-Study/"/>
    
    
  </entry>
  
  <entry>
    <title>使用pypiserver快速搭建内网离线pypi仓库实践</title>
    <link href="https://wsgzao.github.io/post/pypiserver/"/>
    <id>https://wsgzao.github.io/post/pypiserver/</id>
    <published>2018-04-12T08:40:53.000Z</published>
    <updated>2018-04-13T08:25:01.135Z</updated>
    
    <content type="html"><![CDATA[<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><p>本文介绍了如何快速搭建一个pypiserver，通过自建pypiserver，我们可以解决网络环境不好，或者离线无法安装python包的问题。如果结合最新的GitLab CI/CD和pipenv我相信各位还可以玩出更多的花样。</p>
<blockquote>
<p>pypiserver - minimal PyPI server for use with pip/easy_install</p>
</blockquote>
<h2 id="更新记录"><a href="#更新记录" class="headerlink" title="更新记录"></a>更新记录</h2><p>2018年04月12日 - 初稿</p>
<p>阅读原文 - <a href="https://wsgzao.github.io/post/pypiserver/">https://wsgzao.github.io/post/pypiserver/</a></p>
<p><strong>扩展阅读</strong></p>
<p>pypiserver - <a href="https://github.com/pypiserver/pypiserver" target="_blank" rel="external">https://github.com/pypiserver/pypiserver</a></p>
<h2 id="pypiserver-简介"><a href="#pypiserver-简介" class="headerlink" title="pypiserver 简介"></a>pypiserver 简介</h2><p>pypiserver is a minimal PyPI compatible server for pip or easy_install. It is based on bottle and serves packages from regular directories. Wheels, bdists, eggs and accompanying PGP-signatures can be uploaded either with pip, setuptools, twine, pypi-uploader, or simply copied with scp.</p>
<h2 id="pypiserver-服务端配置"><a href="#pypiserver-服务端配置" class="headerlink" title="pypiserver 服务端配置"></a>pypiserver 服务端配置</h2><blockquote>
<p>如果你的Linux环境缺少Python 2.7可以参考我的文章直接离线升级至最新版本</p>
</blockquote>
<p>Python 2.6 升级至 Python 2.7 的实践心得<br><a href="https://wsgzao.github.io/post/python-2-6-update-to-2-7/">https://wsgzao.github.io/post/python-2-6-update-to-2-7/</a></p>
<p>pypiserver &gt; 1.2.x works with python 2.7 and 3.3+ or pypy. Older python-versions may still work, but they are not tested. For legacy python versions, use pypiserver-1.1.x series.</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 替换pip为阿里云，感概豆瓣的时代已经过去</span></div><div class="line">tee ~/.pip/pip.conf &lt;&lt;-<span class="string">'EOF'</span></div><div class="line">[global]</div><div class="line">index-url = https://mirrors.aliyun.com/pypi/simple/</div><div class="line">[install]</div><div class="line">trusted-host= mirrors.aliyun.com</div><div class="line">EOF</div><div class="line"></div><div class="line"><span class="comment"># 直接在线安装pypiserver</span></div><div class="line">pip install pypiserver</div><div class="line"><span class="comment"># 离线下载pypiserver</span></div><div class="line">mkdir /tmp/pypiserver</div><div class="line">pip install -d /tmp/pypiserver/ pypiserver</div><div class="line"></div><div class="line"><span class="comment"># Copy packages into this directory.</span></div><div class="line">mkdir ~/packages</div><div class="line"><span class="comment"># Copy some packages into your ~/packages folder and then get your pypiserver up and running:</span></div><div class="line">pypi-server -p 8080 ~/packages &amp;</div></pre></td></tr></table></figure>
<h2 id="pypiserver-客户端配置"><a href="#pypiserver-客户端配置" class="headerlink" title="pypiserver 客户端配置"></a>pypiserver 客户端配置</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="comment">## Download and Install hosted packages.</span></div><div class="line">pip install  --extra-index-url http://localhost:8080/simple/ ...</div><div class="line"></div><div class="line"><span class="comment"># or</span></div><div class="line">pip install --extra-index-url http://localhost:8080</div><div class="line"></div><div class="line"><span class="comment">## Search hosted packages</span></div><div class="line">pip search --index http://localhost:8080 ...</div><div class="line"></div><div class="line"><span class="comment"># 个人推荐的配置</span></div><div class="line">tee ~/.pip/pip.conf &lt;&lt;-<span class="string">'EOF'</span></div><div class="line">[global]</div><div class="line">index-url = http://172.28.70.126/simple</div><div class="line">extra-index-url = https://mirrors.aliyun.com/pypi/simple/</div><div class="line">[install]</div><div class="line">trusted-host = 172.28.70.126</div><div class="line">EOF</div></pre></td></tr></table></figure>
<h2 id="pypiserver-进阶配置"><a href="#pypiserver-进阶配置" class="headerlink" title="pypiserver 进阶配置"></a>pypiserver 进阶配置</h2><blockquote>
<p>pypiserver Running as a systemd service</p>
</blockquote>
<p><a href="https://github.com/pypiserver/pypiserver#running-as-a-systemd-service" target="_blank" rel="external">https://github.com/pypiserver/pypiserver#running-as-a-systemd-service</a></p>
<p>Adjusting the paths and adding this file as pypiserver.service into your systemd/system directory will allow management of the pypiserver process with systemctl, e.g. systemctl start pypiserver.</p>
<p>More useful information about systemd can be found at <a href="https://www.digitalocean.com/community/tutorials/how-to-use-systemctl-to-manage-systemd-services-and-units" target="_blank" rel="external">https://www.digitalocean.com/community/tutorials/how-to-use-systemctl-to-manage-systemd-services-and-units</a></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div><div class="line">68</div><div class="line">69</div><div class="line">70</div><div class="line">71</div><div class="line">72</div><div class="line">73</div><div class="line">74</div><div class="line">75</div><div class="line">76</div><div class="line">77</div><div class="line">78</div><div class="line">79</div><div class="line">80</div><div class="line">81</div><div class="line">82</div><div class="line">83</div><div class="line">84</div><div class="line">85</div><div class="line">86</div><div class="line">87</div><div class="line">88</div><div class="line">89</div><div class="line">90</div><div class="line">91</div><div class="line">92</div><div class="line">93</div><div class="line">94</div><div class="line">95</div><div class="line">96</div><div class="line">97</div><div class="line">98</div><div class="line">99</div><div class="line">100</div><div class="line">101</div><div class="line">102</div><div class="line">103</div><div class="line">104</div><div class="line">105</div><div class="line">106</div><div class="line">107</div><div class="line">108</div><div class="line">109</div><div class="line">110</div><div class="line">111</div><div class="line">112</div><div class="line">113</div><div class="line">114</div><div class="line">115</div><div class="line">116</div><div class="line">117</div><div class="line">118</div><div class="line">119</div><div class="line">120</div><div class="line">121</div><div class="line">122</div><div class="line">123</div><div class="line">124</div><div class="line">125</div><div class="line">126</div><div class="line">127</div><div class="line">128</div><div class="line">129</div><div class="line">130</div><div class="line">131</div><div class="line">132</div><div class="line">133</div><div class="line">134</div><div class="line">135</div><div class="line">136</div><div class="line">137</div><div class="line">138</div><div class="line">139</div><div class="line">140</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 安装需要的包</span></div><div class="line">yum install nginx -y</div><div class="line">pip install passlib pypiserver gunicorn</div><div class="line"></div><div class="line"><span class="comment"># 创建pypiserver服务方便服务启停管理</span></div><div class="line">tee /usr/lib/systemd/system/pypiserver.service &lt;&lt;-<span class="string">'EOF'</span></div><div class="line">[Unit]</div><div class="line">Description=gunicorn daemon</div><div class="line">After=network.target</div><div class="line"></div><div class="line">[Service]</div><div class="line">PIDFile=/run/pypiserver.pid</div><div class="line">ExecStart=/usr/<span class="built_in">local</span>/bin/gunicorn -w16 \</div><div class="line">    --pid /run/pypiserver.pid \</div><div class="line">    -b :10012 \</div><div class="line">    <span class="string">'pypiserver:app(root="/var/www/pypi")'</span></div><div class="line">ExecReload=/bin/<span class="built_in">kill</span> -s HUP <span class="variable">$MAINPID</span></div><div class="line">ExecStop=/bin/<span class="built_in">kill</span> -s TERM <span class="variable">$MAINPID</span></div><div class="line"></div><div class="line">[Install]</div><div class="line">WantedBy=multi-user.target </div><div class="line">EOF</div><div class="line"></div><div class="line"><span class="comment"># Warning: pypiserver.service changed on disk. Run 'systemctl daemon-reload' to reload units.</span></div><div class="line">systemctl daemon-reload</div><div class="line"></div><div class="line"><span class="comment"># 启动pypiserver服务</span></div><div class="line">systemctl <span class="built_in">enable</span> pypiserver.service</div><div class="line">systemctl start pypiserver.service</div><div class="line">systemctl status pypiserver.service</div><div class="line"></div><div class="line"><span class="comment"># 停止pypiserver服务</span></div><div class="line">systemctl <span class="built_in">disable</span> pypiserver.service</div><div class="line">systemctl stop pypiserver.service</div><div class="line">systemctl status pypiserver.service</div><div class="line"></div><div class="line">[root@centos7 run]<span class="comment"># systemctl status pypiserver.service</span></div><div class="line">● pypiserver.service - gunicorn daemon</div><div class="line">   Loaded: loaded (/usr/lib/systemd/system/pypiserver.service; disabled; vendor preset: disabled)</div><div class="line">   Active: active (running) since Fri 2018-04-13 15:14:08 CST; 859ms ago</div><div class="line"> Main PID: 22524 (gunicorn)</div><div class="line">   CGroup: /system.slice/pypiserver.service</div><div class="line">           ├─22524 /usr/<span class="built_in">local</span>/bin/python /usr/<span class="built_in">local</span>/bin/gunicorn -w16 --pid /run/pypiserver.pid -b :10012 pypiserver:app(root=<span class="string">"/var/www/pypi"</span>)</div><div class="line">           ├─22530 /usr/<span class="built_in">local</span>/bin/python /usr/<span class="built_in">local</span>/bin/gunicorn -w16 --pid /run/pypiserver.pid -b :10012 pypiserver:app(root=<span class="string">"/var/www/pypi"</span>)</div><div class="line">           ├─22531 /usr/<span class="built_in">local</span>/bin/python /usr/<span class="built_in">local</span>/bin/gunicorn -w16 --pid /run/pypiserver.pid -b :10012 pypiserver:app(root=<span class="string">"/var/www/pypi"</span>)</div><div class="line">           ├─22532 /usr/<span class="built_in">local</span>/bin/python /usr/<span class="built_in">local</span>/bin/gunicorn -w16 --pid /run/pypiserver.pid -b :10012 pypiserver:app(root=<span class="string">"/var/www/pypi"</span>)</div><div class="line">           ├─22533 /usr/<span class="built_in">local</span>/bin/python /usr/<span class="built_in">local</span>/bin/gunicorn -w16 --pid /run/pypiserver.pid -b :10012 pypiserver:app(root=<span class="string">"/var/www/pypi"</span>)</div><div class="line">           ├─22534 /usr/<span class="built_in">local</span>/bin/python /usr/<span class="built_in">local</span>/bin/gunicorn -w16 --pid /run/pypiserver.pid -b :10012 pypiserver:app(root=<span class="string">"/var/www/pypi"</span>)</div><div class="line">           ├─22535 /usr/<span class="built_in">local</span>/bin/python /usr/<span class="built_in">local</span>/bin/gunicorn -w16 --pid /run/pypiserver.pid -b :10012 pypiserver:app(root=<span class="string">"/var/www/pypi"</span>)</div><div class="line">           ├─22536 /usr/<span class="built_in">local</span>/bin/python /usr/<span class="built_in">local</span>/bin/gunicorn -w16 --pid /run/pypiserver.pid -b :10012 pypiserver:app(root=<span class="string">"/var/www/pypi"</span>)</div><div class="line">           ├─22537 /usr/<span class="built_in">local</span>/bin/python /usr/<span class="built_in">local</span>/bin/gunicorn -w16 --pid /run/pypiserver.pid -b :10012 pypiserver:app(root=<span class="string">"/var/www/pypi"</span>)</div><div class="line">           ├─22538 /usr/<span class="built_in">local</span>/bin/python /usr/<span class="built_in">local</span>/bin/gunicorn -w16 --pid /run/pypiserver.pid -b :10012 pypiserver:app(root=<span class="string">"/var/www/pypi"</span>)</div><div class="line">           ├─22539 /usr/<span class="built_in">local</span>/bin/python /usr/<span class="built_in">local</span>/bin/gunicorn -w16 --pid /run/pypiserver.pid -b :10012 pypiserver:app(root=<span class="string">"/var/www/pypi"</span>)</div><div class="line">           └─22540 /usr/<span class="built_in">local</span>/bin/python /usr/<span class="built_in">local</span>/bin/gunicorn -w16 --pid /run/pypiserver.pid -b :10012 pypiserver:app(root=<span class="string">"/var/www/pypi"</span>)</div><div class="line"></div><div class="line">Apr 13 15:14:08 centos7 gunicorn[22524]: [2018-04-13 15:14:08 +0000] [22531] [INFO] Booting worker with pid: 22531</div><div class="line">Apr 13 15:14:08 centos7 gunicorn[22524]: [2018-04-13 15:14:08 +0000] [22532] [INFO] Booting worker with pid: 22532</div><div class="line">Apr 13 15:14:08 centos7 gunicorn[22524]: [2018-04-13 15:14:08 +0000] [22533] [INFO] Booting worker with pid: 22533</div><div class="line">Apr 13 15:14:08 centos7 gunicorn[22524]: [2018-04-13 15:14:08 +0000] [22534] [INFO] Booting worker with pid: 22534</div><div class="line">Apr 13 15:14:08 centos7 gunicorn[22524]: [2018-04-13 15:14:08 +0000] [22535] [INFO] Booting worker with pid: 22535</div><div class="line">Apr 13 15:14:08 centos7 gunicorn[22524]: [2018-04-13 15:14:08 +0000] [22536] [INFO] Booting worker with pid: 22536</div><div class="line">Apr 13 15:14:08 centos7 gunicorn[22524]: [2018-04-13 15:14:08 +0000] [22537] [INFO] Booting worker with pid: 22537</div><div class="line">Apr 13 15:14:08 centos7 gunicorn[22524]: [2018-04-13 15:14:08 +0000] [22538] [INFO] Booting worker with pid: 22538</div><div class="line">Apr 13 15:14:08 centos7 gunicorn[22524]: [2018-04-13 15:14:08 +0000] [22539] [INFO] Booting worker with pid: 22539</div><div class="line">Apr 13 15:14:08 centos7 gunicorn[22524]: [2018-04-13 15:14:08 +0000] [22540] [INFO] Booting worker with pid: 22540</div><div class="line">[root@centos7 run]<span class="comment"># netstat -tnlp</span></div><div class="line">Active Internet connections (only servers)</div><div class="line">Proto Recv-Q Send-Q Local Address           Foreign Address         State       PID/Program name    </div><div class="line">tcp        0      0 0.0.0.0:111             0.0.0.0:*               LISTEN      1/systemd           </div><div class="line">tcp        0      0 192.168.122.1:53        0.0.0.0:*               LISTEN      1517/dnsmasq        </div><div class="line">tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN      977/sshd            </div><div class="line">tcp        0      0 127.0.0.1:631           0.0.0.0:*               LISTEN      978/cupsd           </div><div class="line">tcp        0      0 127.0.0.1:25            0.0.0.0:*               LISTEN      1383/master         </div><div class="line">tcp        0      0 127.0.0.1:6011          0.0.0.0:*               LISTEN      19378/sshd: root@pt </div><div class="line">tcp        0      0 0.0.0.0:10012           0.0.0.0:*               LISTEN      22524/python        </div><div class="line">tcp6       0      0 :::111                  :::*                    LISTEN      1/systemd           </div><div class="line">tcp6       0      0 :::22                   :::*                    LISTEN      977/sshd            </div><div class="line">tcp6       0      0 ::1:631                 :::*                    LISTEN      978/cupsd           </div><div class="line">tcp6       0      0 ::1:25                  :::*                    LISTEN      1383/master         </div><div class="line">tcp6       0      0 ::1:6011                :::*                    LISTEN      19378/sshd: root@pt </div><div class="line"></div><div class="line"><span class="comment"># 检查pypiserver服务</span></div><div class="line"><span class="built_in">cd</span> /var/www/pypi</div><div class="line"><span class="comment"># 向仓库中添加python package</span></div><div class="line">[root@centos7 pypi]<span class="comment"># pip download pypiserver</span></div><div class="line">Collecting pypiserver</div><div class="line">  Downloading https://mirrors.aliyun.com/pypi/packages/d7/78/5772432dad2b9e754ab92f4d301fa507069b9decc8c943c1b18c2043ff4f/pypiserver-1.2.1-py2.py3-none-any.whl (83kB)</div><div class="line">    100% |████████████████████████████████| 92kB 643kB/s </div><div class="line">  Saved ./pypiserver-1.2.1-py2.py3-none-any.whl</div><div class="line">Successfully downloaded pypiserver</div><div class="line"></div><div class="line">[root@centos7 pypi]<span class="comment"># ll</span></div><div class="line">total 84</div><div class="line">-rw-r--r-- 1 root root 83529 Apr 13 14:55 pypiserver-1.2.1-py2.py3-none-any.whl</div><div class="line"></div><div class="line"><span class="comment"># 搜索刚才下载的package</span></div><div class="line">[root@centos7 pypi]<span class="comment"># pip search -i http://127.0.0.1:10012 pypiserver</span></div><div class="line">pypiserver (1.2.1)  - 1.2.1</div><div class="line">  INSTALLED: 1.2.1 (latest)</div><div class="line"></div><div class="line"><span class="comment"># 配置nginx做反向代理</span></div><div class="line">tee /etc/nginx/conf.d/pypi.conf &lt;&lt;-<span class="string">'EOF'</span></div><div class="line">upstream pypiserver &#123;</div><div class="line">  server 127.0.0.1:10012;</div><div class="line">&#125;</div><div class="line"></div><div class="line">server &#123;</div><div class="line">  listen 10087;</div><div class="line"></div><div class="line">  <span class="comment"># disable any limits to avoid HTTP 413 for large package uploads</span></div><div class="line">  client_max_body_size 0;</div><div class="line"></div><div class="line">  location / &#123;</div><div class="line">    proxy_pass http://pypiserver/;</div><div class="line">    proxy_set_header Host <span class="variable">$host</span>;</div><div class="line">    proxy_set_header X-Real-IP <span class="variable">$remote_addr</span>;</div><div class="line">    proxy_set_header X-Forwarded-For <span class="variable">$proxy_add_x_forwarded_for</span>;</div><div class="line"></div><div class="line">    <span class="comment"># When setting up pypiserver behind other proxy, such as an Nginx instance, remove the below line if the proxy already has similar settings.</span></div><div class="line">    proxy_set_header X-Forwarded-Proto <span class="variable">$scheme</span>;</div><div class="line"></div><div class="line">    proxy_buffering off;</div><div class="line">    proxy_request_buffering off;</div><div class="line">  &#125;</div><div class="line"></div><div class="line">  location /packages/ &#123;</div><div class="line">    <span class="built_in">alias</span> /var/www/pypi; <span class="comment"># static file</span></div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line">EOF</div><div class="line"></div><div class="line"><span class="comment"># 启动nginx</span></div><div class="line">systemctl <span class="built_in">enable</span> nginx</div><div class="line">systemctl start nginx</div><div class="line">systemctl status nginx</div><div class="line"></div><div class="line"><span class="comment"># 检查nginx服务</span></div><div class="line">pip search -i http://172.28.79.126:10087 pypiserver</div><div class="line">pypiserver (1.2.1)  - 1.2.1</div><div class="line">  INSTALLED: 1.2.1 (latest)</div></pre></td></tr></table></figure>]]></content>
    
    <summary type="html">
    
      pypiserver - minimal PyPI server for use with pip/easy_install
    
    </summary>
    
      <category term="学习 | Study" scheme="https://wsgzao.github.io/categories/%E5%AD%A6%E4%B9%A0-Study/"/>
    
    
  </entry>
  
</feed>
